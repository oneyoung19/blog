<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>渲染工具函数 | OneYoung’s Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/blog/favicon.ico">
    <link rel="manifest" href="/blog/manifest.json">
    <script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b5edcf6b1a12076f348b1de5dd83a662";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();</script>
    <script>(function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "o1h2x0tjoo");</script>
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-6MCGJRJCR5"></script>
    <script>window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-6MCGJRJCR5');</script>
    <meta name="description" content="个人技术博客">
    <meta name="google" content="notranslate">
    <link rel="preload" href="/blog/assets/css/0.styles.b3e5b934.css" as="style"><link rel="preload" href="/blog/assets/js/app.78f86ccf.js" as="script"><link rel="preload" href="/blog/assets/js/2.80e16ae8.js" as="script"><link rel="preload" href="/blog/assets/js/374.018fceba.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.1b41069e.js"><link rel="prefetch" href="/blog/assets/js/100.8c82ae58.js"><link rel="prefetch" href="/blog/assets/js/101.7175e01c.js"><link rel="prefetch" href="/blog/assets/js/102.1989486a.js"><link rel="prefetch" href="/blog/assets/js/103.a0860639.js"><link rel="prefetch" href="/blog/assets/js/104.5308f63c.js"><link rel="prefetch" href="/blog/assets/js/105.996cd71a.js"><link rel="prefetch" href="/blog/assets/js/106.55f066de.js"><link rel="prefetch" href="/blog/assets/js/107.7199134e.js"><link rel="prefetch" href="/blog/assets/js/108.873242a5.js"><link rel="prefetch" href="/blog/assets/js/109.1d6a1669.js"><link rel="prefetch" href="/blog/assets/js/11.9408cc63.js"><link rel="prefetch" href="/blog/assets/js/110.37a18e6e.js"><link rel="prefetch" href="/blog/assets/js/111.38bb02c8.js"><link rel="prefetch" href="/blog/assets/js/112.0410d06d.js"><link rel="prefetch" href="/blog/assets/js/113.a653bee6.js"><link rel="prefetch" href="/blog/assets/js/114.055b8f9e.js"><link rel="prefetch" href="/blog/assets/js/115.d9111d08.js"><link rel="prefetch" href="/blog/assets/js/116.13cbcabf.js"><link rel="prefetch" href="/blog/assets/js/117.f6ce46f7.js"><link rel="prefetch" href="/blog/assets/js/118.efc5b665.js"><link rel="prefetch" href="/blog/assets/js/119.3e930ffb.js"><link rel="prefetch" href="/blog/assets/js/12.7afe7247.js"><link rel="prefetch" href="/blog/assets/js/120.58ca9b58.js"><link rel="prefetch" href="/blog/assets/js/121.51e0689c.js"><link rel="prefetch" href="/blog/assets/js/122.6bafb5e2.js"><link rel="prefetch" href="/blog/assets/js/123.bbd8affb.js"><link rel="prefetch" href="/blog/assets/js/124.90530353.js"><link rel="prefetch" href="/blog/assets/js/125.1c11690a.js"><link rel="prefetch" href="/blog/assets/js/126.48c6c85a.js"><link rel="prefetch" href="/blog/assets/js/127.ca81ab0f.js"><link rel="prefetch" href="/blog/assets/js/128.13a71846.js"><link rel="prefetch" href="/blog/assets/js/129.2d0f5d12.js"><link rel="prefetch" href="/blog/assets/js/13.61a22ebd.js"><link rel="prefetch" href="/blog/assets/js/130.9157e19a.js"><link rel="prefetch" href="/blog/assets/js/131.392ad83c.js"><link rel="prefetch" href="/blog/assets/js/132.7bf7cbbc.js"><link rel="prefetch" href="/blog/assets/js/133.a5801dde.js"><link rel="prefetch" href="/blog/assets/js/134.f0c19d3b.js"><link rel="prefetch" href="/blog/assets/js/135.ddd882ce.js"><link rel="prefetch" href="/blog/assets/js/136.1f27d503.js"><link rel="prefetch" href="/blog/assets/js/137.eeeb46b2.js"><link rel="prefetch" href="/blog/assets/js/138.7d8dd3de.js"><link rel="prefetch" href="/blog/assets/js/139.efc38a54.js"><link rel="prefetch" href="/blog/assets/js/14.fdbbfba8.js"><link rel="prefetch" href="/blog/assets/js/140.fd36b4cd.js"><link rel="prefetch" href="/blog/assets/js/141.266f09f7.js"><link rel="prefetch" href="/blog/assets/js/142.e5baef7d.js"><link rel="prefetch" href="/blog/assets/js/143.0009e461.js"><link rel="prefetch" href="/blog/assets/js/144.8dbdf5b1.js"><link rel="prefetch" href="/blog/assets/js/145.030f0007.js"><link rel="prefetch" href="/blog/assets/js/146.458f81a8.js"><link rel="prefetch" href="/blog/assets/js/147.a4ee40e6.js"><link rel="prefetch" href="/blog/assets/js/148.8149b59f.js"><link rel="prefetch" href="/blog/assets/js/149.e176541c.js"><link rel="prefetch" href="/blog/assets/js/15.7aceb4af.js"><link rel="prefetch" href="/blog/assets/js/150.d489109a.js"><link rel="prefetch" href="/blog/assets/js/151.b2288361.js"><link rel="prefetch" href="/blog/assets/js/152.174b4cdd.js"><link rel="prefetch" href="/blog/assets/js/153.15461ab1.js"><link rel="prefetch" href="/blog/assets/js/154.9d5c4d95.js"><link rel="prefetch" href="/blog/assets/js/155.e4faedb0.js"><link rel="prefetch" href="/blog/assets/js/156.5972169a.js"><link rel="prefetch" href="/blog/assets/js/157.9f940efd.js"><link rel="prefetch" href="/blog/assets/js/158.59ff775a.js"><link rel="prefetch" href="/blog/assets/js/159.150bce65.js"><link rel="prefetch" href="/blog/assets/js/16.94dd4a41.js"><link rel="prefetch" href="/blog/assets/js/160.ca7fbea9.js"><link rel="prefetch" href="/blog/assets/js/161.2deb04d9.js"><link rel="prefetch" href="/blog/assets/js/162.26f654ed.js"><link rel="prefetch" href="/blog/assets/js/163.8512e009.js"><link rel="prefetch" href="/blog/assets/js/164.269133da.js"><link rel="prefetch" href="/blog/assets/js/165.bc7cd162.js"><link rel="prefetch" href="/blog/assets/js/166.f5c2f153.js"><link rel="prefetch" href="/blog/assets/js/167.1b8edc8e.js"><link rel="prefetch" href="/blog/assets/js/168.4373bcf8.js"><link rel="prefetch" href="/blog/assets/js/169.c50144e5.js"><link rel="prefetch" href="/blog/assets/js/17.736327a1.js"><link rel="prefetch" href="/blog/assets/js/170.bd822a8a.js"><link rel="prefetch" href="/blog/assets/js/171.2a86ff3f.js"><link rel="prefetch" href="/blog/assets/js/172.6eb4b239.js"><link rel="prefetch" href="/blog/assets/js/173.8bed904b.js"><link rel="prefetch" href="/blog/assets/js/174.0af6c95e.js"><link rel="prefetch" href="/blog/assets/js/175.14b03051.js"><link rel="prefetch" href="/blog/assets/js/176.de56c929.js"><link rel="prefetch" href="/blog/assets/js/177.9f04a32f.js"><link rel="prefetch" href="/blog/assets/js/178.a94fabb7.js"><link rel="prefetch" href="/blog/assets/js/179.e659d210.js"><link rel="prefetch" href="/blog/assets/js/18.e784a2f1.js"><link rel="prefetch" href="/blog/assets/js/180.ccf1c1c8.js"><link rel="prefetch" href="/blog/assets/js/181.be73fcf9.js"><link rel="prefetch" href="/blog/assets/js/182.94450f0c.js"><link rel="prefetch" href="/blog/assets/js/183.68cd1d91.js"><link rel="prefetch" href="/blog/assets/js/184.9a96ff47.js"><link rel="prefetch" href="/blog/assets/js/185.d2dafbb5.js"><link rel="prefetch" href="/blog/assets/js/186.afd76a3a.js"><link rel="prefetch" href="/blog/assets/js/187.91c71052.js"><link rel="prefetch" href="/blog/assets/js/188.397a707e.js"><link rel="prefetch" href="/blog/assets/js/189.6cf891d1.js"><link rel="prefetch" href="/blog/assets/js/19.09afe9ce.js"><link rel="prefetch" href="/blog/assets/js/190.d0ca50f2.js"><link rel="prefetch" href="/blog/assets/js/191.3cd32407.js"><link rel="prefetch" href="/blog/assets/js/192.dc4b63d1.js"><link rel="prefetch" href="/blog/assets/js/193.0a8f2358.js"><link rel="prefetch" href="/blog/assets/js/194.12bfe646.js"><link rel="prefetch" href="/blog/assets/js/195.7f6d28c8.js"><link rel="prefetch" href="/blog/assets/js/196.805343b0.js"><link rel="prefetch" href="/blog/assets/js/197.8ee665ff.js"><link rel="prefetch" href="/blog/assets/js/198.2048833f.js"><link rel="prefetch" href="/blog/assets/js/199.fa492d2f.js"><link rel="prefetch" href="/blog/assets/js/20.ef9cbab1.js"><link rel="prefetch" href="/blog/assets/js/200.3a117b00.js"><link rel="prefetch" href="/blog/assets/js/201.9dbec404.js"><link rel="prefetch" href="/blog/assets/js/202.94fe444d.js"><link rel="prefetch" href="/blog/assets/js/203.92f413e8.js"><link rel="prefetch" href="/blog/assets/js/204.c7bdadf7.js"><link rel="prefetch" href="/blog/assets/js/205.558ceea5.js"><link rel="prefetch" href="/blog/assets/js/206.18475a37.js"><link rel="prefetch" href="/blog/assets/js/207.0db53f0a.js"><link rel="prefetch" href="/blog/assets/js/208.58888c39.js"><link rel="prefetch" href="/blog/assets/js/209.1cbaadfe.js"><link rel="prefetch" href="/blog/assets/js/21.4c36c09d.js"><link rel="prefetch" href="/blog/assets/js/210.1ccb2d04.js"><link rel="prefetch" href="/blog/assets/js/211.519b191b.js"><link rel="prefetch" href="/blog/assets/js/212.e7da3cb8.js"><link rel="prefetch" href="/blog/assets/js/213.e423b73f.js"><link rel="prefetch" href="/blog/assets/js/214.a1cc25c9.js"><link rel="prefetch" href="/blog/assets/js/215.e826dfee.js"><link rel="prefetch" href="/blog/assets/js/216.7414e0b9.js"><link rel="prefetch" href="/blog/assets/js/217.f74be72a.js"><link rel="prefetch" href="/blog/assets/js/218.b0e16f76.js"><link rel="prefetch" href="/blog/assets/js/219.e278d28c.js"><link rel="prefetch" href="/blog/assets/js/22.72cf7765.js"><link rel="prefetch" href="/blog/assets/js/220.83a77aa0.js"><link rel="prefetch" href="/blog/assets/js/221.aaaa25d1.js"><link rel="prefetch" href="/blog/assets/js/222.10fa1707.js"><link rel="prefetch" href="/blog/assets/js/223.670f4a78.js"><link rel="prefetch" href="/blog/assets/js/224.4a4b1c9e.js"><link rel="prefetch" href="/blog/assets/js/225.62a41316.js"><link rel="prefetch" href="/blog/assets/js/226.1ad6af2d.js"><link rel="prefetch" href="/blog/assets/js/227.b2e99fd3.js"><link rel="prefetch" href="/blog/assets/js/228.97835c52.js"><link rel="prefetch" href="/blog/assets/js/229.7d32c82f.js"><link rel="prefetch" href="/blog/assets/js/23.68a17302.js"><link rel="prefetch" href="/blog/assets/js/230.e834dff9.js"><link rel="prefetch" href="/blog/assets/js/231.755562dc.js"><link rel="prefetch" href="/blog/assets/js/232.a3ce5005.js"><link rel="prefetch" href="/blog/assets/js/233.a5196309.js"><link rel="prefetch" href="/blog/assets/js/234.777d8b0b.js"><link rel="prefetch" href="/blog/assets/js/235.8c560072.js"><link rel="prefetch" href="/blog/assets/js/236.8e8a59be.js"><link rel="prefetch" href="/blog/assets/js/237.1b13e476.js"><link rel="prefetch" href="/blog/assets/js/238.327756ca.js"><link rel="prefetch" href="/blog/assets/js/239.1329b1a0.js"><link rel="prefetch" href="/blog/assets/js/24.1e4c6c90.js"><link rel="prefetch" href="/blog/assets/js/240.df517101.js"><link rel="prefetch" href="/blog/assets/js/241.39364e1b.js"><link rel="prefetch" href="/blog/assets/js/242.b17d4fe7.js"><link rel="prefetch" href="/blog/assets/js/243.cb5c8b6d.js"><link rel="prefetch" href="/blog/assets/js/244.c4223081.js"><link rel="prefetch" href="/blog/assets/js/245.2b182c6b.js"><link rel="prefetch" href="/blog/assets/js/246.2f937266.js"><link rel="prefetch" href="/blog/assets/js/247.1beb3483.js"><link rel="prefetch" href="/blog/assets/js/248.10a2ffcd.js"><link rel="prefetch" href="/blog/assets/js/249.fabf8c51.js"><link rel="prefetch" href="/blog/assets/js/25.733eacdb.js"><link rel="prefetch" href="/blog/assets/js/250.88ff2e08.js"><link rel="prefetch" href="/blog/assets/js/251.c8e0cfed.js"><link rel="prefetch" href="/blog/assets/js/252.fe571fd9.js"><link rel="prefetch" href="/blog/assets/js/253.7f6bff47.js"><link rel="prefetch" href="/blog/assets/js/254.97bdf196.js"><link rel="prefetch" href="/blog/assets/js/255.e0e16dc7.js"><link rel="prefetch" href="/blog/assets/js/256.57add89c.js"><link rel="prefetch" href="/blog/assets/js/257.493ef863.js"><link rel="prefetch" href="/blog/assets/js/258.0664bc69.js"><link rel="prefetch" href="/blog/assets/js/259.adfae2d6.js"><link rel="prefetch" href="/blog/assets/js/26.5c5e543b.js"><link rel="prefetch" href="/blog/assets/js/260.4515a666.js"><link rel="prefetch" href="/blog/assets/js/261.4f6dd9bd.js"><link rel="prefetch" href="/blog/assets/js/262.24eb5e65.js"><link rel="prefetch" href="/blog/assets/js/263.b219449f.js"><link rel="prefetch" href="/blog/assets/js/264.cedf4693.js"><link rel="prefetch" href="/blog/assets/js/265.a267a3d1.js"><link rel="prefetch" href="/blog/assets/js/266.29191aae.js"><link rel="prefetch" href="/blog/assets/js/267.fad4be7e.js"><link rel="prefetch" href="/blog/assets/js/268.d6c53c01.js"><link rel="prefetch" href="/blog/assets/js/269.29dc18ef.js"><link rel="prefetch" href="/blog/assets/js/27.f4ee2a9f.js"><link rel="prefetch" href="/blog/assets/js/270.44d8baf9.js"><link rel="prefetch" href="/blog/assets/js/271.24fde91d.js"><link rel="prefetch" href="/blog/assets/js/272.ae2b61e8.js"><link rel="prefetch" href="/blog/assets/js/273.695ec445.js"><link rel="prefetch" href="/blog/assets/js/274.15263d22.js"><link rel="prefetch" href="/blog/assets/js/275.469971ed.js"><link rel="prefetch" href="/blog/assets/js/276.ae6ab628.js"><link rel="prefetch" href="/blog/assets/js/277.356d7872.js"><link rel="prefetch" href="/blog/assets/js/278.4dbbb621.js"><link rel="prefetch" href="/blog/assets/js/279.a600e634.js"><link rel="prefetch" href="/blog/assets/js/28.99a3ce29.js"><link rel="prefetch" href="/blog/assets/js/280.fa1a081f.js"><link rel="prefetch" href="/blog/assets/js/281.1c4cc352.js"><link rel="prefetch" href="/blog/assets/js/282.68a1b75c.js"><link rel="prefetch" href="/blog/assets/js/283.79033a77.js"><link rel="prefetch" href="/blog/assets/js/284.40cfbab5.js"><link rel="prefetch" href="/blog/assets/js/285.9fa09fdd.js"><link rel="prefetch" href="/blog/assets/js/286.8b262fcd.js"><link rel="prefetch" href="/blog/assets/js/287.9c96c01b.js"><link rel="prefetch" href="/blog/assets/js/288.33336f4a.js"><link rel="prefetch" href="/blog/assets/js/289.13852761.js"><link rel="prefetch" href="/blog/assets/js/29.40cc5e61.js"><link rel="prefetch" href="/blog/assets/js/290.0d8dc13d.js"><link rel="prefetch" href="/blog/assets/js/291.676542dc.js"><link rel="prefetch" href="/blog/assets/js/292.01859b52.js"><link rel="prefetch" href="/blog/assets/js/293.c6259eb7.js"><link rel="prefetch" href="/blog/assets/js/294.964c7cb1.js"><link rel="prefetch" href="/blog/assets/js/295.cbd9f3b6.js"><link rel="prefetch" href="/blog/assets/js/296.e3a00fd0.js"><link rel="prefetch" href="/blog/assets/js/297.3a010374.js"><link rel="prefetch" href="/blog/assets/js/298.714961eb.js"><link rel="prefetch" href="/blog/assets/js/299.6c35d424.js"><link rel="prefetch" href="/blog/assets/js/3.1f418c4c.js"><link rel="prefetch" href="/blog/assets/js/30.5a6e302e.js"><link rel="prefetch" href="/blog/assets/js/300.4a04b49a.js"><link rel="prefetch" href="/blog/assets/js/301.faa4e5d1.js"><link rel="prefetch" href="/blog/assets/js/302.ea18ad40.js"><link rel="prefetch" href="/blog/assets/js/303.b60531e5.js"><link rel="prefetch" href="/blog/assets/js/304.2501f202.js"><link rel="prefetch" href="/blog/assets/js/305.86e75c6c.js"><link rel="prefetch" href="/blog/assets/js/306.ae8d3801.js"><link rel="prefetch" href="/blog/assets/js/307.29bc8c8b.js"><link rel="prefetch" href="/blog/assets/js/308.7d37f1b1.js"><link rel="prefetch" href="/blog/assets/js/309.acb4d509.js"><link rel="prefetch" href="/blog/assets/js/31.5c71bfbd.js"><link rel="prefetch" href="/blog/assets/js/310.98563d62.js"><link rel="prefetch" href="/blog/assets/js/311.bab6c901.js"><link rel="prefetch" href="/blog/assets/js/312.045eee63.js"><link rel="prefetch" href="/blog/assets/js/313.bc78d310.js"><link rel="prefetch" href="/blog/assets/js/314.b411639b.js"><link rel="prefetch" href="/blog/assets/js/315.4866c161.js"><link rel="prefetch" href="/blog/assets/js/316.fca81b27.js"><link rel="prefetch" href="/blog/assets/js/317.cecb9f81.js"><link rel="prefetch" href="/blog/assets/js/318.1fe4f738.js"><link rel="prefetch" href="/blog/assets/js/319.36227f3d.js"><link rel="prefetch" href="/blog/assets/js/32.c9ec45f4.js"><link rel="prefetch" href="/blog/assets/js/320.1c1b82a6.js"><link rel="prefetch" href="/blog/assets/js/321.465f8e12.js"><link rel="prefetch" href="/blog/assets/js/322.3583677f.js"><link rel="prefetch" href="/blog/assets/js/323.762d113f.js"><link rel="prefetch" href="/blog/assets/js/324.38c0146d.js"><link rel="prefetch" href="/blog/assets/js/325.5dc4a28d.js"><link rel="prefetch" href="/blog/assets/js/326.2551a50e.js"><link rel="prefetch" href="/blog/assets/js/327.68a7d949.js"><link rel="prefetch" href="/blog/assets/js/328.c07eaaa3.js"><link rel="prefetch" href="/blog/assets/js/329.6013da73.js"><link rel="prefetch" href="/blog/assets/js/33.0f6b44ba.js"><link rel="prefetch" href="/blog/assets/js/330.5b37677f.js"><link rel="prefetch" href="/blog/assets/js/331.18db4bd4.js"><link rel="prefetch" href="/blog/assets/js/332.5fb942de.js"><link rel="prefetch" href="/blog/assets/js/333.330f573b.js"><link rel="prefetch" href="/blog/assets/js/334.dd391032.js"><link rel="prefetch" href="/blog/assets/js/335.580d63ae.js"><link rel="prefetch" href="/blog/assets/js/336.4b2f55a5.js"><link rel="prefetch" href="/blog/assets/js/337.d73aa372.js"><link rel="prefetch" href="/blog/assets/js/338.bbe933bb.js"><link rel="prefetch" href="/blog/assets/js/339.a4f6296a.js"><link rel="prefetch" href="/blog/assets/js/34.7393aca0.js"><link rel="prefetch" href="/blog/assets/js/340.8a6f7ca3.js"><link rel="prefetch" href="/blog/assets/js/341.17a4a9eb.js"><link rel="prefetch" href="/blog/assets/js/342.795150ca.js"><link rel="prefetch" href="/blog/assets/js/343.f4917f2b.js"><link rel="prefetch" href="/blog/assets/js/344.a18dfbc2.js"><link rel="prefetch" href="/blog/assets/js/345.e23f132f.js"><link rel="prefetch" href="/blog/assets/js/346.6e37a7be.js"><link rel="prefetch" href="/blog/assets/js/347.9c2a40c7.js"><link rel="prefetch" href="/blog/assets/js/348.d14b9fd9.js"><link rel="prefetch" href="/blog/assets/js/349.f1ef1880.js"><link rel="prefetch" href="/blog/assets/js/35.a49d75d1.js"><link rel="prefetch" href="/blog/assets/js/350.32f6c4ca.js"><link rel="prefetch" href="/blog/assets/js/351.69623b37.js"><link rel="prefetch" href="/blog/assets/js/352.cb8ad19f.js"><link rel="prefetch" href="/blog/assets/js/353.6258798a.js"><link rel="prefetch" href="/blog/assets/js/354.2ddb5522.js"><link rel="prefetch" href="/blog/assets/js/355.ea4b4743.js"><link rel="prefetch" href="/blog/assets/js/356.b154f500.js"><link rel="prefetch" href="/blog/assets/js/357.65975977.js"><link rel="prefetch" href="/blog/assets/js/358.23adf590.js"><link rel="prefetch" href="/blog/assets/js/359.6411a785.js"><link rel="prefetch" href="/blog/assets/js/36.357268c4.js"><link rel="prefetch" href="/blog/assets/js/360.36fe543e.js"><link rel="prefetch" href="/blog/assets/js/361.9b0cdf0d.js"><link rel="prefetch" href="/blog/assets/js/362.3d24e5be.js"><link rel="prefetch" href="/blog/assets/js/363.82d0e185.js"><link rel="prefetch" href="/blog/assets/js/364.9dbca592.js"><link rel="prefetch" href="/blog/assets/js/365.87f9f27f.js"><link rel="prefetch" href="/blog/assets/js/366.f9dbf674.js"><link rel="prefetch" href="/blog/assets/js/367.c6f2fc0d.js"><link rel="prefetch" href="/blog/assets/js/368.ae1c4cd9.js"><link rel="prefetch" href="/blog/assets/js/369.dad02463.js"><link rel="prefetch" href="/blog/assets/js/37.699e96a4.js"><link rel="prefetch" href="/blog/assets/js/370.a44c2d22.js"><link rel="prefetch" href="/blog/assets/js/371.60148eb0.js"><link rel="prefetch" href="/blog/assets/js/372.d527b64f.js"><link rel="prefetch" href="/blog/assets/js/373.bd8cad3b.js"><link rel="prefetch" href="/blog/assets/js/375.cac9df36.js"><link rel="prefetch" href="/blog/assets/js/376.328237f2.js"><link rel="prefetch" href="/blog/assets/js/377.016b8416.js"><link rel="prefetch" href="/blog/assets/js/378.2fc048f6.js"><link rel="prefetch" href="/blog/assets/js/379.9e74dcf8.js"><link rel="prefetch" href="/blog/assets/js/38.34ca2a7c.js"><link rel="prefetch" href="/blog/assets/js/380.86885af1.js"><link rel="prefetch" href="/blog/assets/js/381.e2b48247.js"><link rel="prefetch" href="/blog/assets/js/382.c16e71de.js"><link rel="prefetch" href="/blog/assets/js/383.d24f4353.js"><link rel="prefetch" href="/blog/assets/js/384.e3310c32.js"><link rel="prefetch" href="/blog/assets/js/385.fc8c2fc1.js"><link rel="prefetch" href="/blog/assets/js/386.1df25ded.js"><link rel="prefetch" href="/blog/assets/js/387.a07d55de.js"><link rel="prefetch" href="/blog/assets/js/388.3c47bc6a.js"><link rel="prefetch" href="/blog/assets/js/389.2438aa8d.js"><link rel="prefetch" href="/blog/assets/js/39.7f20b0d9.js"><link rel="prefetch" href="/blog/assets/js/4.8fdfb609.js"><link rel="prefetch" href="/blog/assets/js/40.6d80232f.js"><link rel="prefetch" href="/blog/assets/js/41.3dc22483.js"><link rel="prefetch" href="/blog/assets/js/42.9266830c.js"><link rel="prefetch" href="/blog/assets/js/43.13ed836d.js"><link rel="prefetch" href="/blog/assets/js/44.ce19002c.js"><link rel="prefetch" href="/blog/assets/js/45.ffba4a5f.js"><link rel="prefetch" href="/blog/assets/js/46.57a6c367.js"><link rel="prefetch" href="/blog/assets/js/47.720d6944.js"><link rel="prefetch" href="/blog/assets/js/48.32a45359.js"><link rel="prefetch" href="/blog/assets/js/49.08be0ac9.js"><link rel="prefetch" href="/blog/assets/js/5.da8e08b7.js"><link rel="prefetch" href="/blog/assets/js/50.bd905c91.js"><link rel="prefetch" href="/blog/assets/js/51.8a8dc2ca.js"><link rel="prefetch" href="/blog/assets/js/52.37ed25fd.js"><link rel="prefetch" href="/blog/assets/js/53.ca48f0a3.js"><link rel="prefetch" href="/blog/assets/js/54.67e2f7a4.js"><link rel="prefetch" href="/blog/assets/js/55.5e07c82d.js"><link rel="prefetch" href="/blog/assets/js/56.ddb2053e.js"><link rel="prefetch" href="/blog/assets/js/57.0b33bd51.js"><link rel="prefetch" href="/blog/assets/js/58.ee4f3762.js"><link rel="prefetch" href="/blog/assets/js/59.6b9f0db1.js"><link rel="prefetch" href="/blog/assets/js/6.c4026208.js"><link rel="prefetch" href="/blog/assets/js/60.32f4e251.js"><link rel="prefetch" href="/blog/assets/js/61.44160dab.js"><link rel="prefetch" href="/blog/assets/js/62.babaf5fd.js"><link rel="prefetch" href="/blog/assets/js/63.8f388452.js"><link rel="prefetch" href="/blog/assets/js/64.9b08297e.js"><link rel="prefetch" href="/blog/assets/js/65.7c1f4203.js"><link rel="prefetch" href="/blog/assets/js/66.54d0ddc9.js"><link rel="prefetch" href="/blog/assets/js/67.99ac618a.js"><link rel="prefetch" href="/blog/assets/js/68.15dcce17.js"><link rel="prefetch" href="/blog/assets/js/69.dec055cd.js"><link rel="prefetch" href="/blog/assets/js/7.8c9db17d.js"><link rel="prefetch" href="/blog/assets/js/70.f2776835.js"><link rel="prefetch" href="/blog/assets/js/71.0bae83c7.js"><link rel="prefetch" href="/blog/assets/js/72.19b05b89.js"><link rel="prefetch" href="/blog/assets/js/73.fd3eaaf8.js"><link rel="prefetch" href="/blog/assets/js/74.d45296ef.js"><link rel="prefetch" href="/blog/assets/js/75.8c61bf35.js"><link rel="prefetch" href="/blog/assets/js/76.2caa63bd.js"><link rel="prefetch" href="/blog/assets/js/77.81aa8e2e.js"><link rel="prefetch" href="/blog/assets/js/78.cb9b4d98.js"><link rel="prefetch" href="/blog/assets/js/79.48fee5ee.js"><link rel="prefetch" href="/blog/assets/js/8.aa698228.js"><link rel="prefetch" href="/blog/assets/js/80.149bbc01.js"><link rel="prefetch" href="/blog/assets/js/81.0d5b03bb.js"><link rel="prefetch" href="/blog/assets/js/82.6f8c68ba.js"><link rel="prefetch" href="/blog/assets/js/83.d48bc255.js"><link rel="prefetch" href="/blog/assets/js/84.eb7a156f.js"><link rel="prefetch" href="/blog/assets/js/85.d581b626.js"><link rel="prefetch" href="/blog/assets/js/86.bf82005a.js"><link rel="prefetch" href="/blog/assets/js/87.f6c340c5.js"><link rel="prefetch" href="/blog/assets/js/88.46b322b7.js"><link rel="prefetch" href="/blog/assets/js/89.a503331c.js"><link rel="prefetch" href="/blog/assets/js/9.93b818e1.js"><link rel="prefetch" href="/blog/assets/js/90.12ee3e24.js"><link rel="prefetch" href="/blog/assets/js/91.85a0f049.js"><link rel="prefetch" href="/blog/assets/js/92.9a4e240d.js"><link rel="prefetch" href="/blog/assets/js/93.e7943a53.js"><link rel="prefetch" href="/blog/assets/js/94.26853de3.js"><link rel="prefetch" href="/blog/assets/js/95.cb491ec9.js"><link rel="prefetch" href="/blog/assets/js/96.12a1d68e.js"><link rel="prefetch" href="/blog/assets/js/97.3d2b0d42.js"><link rel="prefetch" href="/blog/assets/js/98.92a62020.js"><link rel="prefetch" href="/blog/assets/js/99.d0779480.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b3e5b934.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">OneYoung’s Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Basic
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html/" class="nav-link">
  HTML
</a></li></ul></li><li class="dropdown-item"><h4>
          Feature
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-subitem"><a href="/blog/FE/css3/1.start.html" class="nav-link">
  CSS3
</a></li><li class="dropdown-subitem"><a href="/blog/FE/worker/1.WebWorker.html" class="nav-link">
  Worker
</a></li><li class="dropdown-subitem"><a href="/blog/FE/PWA/" class="nav-link">
  PWA
</a></li><li class="dropdown-subitem"><a href="/blog/FE/rendering/1.start.html" class="nav-link">
  Rendering
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/javascript/BOM/1.start.html" class="nav-link">
  BOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/DOM/1.start.html" class="nav-link">
  DOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/ECMAScript/1.start.html" class="nav-link">
  ECMAScript
</a></li></ul></li><li class="dropdown-item"><h4>
          JS进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/js-advance/es6/" class="nav-link">
  ES6
</a></li><li class="dropdown-subitem"><a href="/blog/FE/js-advance/module/1.start.html" class="nav-link">
  Module
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架及库" class="dropdown-title"><span class="title">框架及库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Axios
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/axios/base/1.install.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/axios/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Vue2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/vue2/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/vue2/source-code/compiler/" class="nav-link">
  compiler
</a></li></ul></li><li class="dropdown-item"><h4>
          Nuxt
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/nuxt/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Express
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/express/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/express/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Koa
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/koa/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/koa/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          CryptoJs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/crypto-js/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机科学" class="dropdown-title"><span class="title">计算机科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cs/string/1.unicode.html" class="nav-link">
  String
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/digit/1.start.html" class="nav-link">
  Digit
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/binary-file/1.start.html" class="nav-link">
  二进制数据与文件
</a></li><li class="dropdown-item"><h4>
          HTTP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/http/communication.html" class="nav-link">
  通信过程
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/url.html" class="nav-link">
  URL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/formdata.html" class="nav-link">
  FormData
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/xhr-fetch.html" class="nav-link">
  XHR/Fetch
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cors.html" class="nav-link">
  CORS
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cookie.html" class="nav-link">
  Cookie
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/security.html" class="nav-link">
  网络安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/upload.html" class="nav-link">
  文件上传
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/download.html" class="nav-link">
  文件下载
</a></li></ul></li><li class="dropdown-item"><h4>
          HTTPS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/https/encryption.html" class="nav-link">
  数据安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/tls&amp;ssl.html" class="nav-link">
  TLS与SSL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/setup.html" class="nav-link">
  项目配置SSL
</a></li></ul></li><li class="dropdown-item"><h4>
          高级
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/advance/design-pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/data-structures/" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/algorithm/" class="nav-link">
  算法
</a></li></ul></li><li class="dropdown-item"><h4>
          IM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/im/sse/" class="nav-link">
  SSE
</a></li><li class="dropdown-subitem"><a href="/blog/cs/im/websocket/" class="nav-link">
  Websocket
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="跨平台" class="dropdown-title"><span class="title">跨平台</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cross/h5/" class="nav-link">
  H5
</a></li><li class="dropdown-item"><!----> <a href="/blog/cross/weChat-public/1.authorization.html" class="nav-link">
  微信公众号
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/engineer/git/1.start.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/engineer/ts/1.start.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><h4>
          Package Manager
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/npm/1.start.html" class="nav-link">
  NPM
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/yarn/1.start.html" class="nav-link">
  Yarn
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/pnpm/1.start.html" class="nav-link">
  PNPM
</a></li></ul></li><li class="dropdown-item"><h4>
          MonoRepo
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/workspace/1.start.html" class="nav-link">
  Workspace
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/lerna/1.start.html" class="nav-link">
  Lerna
</a></li></ul></li><li class="dropdown-item"><h4>
          Assist
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/babel/1.start.html" class="nav-link">
  Babel
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/postcss/1.start.html" class="nav-link">
  Postcss
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/eslint/1.start.html" class="nav-link">
  Eslint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/prettier/1.start.html" class="nav-link">
  Prettier
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/husky/" class="nav-link">
  Husky
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/commitlint/" class="nav-link">
  CommitLint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/conventional-changelog/" class="nav-link">
  Conventional Changelog
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/standard-version/" class="nav-link">
  Standard Version
</a></li></ul></li><li class="dropdown-item"><h4>
          Bundler
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/gulp/1.start.html" class="nav-link">
  Gulp
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/rollup/1.introduction.html" class="nav-link">
  Rollup
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/webpack/1.start.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/vite/" class="nav-link">
  Vite
</a></li></ul></li><li class="dropdown-item"><h4>
          Misc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/misc/obfuscator/" class="nav-link">
  Debugger &amp; Obfuscator
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/BE/standard/" class="nav-link">
  Standard
</a></li><li class="dropdown-item"><h4>
          认证与授权
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/authentication/jwt/" class="nav-link">
  JWT
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/oauth2/" class="nav-link">
  OAuth2.0
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/2fa/" class="nav-link">
  2FA
</a></li></ul></li><li class="dropdown-item"><h4>
          SSR
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssr-vue2/" class="nav-link">
  SSR Vue2
</a></li><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssg-vue2/" class="nav-link">
  SSG Vue2
</a></li></ul></li><li class="dropdown-item"><h4>
          Node
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/node/awesome/" class="nav-link">
  Awesome
</a></li><li class="dropdown-subitem"><a href="/blog/BE/node/docs/" class="nav-link">
  Docs
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/DB/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mongodb/" class="nav-link">
  Mongodb
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="部署" class="dropdown-title"><span class="title">部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/deploy/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/shell/1.start.html" class="nav-link">
  Shell
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/CI-CD/1.start.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/jenkins/1.start.html" class="nav-link">
  Jenkins
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tool/github/" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/charles/" class="nav-link">
  Charles
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/verdaccio/" class="nav-link">
  Verdaccio
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/remote-ssh/" class="nav-link">
  Remote-SSH
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/localtunnel/" class="nav-link">
  Localtunnel
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/AI/" class="nav-link">
  AI工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/oneyoung19" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Basic
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html/" class="nav-link">
  HTML
</a></li></ul></li><li class="dropdown-item"><h4>
          Feature
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html5/" class="nav-link">
  HTML5
</a></li><li class="dropdown-subitem"><a href="/blog/FE/css3/1.start.html" class="nav-link">
  CSS3
</a></li><li class="dropdown-subitem"><a href="/blog/FE/worker/1.WebWorker.html" class="nav-link">
  Worker
</a></li><li class="dropdown-subitem"><a href="/blog/FE/PWA/" class="nav-link">
  PWA
</a></li><li class="dropdown-subitem"><a href="/blog/FE/rendering/1.start.html" class="nav-link">
  Rendering
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/javascript/BOM/1.start.html" class="nav-link">
  BOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/DOM/1.start.html" class="nav-link">
  DOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/ECMAScript/1.start.html" class="nav-link">
  ECMAScript
</a></li></ul></li><li class="dropdown-item"><h4>
          JS进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/js-advance/es6/" class="nav-link">
  ES6
</a></li><li class="dropdown-subitem"><a href="/blog/FE/js-advance/module/1.start.html" class="nav-link">
  Module
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架及库" class="dropdown-title"><span class="title">框架及库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Axios
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/axios/base/1.install.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/axios/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Vue2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/vue2/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/vue2/source-code/compiler/" class="nav-link">
  compiler
</a></li></ul></li><li class="dropdown-item"><h4>
          Nuxt
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/nuxt/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Express
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/express/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/express/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Koa
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/koa/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/koa/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          CryptoJs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/crypto-js/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机科学" class="dropdown-title"><span class="title">计算机科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cs/string/1.unicode.html" class="nav-link">
  String
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/digit/1.start.html" class="nav-link">
  Digit
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/binary-file/1.start.html" class="nav-link">
  二进制数据与文件
</a></li><li class="dropdown-item"><h4>
          HTTP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/http/communication.html" class="nav-link">
  通信过程
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/url.html" class="nav-link">
  URL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/formdata.html" class="nav-link">
  FormData
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/xhr-fetch.html" class="nav-link">
  XHR/Fetch
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cors.html" class="nav-link">
  CORS
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cookie.html" class="nav-link">
  Cookie
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/security.html" class="nav-link">
  网络安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/upload.html" class="nav-link">
  文件上传
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/download.html" class="nav-link">
  文件下载
</a></li></ul></li><li class="dropdown-item"><h4>
          HTTPS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/https/encryption.html" class="nav-link">
  数据安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/tls&amp;ssl.html" class="nav-link">
  TLS与SSL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/setup.html" class="nav-link">
  项目配置SSL
</a></li></ul></li><li class="dropdown-item"><h4>
          高级
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/advance/design-pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/data-structures/" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/algorithm/" class="nav-link">
  算法
</a></li></ul></li><li class="dropdown-item"><h4>
          IM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/im/sse/" class="nav-link">
  SSE
</a></li><li class="dropdown-subitem"><a href="/blog/cs/im/websocket/" class="nav-link">
  Websocket
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="跨平台" class="dropdown-title"><span class="title">跨平台</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cross/h5/" class="nav-link">
  H5
</a></li><li class="dropdown-item"><!----> <a href="/blog/cross/weChat-public/1.authorization.html" class="nav-link">
  微信公众号
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/engineer/git/1.start.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/engineer/ts/1.start.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><h4>
          Package Manager
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/npm/1.start.html" class="nav-link">
  NPM
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/yarn/1.start.html" class="nav-link">
  Yarn
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/pnpm/1.start.html" class="nav-link">
  PNPM
</a></li></ul></li><li class="dropdown-item"><h4>
          MonoRepo
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/workspace/1.start.html" class="nav-link">
  Workspace
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/lerna/1.start.html" class="nav-link">
  Lerna
</a></li></ul></li><li class="dropdown-item"><h4>
          Assist
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/babel/1.start.html" class="nav-link">
  Babel
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/postcss/1.start.html" class="nav-link">
  Postcss
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/eslint/1.start.html" class="nav-link">
  Eslint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/prettier/1.start.html" class="nav-link">
  Prettier
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/husky/" class="nav-link">
  Husky
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/commitlint/" class="nav-link">
  CommitLint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/conventional-changelog/" class="nav-link">
  Conventional Changelog
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/standard-version/" class="nav-link">
  Standard Version
</a></li></ul></li><li class="dropdown-item"><h4>
          Bundler
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/gulp/1.start.html" class="nav-link">
  Gulp
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/rollup/1.introduction.html" class="nav-link">
  Rollup
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/webpack/1.start.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/vite/" class="nav-link">
  Vite
</a></li></ul></li><li class="dropdown-item"><h4>
          Misc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/misc/obfuscator/" class="nav-link">
  Debugger &amp; Obfuscator
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/BE/standard/" class="nav-link">
  Standard
</a></li><li class="dropdown-item"><h4>
          认证与授权
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/authentication/jwt/" class="nav-link">
  JWT
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/oauth2/" class="nav-link">
  OAuth2.0
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/2fa/" class="nav-link">
  2FA
</a></li></ul></li><li class="dropdown-item"><h4>
          SSR
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssr-vue2/" class="nav-link">
  SSR Vue2
</a></li><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssg-vue2/" class="nav-link">
  SSG Vue2
</a></li></ul></li><li class="dropdown-item"><h4>
          Node
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/node/awesome/" class="nav-link">
  Awesome
</a></li><li class="dropdown-subitem"><a href="/blog/BE/node/docs/" class="nav-link">
  Docs
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/DB/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mongodb/" class="nav-link">
  Mongodb
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="部署" class="dropdown-title"><span class="title">部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/deploy/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/shell/1.start.html" class="nav-link">
  Shell
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/CI-CD/1.start.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/jenkins/1.start.html" class="nav-link">
  Jenkins
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tool/github/" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/charles/" class="nav-link">
  Charles
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/verdaccio/" class="nav-link">
  Verdaccio
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/remote-ssh/" class="nav-link">
  Remote-SSH
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/localtunnel/" class="nav-link">
  Localtunnel
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/AI/" class="nav-link">
  AI工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/oneyoung19" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>在 <code>Vue</code> 中会注入以下渲染工具函数：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">installRenderHelpers</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  target<span class="token punctuation">.</span>_o <span class="token operator">=</span> markOnce
  target<span class="token punctuation">.</span>_n <span class="token operator">=</span> toNumber
  target<span class="token punctuation">.</span>_s <span class="token operator">=</span> toString
  target<span class="token punctuation">.</span>_l <span class="token operator">=</span> renderList
  target<span class="token punctuation">.</span>_t <span class="token operator">=</span> renderSlot
  target<span class="token punctuation">.</span>_q <span class="token operator">=</span> looseEqual
  target<span class="token punctuation">.</span>_i <span class="token operator">=</span> looseIndexOf
  target<span class="token punctuation">.</span>_m <span class="token operator">=</span> renderStatic
  target<span class="token punctuation">.</span>_f <span class="token operator">=</span> resolveFilter
  target<span class="token punctuation">.</span>_k <span class="token operator">=</span> checkKeyCodes
  target<span class="token punctuation">.</span>_b <span class="token operator">=</span> bindObjectProps
  target<span class="token punctuation">.</span>_v <span class="token operator">=</span> createTextVNode
  target<span class="token punctuation">.</span>_e <span class="token operator">=</span> createEmptyVNode
  target<span class="token punctuation">.</span>_u <span class="token operator">=</span> resolveScopedSlots
  target<span class="token punctuation">.</span>_g <span class="token operator">=</span> bindObjectListeners
  target<span class="token punctuation">.</span>_d <span class="token operator">=</span> bindDynamicKeys
  target<span class="token punctuation">.</span>_p <span class="token operator">=</span> prependModifier
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_1-markonce"><a href="#_1-markonce" class="header-anchor">#</a> 1.markOnce</h2> <p><code>markOnce</code> 即 <code>_o</code>。</p> <p><strong>该函数只会包裹处理 <code>v-for</code> 循环中的 <code>v-once</code> 节点</strong>。</p> <p>譬如有如下 <code>template</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item in list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-once</span><span class="token punctuation">&gt;</span></span>{{ once }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-once</span><span class="token punctuation">&gt;</span></span>{{ once2 }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>其中的 <code>once2</code> 节点会直接当做 <code>static</code> 节点，用 <code>_m</code> 包裹，而 <code>v-for</code> 中的 <code>once</code> 节点则是用 <code>_o</code> 包裹。</p> <p>我们将上述 <code>template</code> 解析为 <code>render</code> 字符串的话，会得到如下结果：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;render&quot;</span><span class="token operator">:</span> <span class="token string">&quot;with(this){return _c('div',[_l((list),function(item){return _c('div',{key:item},[_o(_c('div',[_v(_s(once))]),0,item)],1)}),_v(\&quot; \&quot;),_m(0)],2)}&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;staticRenderFns&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;with(this){return _c('div',[_v(_s(once2))])}&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>当我们知道上述结论之后，那么 <code>markOnce</code> 的作用就是对 <code>v-for</code> 循环中的 <code>v-once</code> 节点做额外标记：</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Runtime helper for v-once.
 * Effectively it means marking the node as static with a unique key.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">markOnce</span><span class="token punctuation">(</span>
  <span class="token parameter">tree<span class="token operator">:</span> VNode <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token builtin">string</span></span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">markStatic</span><span class="token punctuation">(</span>tree<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">__once__</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> tree
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">markStatic</span><span class="token punctuation">(</span><span class="token parameter">tree<span class="token operator">:</span> VNode <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> isOnce<span class="token operator">:</span> <span class="token builtin">boolean</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tree<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>tree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> tree<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">markStaticNode</span><span class="token punctuation">(</span>tree<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> isOnce<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">markStaticNode</span><span class="token punctuation">(</span>tree<span class="token punctuation">,</span> key<span class="token punctuation">,</span> isOnce<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">markStaticNode</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> key<span class="token punctuation">,</span> isOnce</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  node<span class="token punctuation">.</span>isStatic <span class="token operator">=</span> <span class="token boolean">true</span>
  node<span class="token punctuation">.</span>key <span class="token operator">=</span> key
  node<span class="token punctuation">.</span>isOnce <span class="token operator">=</span> isOnce
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_2-tonumber"><a href="#_2-tonumber" class="header-anchor">#</a> 2.toNumber</h2> <p><code>toNumber</code> 即 <code>_n</code>。</p> <p><strong>该函数用来做数字类型转化</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Convert an input value to a number for persistence.
 * If the conversion fails, return original string.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> n <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">?</span> val <span class="token operator">:</span> n
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_3-tostring"><a href="#_3-tostring" class="header-anchor">#</a> 3.toString</h2> <p><code>toString</code> 即 <code>_s</code>。</p> <p><strong>该函数用来做字符串类型转化</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Convert a value to a string that is actually rendered.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> val <span class="token operator">==</span> <span class="token keyword">null</span>
    <span class="token operator">?</span> <span class="token string">''</span>
    <span class="token operator">:</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> val<span class="token punctuation">.</span>toString <span class="token operator">===</span> _toString<span class="token punctuation">)</span>
    <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> replacer<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">replacer</span><span class="token punctuation">(</span><span class="token parameter">_key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> val<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
  <span class="token comment">// avoid circular deps from v3</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">&amp;&amp;</span> val<span class="token punctuation">.</span>__v_isRef<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> val<span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> val
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_4-renderlist"><a href="#_4-renderlist" class="header-anchor">#</a> 4.renderList</h2> <p><code>renderList</code> 即 <code>_l</code>。</p> <p><strong>该函数用来渲染列表</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Runtime helper for rendering v-for lists.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">renderList</span><span class="token punctuation">(</span>
  val<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">val<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> keyOrIndex<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">,</span> index<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> VNode
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> ret<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    i<span class="token punctuation">,</span>
    l<span class="token punctuation">,</span>
    keys<span class="token punctuation">,</span>
    key
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> val<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ret<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>val<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> val<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ret<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObject</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hasSymbol <span class="token operator">&amp;&amp;</span> val<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">const</span> iterator<span class="token operator">:</span> Iterator<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=</span> val<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">let</span> result <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ret<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">render</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>value<span class="token punctuation">,</span> ret<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
        result <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
      ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>keys<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        key <span class="token operator">=</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        ret<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>val<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isDef</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">;</span><span class="token punctuation">(</span>ret <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>_isVList <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">return</span> ret
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="_5-renderslot"><a href="#_5-renderslot" class="header-anchor">#</a> 5.renderSlot</h2> <p><code>renderSlot</code> 即 <code>_t</code>。</p> <p><strong>该函数用来渲染 <code>&lt;slot&gt;</code> 插槽</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Runtime helper for rendering &lt;slot&gt;
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">renderSlot</span><span class="token punctuation">(</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  fallbackRender<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  bindObject<span class="token operator">:</span> object <span class="token operator">|</span> <span class="token keyword">null</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> scopedSlotFn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$scopedSlots<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
  <span class="token keyword">let</span> nodes
  <span class="token keyword">if</span> <span class="token punctuation">(</span>scopedSlotFn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// scoped slot</span>
    props <span class="token operator">=</span> props <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bindObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__ <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>bindObject<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'slot v-bind without argument expects an Object'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      props <span class="token operator">=</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> bindObject<span class="token punctuation">)</span><span class="token punctuation">,</span> props<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    nodes <span class="token operator">=</span>
      <span class="token function">scopedSlotFn</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>fallbackRender<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">fallbackRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> fallbackRender<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    nodes <span class="token operator">=</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">||</span>
      <span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>fallbackRender<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">fallbackRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> fallbackRender<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> target <span class="token operator">=</span> props <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span>slot
  <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$createElement</span><span class="token punctuation">(</span><span class="token string">'template'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> slot<span class="token operator">:</span> target <span class="token punctuation">}</span><span class="token punctuation">,</span> nodes<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> nodes
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="_6-looseequal"><a href="#_6-looseequal" class="header-anchor">#</a> 6.looseEqual</h2> <p><code>looseEqual</code> 即 <code>_q</code>。</p> <p><strong>该函数用来宽松的比较两个值是否相等</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Check if two values are loosely equal - that is,
 * if they are plain objects, do they have the same shape?
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">looseEqual</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> b<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token keyword">const</span> isObjectA <span class="token operator">=</span> <span class="token function">isObject</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  <span class="token keyword">const</span> isObjectB <span class="token operator">=</span> <span class="token function">isObject</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isObjectA <span class="token operator">&amp;&amp;</span> isObjectB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> isArrayA <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
      <span class="token keyword">const</span> isArrayB <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>isArrayA <span class="token operator">&amp;&amp;</span> isArrayB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          a<span class="token punctuation">.</span>length <span class="token operator">===</span> b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span>
          a<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> i<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">looseEqual</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token keyword">instanceof</span> <span class="token class-name">Date</span> <span class="token operator">&amp;&amp;</span> b <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> b<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isArrayA <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isArrayB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> keysA <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        <span class="token keyword">const</span> keysB <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          keysA<span class="token punctuation">.</span>length <span class="token operator">===</span> keysB<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span>
          keysA<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">looseEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">/* istanbul ignore next */</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">/* istanbul ignore next */</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isObjectA <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isObjectB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">String</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="_7-looseindexof"><a href="#_7-looseindexof" class="header-anchor">#</a> 7.looseIndexOf</h2> <p><code>looseIndexOf</code> 即 <code>_i</code>。</p> <p><strong>该函数用来宽松的获取索引</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Return the first index at which a loosely equal value can be
 * found in the array (if value is a plain object, the array must
 * contain an object of the same shape), or -1 if it is not present.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">looseIndexOf</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">unknown</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> val<span class="token operator">:</span> <span class="token builtin">unknown</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">looseEqual</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> i
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_8-renderstatic"><a href="#_8-renderstatic" class="header-anchor">#</a> 8.renderStatic</h2> <p><code>renderStatic</code> 即 <code>_m</code>。</p> <p><strong>该函数用来渲染 <code>static</code> 静态节点</strong>。</p> <ol><li>缓存静态树：</li></ol> <ul><li>函数维护了一个 <code>_staticTrees</code> 数组来缓存已经渲染过的静态树</li> <li>通过 <code>index</code> 参数来索引不同的静态树</li></ul> <ol start="2"><li>优化性能：</li></ol> <ul><li>如果某个静态树已经被渲染过（即在缓存中存在），并且不是在 <code>v-for</code> 循环中使用（<code>isInFor</code> 为 <code>false</code>），就直接返回缓存的树，避免重复渲染</li> <li>这种缓存机制可以显著提高性能，因为静态内容不需要重新创建 <code>VNode</code></li></ul> <ol start="3"><li>渲染新树：</li></ol> <ul><li>如果缓存中没有，或者是在 <code>v-for</code> 中使用，就会重新渲染一个新的树</li> <li>使用 <code>staticRenderFns</code> 来生成新的 <code>VNode</code> 树</li> <li>生成后会用 <code>markStatic</code> 标记这个树为静态内容</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Runtime helper for rendering static trees.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">renderStatic</span><span class="token punctuation">(</span>
  <span class="token parameter">index<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  isInFor<span class="token operator">:</span> <span class="token builtin">boolean</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> VNode <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>VNode<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cached <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_staticTrees <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_staticTrees <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> tree <span class="token operator">=</span> cached<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
  <span class="token comment">// if has already-rendered static tree and not inside v-for,</span>
  <span class="token comment">// we can reuse the same tree.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>tree <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isInFor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> tree
  <span class="token punctuation">}</span>
  <span class="token comment">// otherwise, render a fresh tree.</span>
  tree <span class="token operator">=</span> cached<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>staticRenderFns<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_renderProxy<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_c<span class="token punctuation">,</span>
    <span class="token keyword">this</span> <span class="token comment">// for render fns generated for functional component templates</span>
  <span class="token punctuation">)</span>
  <span class="token function">markStatic</span><span class="token punctuation">(</span>tree<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">__static__</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> tree
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_9-resolvefilter"><a href="#_9-resolvefilter" class="header-anchor">#</a> 9.resolveFilter</h2> <p><code>resolveFilter</code> 即 <code>_f</code>。</p> <p><strong>该函数用来解析过滤器</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Runtime helper for resolving filters
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">resolveFilter</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Function</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">resolveAsset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">,</span> <span class="token string">'filters'</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">||</span> identity
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Return the same value.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">identity</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> _
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_10-checkkeycodes"><a href="#_10-checkkeycodes" class="header-anchor">#</a> 10.checkKeyCodes</h2> <p><code>checkKeyCodes</code> 即 <code>_k</code>。</p> <p><strong>该函数用来检测键盘码值</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Runtime helper for checking keyCodes from config.
 * exposed as Vue.prototype._k
 * passing in eventKeyName as last argument separately for backwards compat
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">checkKeyCodes</span><span class="token punctuation">(</span>
  <span class="token parameter">eventKeyCode<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  builtInKeyCode<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  eventKeyName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  builtInKeyName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mappedKeyCode <span class="token operator">=</span> config<span class="token punctuation">.</span>keyCodes<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> builtInKeyCode
  <span class="token keyword">if</span> <span class="token punctuation">(</span>builtInKeyName <span class="token operator">&amp;&amp;</span> eventKeyName <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>config<span class="token punctuation">.</span>keyCodes<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">isKeyNotMatch</span><span class="token punctuation">(</span>builtInKeyName<span class="token punctuation">,</span> eventKeyName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mappedKeyCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">isKeyNotMatch</span><span class="token punctuation">(</span>mappedKeyCode<span class="token punctuation">,</span> eventKeyCode<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>eventKeyName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">hyphenate</span><span class="token punctuation">(</span>eventKeyName<span class="token punctuation">)</span> <span class="token operator">!==</span> key
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> eventKeyCode <span class="token operator">===</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_11-bindobjectprops"><a href="#_11-bindobjectprops" class="header-anchor">#</a> 11.bindObjectProps</h2> <p><code>bindObjectProps</code> 即 <code>_b</code>。</p> <p><strong>该函数用来处理 <code>v-bind</code> 绑定的对象，并将其正确解析</strong>。</p> <p>譬如有如下 <code>template</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 这样的绑定 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{ value: msg, 'data-test': 'foo' }<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>会被解析为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  domProps<span class="token operator">:</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> msg <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token comment">// value 是 DOM 属性</span>
  attrs<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">'data-test'</span><span class="token operator">:</span> <span class="token string">'foo'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>   <span class="token comment">// data-test 是 HTML 属性</span>
  on<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'update:value'</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">$event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> msg <span class="token operator">=</span> $event <span class="token punctuation">}</span>  <span class="token comment">// 双向绑定处理器</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">/**
 * Runtime helper for merging v-bind=&quot;object&quot; into a VNode's data.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">bindObjectProps</span><span class="token punctuation">(</span>
  data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>        <span class="token comment">// VNode 的数据对象</span>
  tag<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>      <span class="token comment">// 标签名称</span>
  value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>       <span class="token comment">// v-bind 绑定的值</span>
  asProp<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>  <span class="token comment">// 是否作为 DOM 属性处理</span>
  isSync<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>  <span class="token comment">// 是否需要双向绑定</span>
<span class="token punctuation">)</span><span class="token operator">:</span> VNodeData <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 检查值是否为对象或数组</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 开发环境下发出警告</span>
      __DEV__ <span class="token operator">&amp;&amp;</span> <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'v-bind without argument expects an Object or Array value'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果是数组，转换为对象</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        value <span class="token operator">=</span> <span class="token function">toObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      
      <span class="token keyword">let</span> hash
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 特殊属性处理：class、style 和保留属性直接放入 data</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'class'</span> <span class="token operator">||</span> key <span class="token operator">===</span> <span class="token string">'style'</span> <span class="token operator">||</span> <span class="token function">isReservedAttribute</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          hash <span class="token operator">=</span> data
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 获取元素的 type 属性</span>
          <span class="token keyword">const</span> <span class="token keyword">type</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>attrs <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span>attrs<span class="token punctuation">.</span><span class="token keyword">type</span>
          <span class="token comment">// 决定属性放在 domProps 还是 attrs 中</span>
          hash <span class="token operator">=</span>
            asProp <span class="token operator">||</span> config<span class="token punctuation">.</span><span class="token function">mustUseProp</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token keyword">type</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>
              <span class="token operator">?</span> data<span class="token punctuation">.</span>domProps <span class="token operator">||</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>domProps <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// DOM 属性</span>
              <span class="token operator">:</span> data<span class="token punctuation">.</span>attrs <span class="token operator">||</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>attrs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>       <span class="token comment">// HTML 属性</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 生成属性的驼峰式和连字符式名称</span>
        <span class="token keyword">const</span> camelizedKey <span class="token operator">=</span> <span class="token function">camelize</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>    <span class="token comment">// 例如：my-prop → myProp</span>
        <span class="token keyword">const</span> hyphenatedKey <span class="token operator">=</span> <span class="token function">hyphenate</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>  <span class="token comment">// 例如：myProp → my-prop</span>

        <span class="token comment">// 如果属性不存在（两种形式都检查），则添加该属性</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>camelizedKey <span class="token keyword">in</span> hash<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>hyphenatedKey <span class="token keyword">in</span> hash<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          hash<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

          <span class="token comment">// 处理双向绑定</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>isSync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 创建或获取事件对象</span>
            <span class="token keyword">const</span> on <span class="token operator">=</span> data<span class="token punctuation">.</span>on <span class="token operator">||</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>on <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token comment">// 添加 update:属性名 事件处理器</span>
            on<span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">update:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              value<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> $event
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> data
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h2 id="_12-createtextvnode"><a href="#_12-createtextvnode" class="header-anchor">#</a> 12.createTextVNode</h2> <p><code>createTextVNode</code> 即 <code>_v</code>。</p> <p><strong>该函数用来创建文本虚拟节点</strong>。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createTextVNode</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token function">String</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_13-createemptyvnode"><a href="#_13-createemptyvnode" class="header-anchor">#</a> 13.createEmptyVNode</h2> <p><code>createEmptyVNode</code> 即 <code>_v</code>。</p> <p><strong>该函数用来创建空虚拟节点，也可以称作注释节点</strong>。</p> <p>注释节点会在实际的 <code>DOM</code> 中渲染成 <code>HTML</code> 注释节点：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果设置了 text 参数，则会显示为：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- text内容 --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这种注释节点在 <code>Vue</code> 中有几个重要用途：</p> <ol><li>作为占位符：</li></ol> <ul><li>当使用 <code>v-if</code> 且条件为 <code>false</code> 时</li> <li>异步组件未加载完成时</li></ul> <ol start="2"><li>作为标记点：</li></ol> <ul><li>帮助 <code>Vue</code> 在 <code>DOM</code> 更新时定位特定位置</li> <li>在服务器端渲染 <code>SSR</code> 中标记动态内容的位置</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">const</span> createEmptyVNode <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  node<span class="token punctuation">.</span>text <span class="token operator">=</span> text
  node<span class="token punctuation">.</span>isComment <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">return</span> node
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_14-resolvescopedslots"><a href="#_14-resolvescopedslots" class="header-anchor">#</a> 14.resolveScopedSlots</h2> <p><code>resolveScopedSlots</code> 即 <code>_u</code>。</p> <p><strong>该函数用于解析 <code>scopedSlots</code></strong>。</p> <p>假设有如下 <code>template</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HelloWorld</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>default</span><span class="token punctuation">&gt;</span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name"><span class="token namespace">v-slot:</span>scope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slotScope<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    {{ slotScope }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HelloWorld</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>经过解析之后，转化为如下 <code>render</code> 函数：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;HelloWorld&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  scopedSlots<span class="token operator">:</span> <span class="token function">_u</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        key<span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        proxy<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        key<span class="token operator">:</span> <span class="token string">&quot;scope&quot;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">slotScope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;\\n      &quot;</span> <span class="token operator">+</span> <span class="token function">_s</span><span class="token punctuation">(</span>slotScope<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\n    &quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token number">4125560985</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>当经过 <code>_u</code> 即 <code>resolveScopedSlots</code> 处理之后：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">slotProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">class</span><span class="token operator">:</span> <span class="token string">'item'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>slotProps<span class="token punctuation">.</span>item<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token punctuation">{</span>
  scopedSlots<span class="token operator">:</span> <span class="token punctuation">{</span>
    $stable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    $key<span class="token operator">:</span> <span class="token number">4125560985</span><span class="token punctuation">,</span>
    <span class="token string">'default'</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">scope</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">slotScope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;\\n      &quot;</span> <span class="token operator">+</span> <span class="token function">_s</span><span class="token punctuation">(</span>slotScope<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\n    &quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">resolveScopedSlots</span><span class="token punctuation">(</span>
  fns<span class="token operator">:</span> ScopedSlotsData<span class="token punctuation">,</span>
  res<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  <span class="token comment">// the following are added in 2.6</span>
  hasDynamicKeys<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
  contentHashKey<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">{</span> $stable<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">Function</span> <span class="token punctuation">}</span> <span class="token punctuation">{</span>
  res <span class="token operator">=</span> res <span class="token operator">||</span> <span class="token punctuation">{</span> $stable<span class="token operator">:</span> <span class="token operator">!</span>hasDynamicKeys <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fns<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> slot <span class="token operator">=</span> fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>slot<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resolveScopedSlots</span><span class="token punctuation">(</span>slot<span class="token punctuation">,</span> res<span class="token punctuation">,</span> hasDynamicKeys<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>slot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// marker for reverse proxying v-slot without scope on this.$slots</span>
      <span class="token comment">// @ts-expect-error</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>slot<span class="token punctuation">.</span>proxy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// @ts-expect-error</span>
        slot<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>proxy <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">[</span>slot<span class="token punctuation">.</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> slot<span class="token punctuation">.</span>fn
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>contentHashKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">;</span><span class="token punctuation">(</span>res <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>$key <span class="token operator">=</span> contentHashKey
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res <span class="token keyword">as</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="_15-bindobjectlisteners"><a href="#_15-bindobjectlisteners" class="header-anchor">#</a> 15.bindObjectListeners</h2> <p><code>bindObjectListeners</code> 即 <code>_g</code>。</p> <p><strong>该函数用于绑定对象形式的事件监听器</strong>。譬如 <code>v-on=myEvents</code>。</p> <p>假设有如下 <code>template</code>：</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleMyClick<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>myEvents<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Click me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      myEvents<span class="token operator">:</span> <span class="token punctuation">{</span>
        click<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">,</span>
        mouseenter<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseEnter
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleMyClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'MyClick'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleMouseEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouse entered'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><code>template</code> 模板在编译时，会执行如下代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token operator">:</span> ASTElement<span class="token punctuation">,</span> dir<span class="token operator">:</span> ASTDirective</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// &quot;_g(_c('button', { class: 'btn' }), myEvents)&quot;</span>
  el<span class="token punctuation">.</span><span class="token function-variable function">wrapListeners</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">code<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_g(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dir<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>因此最终的实际 <code>render</code> 函数为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 简化版的渲染函数</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">_g</span><span class="token punctuation">(</span>
    <span class="token comment">// code: VNode 的基础数据</span>
    <span class="token punctuation">{</span>
      on<span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token string">&quot;click&quot;</span><span class="token operator">:</span>handleMyClick
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// dir.value: 就是 this.myEvents</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>myEvents
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>当执行 <code>bindObjectListeners</code> 之后，最终结果为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  tag<span class="token operator">:</span> <span class="token string">'button'</span><span class="token punctuation">,</span>
  on<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">click</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">mouseenter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">handleMouseEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouse entered'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ... 其他数据</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">bindObjectListeners</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token operator">:</span> VNodeData <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      __DEV__ <span class="token operator">&amp;&amp;</span> <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'v-on without argument expects an Object value'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> on <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>on <span class="token operator">=</span> data<span class="token punctuation">.</span>on <span class="token operator">?</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>on<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> existing <span class="token operator">=</span> on<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        <span class="token keyword">const</span> ours <span class="token operator">=</span> value<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
        on<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> existing <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>existing<span class="token punctuation">,</span> ours<span class="token punctuation">)</span> <span class="token operator">:</span> ours
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> data
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_16-binddynamickeys"><a href="#_16-binddynamickeys" class="header-anchor">#</a> 16.bindDynamicKeys</h2> <p><code>bindDynamicKeys</code> 即 <code>_d</code>。</p> <p><strong>该函数用来绑定动态键</strong>。</p> <p>假如有如下 <code>template</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:[key1]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>value1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:[key2]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>value2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@[event1]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleEvent1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@[event2]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleEvent2<span class="token punctuation">&quot;</span></span><span class="token attr-name">&quot;</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以上 <code>template</code> 转化为 <code>render</code> 函数如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">with</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token function">_b</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      attrs<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;app&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      on<span class="token operator">:</span> <span class="token function">_d</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>event1<span class="token punctuation">,</span> handleEvent1<span class="token punctuation">,</span> event2<span class="token punctuation">,</span> handleEvent2<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token function">_d</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>key1<span class="token punctuation">,</span> value1<span class="token punctuation">,</span> key2<span class="token punctuation">,</span> value2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">bindDynamicKeys</span><span class="token punctuation">(</span>
  <span class="token parameter">baseObj<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  values<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span></span>
<span class="token punctuation">)</span><span class="token operator">:</span> Object <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> key <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> key <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      baseObj<span class="token punctuation">[</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__ <span class="token operator">&amp;&amp;</span> key <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> key <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// null is a special value for explicitly removing a binding</span>
      <span class="token function">warn</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Invalid value for dynamic directive argument (expected string or null): </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token keyword">this</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> baseObj
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_17-prependmodifier"><a href="#_17-prependmodifier" class="header-anchor">#</a> 17.prependModifier</h2> <p><code>prependModifier</code> 即 <code>_p</code>。</p> <p><strong>该函数用来动态处理事件修饰符</strong>。</p> <p>假设有如下 <code>template</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@[eventName].once</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 转换后内部表示为 _p(eventName,&quot;~&quot;) --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// helper to dynamically append modifier runtime markers to event names.</span>
<span class="token comment">// ensure only append when value is already string, otherwise it will be cast</span>
<span class="token comment">// to string and cause the type check to miss.</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">prependModifier</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">symbol</span><span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">?</span> <span class="token builtin">symbol</span> <span class="token operator">+</span> value <span class="token operator">:</span> value
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/26/2024, 3:00:00 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.78f86ccf.js" defer></script><script src="/blog/assets/js/2.80e16ae8.js" defer></script><script src="/blog/assets/js/374.018fceba.js" defer></script>
  </body>
</html>
