import{_ as a,c as i,a1 as n,o as p}from"./chunks/framework.DAWq-o5U.js";const d=JSON.parse('{"title":"Publish Test","description":"","frontmatter":{"title":"Publish Test"},"headers":[],"relativePath":"engineer/pkg-manager/pnpm/4.publish.md","filePath":"engineer/pkg-manager/pnpm/4.publish.md"}'),t={name:"engineer/pkg-manager/pnpm/4.publish.md"};function e(l,s,h,r,o,k){return p(),i("div",null,s[0]||(s[0]=[n(`<p>有几种方法可以测试 <code>pnpm publish</code> 而不实际发布到 npm：</p><ol><li><strong>使用 <code>--dry-run</code> 选项</strong></li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> publish</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dry-run</span></span></code></pre></div><p>这会模拟发布过程，显示将要发布的内容，但不会真正发布。</p><ol start="2"><li><strong>使用私有的 npm registry（推荐）</strong></li></ol><p>使用 <a href="https://verdaccio.org/" target="_blank" rel="noreferrer">Verdaccio</a> 搭建本地 registry：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 verdaccio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verdaccio</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动本地 registry</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">verdaccio</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置 npm registry 为本地地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:4873/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建新用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> adduser</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --registry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:4873/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发布包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> publish</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --registry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:4873/</span></span></code></pre></div><ol start="3"><li><strong>使用 <code>private</code> 字段防止意外发布</strong></li></ol><div class="language-json:package.json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json:package.json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>{</span></span>
<span class="line"><span>  &quot;private&quot;: true,  // 添加这个字段会阻止包被发布</span></span>
<span class="line"><span>  &quot;name&quot;: &quot;@my-scope/my-package&quot;,</span></span>
<span class="line"><span>  &quot;version&quot;: &quot;1.0.0&quot;</span></span>
<span class="line"><span>}</span></span></code></pre></div><ol start="4"><li><strong>使用 <code>.npmrc</code> 配置发布目标</strong></li></ol><div class="language-ini:.npmrc vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini:.npmrc</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>registry=http://localhost:4873/</span></span>
<span class="line"><span>//localhost:4873/:_authToken=&quot;your-token&quot;</span></span></code></pre></div><p>测试完成后，记得：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 恢复到 npm 官方源</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://registry.npmjs.org/</span></span></code></pre></div><p>使用 Verdaccio 的好处是：</p><ul><li>可以完整测试发布流程</li><li>可以测试包的安装和依赖</li><li>不会污染 npm 官方源</li><li>可以测试私有包的发布流程</li></ul>`,15)]))}const g=a(t,[["render",e]]);export{d as __pageData,g as default};
