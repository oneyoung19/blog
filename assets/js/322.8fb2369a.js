(window.webpackJsonp=window.webpackJsonp||[]).push([[322],{782:function(s,t,a){"use strict";a.r(t);var n=a(40),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("这一节介绍如何创建 "),a("code",[s._v("Axios")]),s._v(" 实例，以及各种 "),a("code",[s._v("config")]),s._v(" 之间的优先级。")]),s._v(" "),a("h2",{attrs:{id:"_5-1-创建instance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-创建instance"}},[s._v("#")]),s._v(" 5-1.创建instance")]),s._v(" "),a("p",[s._v("在实际项目中，如果我们始终使用 "),a("code",[s._v("axios(config)")]),s._v(" 、 "),a("code",[s._v("axios.get(url[, config])")]),s._v(" 或 "),a("code",[s._v("axios.post(url[, data[, config]])")]),s._v(" 来发送请求，那么每次请求都需要单独配置 "),a("code",[s._v("config")]),s._v("，这看起来有点过于繁琐。")]),s._v(" "),a("p",[s._v("较为理想的请求方式是这样的，只关注以下三个方面：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("method")])]),s._v(" "),a("li",[a("code",[s._v("url")])]),s._v(" "),a("li",[a("code",[s._v("params")]),s._v(" 或 "),a("code",[s._v("data")]),s._v("（分别对应 "),a("code",[s._v("get")]),s._v(" "),a("code",[s._v("post")]),s._v(" 方式）")])]),s._v(" "),a("p",[s._v("那么此时，我们可以通过 "),a("code",[s._v("axios.create([config])")]),s._v(" 来创建一个实例。")]),s._v(" "),a("p",[s._v("此处的 "),a("code",[s._v("config")]),s._v("，我们可以称作 "),a("code",[s._v("instance config")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" instance "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  baseURL"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://some-domain.com/api/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  timeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'X-Custom-Header'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'foobar'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("strong",[s._v("创建 "),a("code",[s._v("instance")]),s._v(" 之后，它会继承 "),a("code",[s._v("axios")]),s._v(" 的所有属性和方法")]),s._v("。")]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("instance")]),s._v(" 创建的请求，都会有一份基础 "),a("code",[s._v("instance config")]),s._v("。")]),s._v(" "),a("p",[s._v("那么我们在项目中，可以这样使用：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("getSomeThing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://some-domain.com/api/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("config\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("postSomeThing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://some-domain.com/api/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("为了不拘泥于 "),a("code",[s._v("instance config")]),s._v("，我们在封装方法的时候，可以把 "),a("code",[s._v("config")]),s._v(" 暴露出来，以供二次覆盖。")]),s._v(" "),a("p",[s._v("这里的 "),a("code",[s._v("config")]),s._v("，可以称作 "),a("code",[s._v("request config")]),s._v("，也就是"),a("strong",[s._v("实际请求配置")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"_5-2-config优先级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-config优先级"}},[s._v("#")]),s._v(" 5-2.config优先级")]),s._v(" "),a("p",[s._v("截止到本节，我们统共接触到了三种形式的 "),a("code",[s._v("config")]),s._v("。")]),s._v(" "),a("p",[s._v("它们分别是（"),a("strong",[s._v("优先级从低到高")]),s._v("）：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("defaults config")]),s._v(" 默认配置")]),s._v(" "),a("li",[a("code",[s._v("instance config")]),s._v(" 实例配置")]),s._v(" "),a("li",[a("code",[s._v("request config")]),s._v(" 实际请求配置")])]),s._v(" "),a("p",[s._v("当 "),a("code",[s._v("axios")]),s._v(" 请求触发时，这三者配置会有一个 "),a("code",[s._v("merge")]),s._v(" 合并覆盖的过程。")]),s._v(" "),a("p",[a("strong",[s._v("高优先级配置会覆盖低优先级配置")]),s._v("。")])])}),[],!1,null,null,null);t.default=e.exports}}]);