(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{489:function(t,s,v){"use strict";v.r(s);var e=v(40),a=Object(e.a)({},(function(){var t=this,s=t.$createElement,v=t._self._c||s;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h2",{attrs:{id:"配置文件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),v("p",[t._v("在 "),v("code",[t._v("macos")]),t._v(" 上安装 "),v("code",[t._v("MongoDB")]),t._v(" 后，会在 "),v("code",[t._v("/usr/local/etc/mongod.conf")]),t._v(" 中生成配置文件。")]),t._v(" "),v("div",{staticClass:"language-bash line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[v("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mongod.conf")]),t._v("\nsystemLog:\n  destination: "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v("\n  path: /usr/local/var/log/mongodb/mongo.log\n  logAppend: "),v("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\nstorage:\n  dbPath: /usr/local/var/mongodb\nnet:\n  bindIp: "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1\n  port: "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v("\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br"),v("span",{staticClass:"line-number"},[t._v("2")]),v("br"),v("span",{staticClass:"line-number"},[t._v("3")]),v("br"),v("span",{staticClass:"line-number"},[t._v("4")]),v("br"),v("span",{staticClass:"line-number"},[t._v("5")]),v("br"),v("span",{staticClass:"line-number"},[t._v("6")]),v("br"),v("span",{staticClass:"line-number"},[t._v("7")]),v("br"),v("span",{staticClass:"line-number"},[t._v("8")]),v("br"),v("span",{staticClass:"line-number"},[t._v("9")]),v("br"),v("span",{staticClass:"line-number"},[t._v("10")]),v("br")])]),v("p",[t._v("从该文件中可以看出，"),v("code",[t._v("MongoDB")]),t._v(" 的配置文件主要包含三个部分：")]),t._v(" "),v("ul",[v("li",[v("code",[t._v("systemLog")]),t._v("：日志配置")]),t._v(" "),v("li",[v("code",[t._v("storage")]),t._v("：存储配置")]),t._v(" "),v("li",[v("code",[t._v("net")]),t._v("：网络配置")])]),t._v(" "),v("h2",{attrs:{id:"启动服务"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[t._v("#")]),t._v(" 启动服务")]),t._v(" "),v("p",[t._v("在 "),v("code",[t._v("macos")]),t._v(" 上启动 "),v("code",[t._v("MongoDB")]),t._v(" 服务的命令如下：")]),t._v(" "),v("div",{staticClass:"language-bash line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[t._v("mongod --config /usr/local/etc/mongod.conf\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("该命令启动之后，按 "),v("code",[t._v("ctrl + c")]),t._v(" 可以停止服务。")]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),v("p",[t._v("该命令，同 "),v("code",[t._v("redis-server")]),t._v(" 命令类似，启动的并不是守护进程。")]),t._v(" "),v("p",[t._v("笔者在使用 "),v("code",[t._v("brew services start mongodb-community")]),t._v(" 启动守护进程时，发现失败了。更加合适的方式，留待日后考究。")]),t._v(" "),v("p",[t._v("此处作以记录。")])]),t._v(" "),v("p",[t._v("此处，再列举一下 "),v("code",[t._v("mongod")]),t._v(" 的常用启动参数（"),v("strong",[t._v("更多参数，可通过 "),v("code",[t._v("mongod --help")]),t._v(" 查看")]),t._v("）：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("--config")])]),t._v(" "),v("td",[t._v("指明配置文件，譬如 "),v("code",[t._v("/usr/local/etc/mongod.conf")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--bind_ip")])]),t._v(" "),v("td",[v("code",[t._v("IP")]),t._v(" 地址，若绑定 "),v("code",[t._v("127.0.0.1")]),t._v("，则只能本机访问，不指定默认本地所有 "),v("code",[t._v("IP")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--port")])]),t._v(" "),v("td",[t._v("端口，默认为 "),v("code",[t._v("27017")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--dbpath")])]),t._v(" "),v("td",[t._v("指定数据库路径。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--logpath")])]),t._v(" "),v("td",[t._v("指定日志文件，注意是指定文件不是目录。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--logappend")])]),t._v(" "),v("td",[t._v("使用追加的方式写日志。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--serviceName")])]),t._v(" "),v("td",[t._v("指定服务名称。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--serviceDisplayName")])]),t._v(" "),v("td",[t._v("指定服务名称，有多个 "),v("code",[t._v("mongodb")]),t._v(" 服务时执行。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--install")])]),t._v(" "),v("td",[t._v("指定作为一个 "),v("code",[t._v("Windows")]),t._v(" 服务安装。")])])])]),t._v(" "),v("h2",{attrs:{id:"连接数据库"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#连接数据库"}},[t._v("#")]),t._v(" 连接数据库")]),t._v(" "),v("p",[t._v("在 "),v("code",[t._v("macos")]),t._v(" 上连接 "),v("code",[t._v("MongoDB")]),t._v(" 数据库的命令如下：")]),t._v(" "),v("div",{staticClass:"language-bash line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[t._v("mongo "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("db address"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("file names "),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ending "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" .js"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[v("img",{attrs:{src:"https://raw.githubusercontent.com/oneyoung19/vuepress-blog-img/Not-Count-Contribution/img/20230408185904.png",alt:""}})]),t._v(" "),v("p",[t._v("其中，"),v("code",[t._v("[options]")]),t._v(" 为可选参数，"),v("code",[t._v("[db address]")]),t._v(" 为数据库地址，"),v("code",[t._v("[file names (ending in .js)]")]),t._v(" 为 "),v("code",[t._v("js")]),t._v(" 文件。")]),t._v(" "),v("p",[v("code",[t._v("[options]")]),t._v(" 参数如下：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("-h")])]),t._v(" "),v("td",[t._v("指定 "),v("code",[t._v("host")]),t._v("，默认为 "),v("code",[t._v("localhost")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("-p")])]),t._v(" "),v("td",[t._v("指定端口，譬如 "),v("code",[t._v("27017")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("-u")])]),t._v(" "),v("td",[t._v("指定用户名。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("-p")])]),t._v(" "),v("td",[t._v("指定密码。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("-d")])]),t._v(" "),v("td",[t._v("指定数据库。")])])])]),t._v(" "),v("p",[v("code",[t._v("[db address]")]),t._v(" 参数如下：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("--host")])]),t._v(" "),v("td",[t._v("指定 "),v("code",[t._v("host")]),t._v("，默认为 "),v("code",[t._v("localhost")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--port")])]),t._v(" "),v("td",[t._v("指定端口，譬如 "),v("code",[t._v("27017")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--username")])]),t._v(" "),v("td",[t._v("指定用户名。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--password")])]),t._v(" "),v("td",[t._v("指定密码。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--authenticationDatabase")])]),t._v(" "),v("td",[t._v("指定数据库。")])])])]),t._v(" "),v("p",[v("code",[t._v("[file names (ending in .js)]")]),t._v(" 参数如下：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("参数")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("--eval")])]),t._v(" "),v("td",[t._v("执行 "),v("code",[t._v("js")]),t._v(" 代码。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("--shell")])]),t._v(" "),v("td",[t._v("进入 "),v("code",[t._v("shell")]),t._v(" 模式。")])])])]),t._v(" "),v("h2",{attrs:{id:"设置用户和密码"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#设置用户和密码"}},[t._v("#")]),t._v(" 设置用户和密码")]),t._v(" "),v("p",[t._v("在终端中运行 "),v("code",[t._v("mongo")]),t._v(" 命令，进入 "),v("code",[t._v("MongoDB")]),t._v(" 的 "),v("code",[t._v("shell")]),t._v(" 模式。")]),t._v(" "),v("div",{staticClass:"language-bash line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[t._v("mongo\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("运行如下命令，使用内置的 "),v("code",[t._v("admin")]),t._v(" 数据库：")]),t._v(" "),v("div",{staticClass:"language-bash line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[t._v("use admin\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("创建一个管理员用户，运行如下命令：")]),t._v(" "),v("div",{staticClass:"language-js line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-js"}},[v("code",[t._v("db"),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("createUser")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("user"),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pwd"),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v('"password"')]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" roles"),v("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),v("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),v("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("使用这个管理员用户账号登录，运行如下命令：")]),t._v(" "),v("div",{staticClass:"language-bash line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-bash"}},[v("code",[t._v("mongo -u admin -p password --authenticationDatabase admin\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("h2",{attrs:{id:"全局变量"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#全局变量"}},[t._v("#")]),t._v(" 全局变量")]),t._v(" "),v("p",[t._v("在 "),v("code",[t._v("MongoDB")]),t._v(" 的 "),v("code",[t._v("shell")]),t._v(" 模式中，有一些全局变量，可以使用。")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("变量名")]),t._v(" "),v("th",[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[v("code",[t._v("db")])]),t._v(" "),v("td",[t._v("当前数据库。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("rs")])]),t._v(" "),v("td",[t._v("副本集。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("sh")])]),t._v(" "),v("td",[t._v("分片。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("db.getMongo()")])]),t._v(" "),v("td",[t._v("当前 "),v("code",[t._v("MongoDB")]),t._v(" 实例。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("db.getMongo().setSlaveOk()")])]),t._v(" "),v("td",[t._v("设置 "),v("code",[t._v("MongoDB")]),t._v(" 实例为 "),v("code",[t._v("slave")]),t._v("。")])]),t._v(" "),v("tr",[v("td",[v("code",[t._v("db.getMongo().setReadPref()")])]),t._v(" "),v("td",[t._v("设置 "),v("code",[t._v("MongoDB")]),t._v(" 实例的 "),v("code",[t._v("read")]),t._v(" 偏好。")])])])])])}),[],!1,null,null,null);s.default=a.exports}}]);