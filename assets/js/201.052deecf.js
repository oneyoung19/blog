(window.webpackJsonp=window.webpackJsonp||[]).push([[201],{661:function(e,s,t){"use strict";t.r(s);var n=t(40),a=Object(n.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("code",[e._v("Websocket")]),e._v(" 依赖于 "),t("code",[e._v("ws")]),e._v(" 协议，而非 "),t("code",[e._v("http")]),e._v(" 协议。")]),e._v(" "),t("p",[e._v("在建立连接时，首先由客户端发起请求，大概有如下请求头：")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("GET /api/websocket\nHost: localhost\nOrigin: http://localhost:8080\nConnection: Upgrade\nUpgrade: websocket\nSec-Websocket-Extensions: permessage-deflate\nSec-WebSocket-Key: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("CPcdLMSy3wmUpYZmq0OUZA")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("==")]),e._v("\nSec-WebSocket-Version: "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("13")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])]),t("p",[e._v("其中部分 "),t("code",[e._v("header")]),e._v(" 头的含义如下：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("Connection: Upgrade")]),e._v(" —— 表示客户端想要更改协议。")]),e._v(" "),t("li",[t("code",[e._v("Upgrade: websocket")]),e._v(" —— 请求的协议是 "),t("code",[e._v("websocket")]),e._v("。")]),e._v(" "),t("li",[t("code",[e._v("Sec-Websocket-Extensions")]),e._v(" —— "),t("code",[e._v("Websocket")]),e._v(" 拓展，支持数据压缩。")]),e._v(" "),t("li",[t("code",[e._v("Sec-Websocket-Key")]),e._v(" —— 浏览器随机生成的安全密钥。")]),e._v(" "),t("li",[t("code",[e._v("Sec-Websocket-Version")]),e._v(" —— "),t("code",[e._v("Websocket")]),e._v(" 协议版本，当前为 "),t("code",[e._v("13")]),e._v("。")])]),e._v(" "),t("p",[e._v("如果服务器同意切换为 "),t("code",[e._v("Websocket")]),e._v(" 协议，服务器应该返回响应码 "),t("code",[e._v("101")]),e._v("：")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[e._v("101")]),e._v(" Switching Protocols\nUpgrade: websocket\nConnection: Upgrade\nSec-Websocket-Accept: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("6KI8x4yb7zRbvjrYKttNMq8yiAg")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[e._v("参考文档：")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://zh.javascript.info/websocket",target:"_blank",rel:"noopener noreferrer"}},[e._v("现代教程之Websocket"),t("OutboundLink")],1)])]),e._v(" "),t("p",[e._v("第三方库及框架：")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/websockets/ws",target:"_blank",rel:"noopener noreferrer"}},[e._v("ws"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/socketio/socket.io",target:"_blank",rel:"noopener noreferrer"}},[e._v("socket.io"),t("OutboundLink")],1)])]),e._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[t("code",[e._v("ws")]),e._v(" 其实相当于 "),t("code",[e._v("Websocket")]),e._v(" 在 "),t("code",[e._v("node")]),e._v(" 环境下的 "),t("code",[e._v("polyfill")]),e._v(" 库。")]),e._v(" "),t("p",[e._v("而 "),t("code",[e._v("socket.io")]),e._v(" 则能够支持 "),t("code",[e._v("client")]),e._v(" 和 "),t("code",[e._v("server")]),e._v(" 端，而且对于其他语言如 "),t("code",[e._v("java")]),e._v("、"),t("code",[e._v("python")]),e._v(" 等，也有对应版本。")]),e._v(" "),t("p",[e._v("整体而言，"),t("code",[e._v("socket.io")]),e._v(" 的功能更完整，周边生态更好。")])])])}),[],!1,null,null,null);s.default=a.exports}}]);