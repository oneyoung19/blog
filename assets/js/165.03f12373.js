(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{623:function(s,a,e){"use strict";e.r(a);var t=e(40),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("在前几章中，我们已经知道了镜像和容器的创建。")]),s._v(" "),e("p",[s._v("在现实开发中，一个前后端分离的 "),e("code",[s._v("Web")]),s._v(" 项目会依赖 "),e("code",[s._v("Node")]),s._v(" 构建，以及 "),e("code",[s._v("Nginx")]),s._v(" 托管等。")]),s._v(" "),e("p",[s._v("因此实际上会需要创建 "),e("code",[s._v("Node")]),s._v(" 容器以及 "),e("code",[s._v("Nginx")]),s._v(" 容器。并且两个容器之间需要通信。")]),s._v(" "),e("p",[s._v("那么一方面可以使用"),e("strong",[s._v("多阶段构建")]),s._v("的方式来实现，另一方面，则可以使用 "),e("code",[s._v("Docker Compose")]),s._v(" 来实现。")]),s._v(" "),e("p",[e("code",[s._v("Compose")]),s._v(" 中有两个重要的概念：")]),s._v(" "),e("ul",[e("li",[s._v("服务（"),e("code",[s._v("service")]),s._v("）：一个应用的容器，实际上可以包含若干运行相同镜像的容器实例。")]),s._v(" "),e("li",[s._v("项目（"),e("code",[s._v("project")]),s._v("）：由一组关联的应用容器组成的一个完整业务单元，在 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中定义。")])]),s._v(" "),e("p",[s._v("因此，一个项目会由多个服务组成，"),e("code",[s._v("Compose")]),s._v(" 面向项目管理。")]),s._v(" "),e("h2",{attrs:{id:"安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),e("p",[s._v("如果在前文中，下载的是 "),e("code",[s._v("Docker")]),s._v(" 桌面版，而非脚本。")]),s._v(" "),e("p",[s._v("那么 "),e("code",[s._v("Docker Compose")]),s._v(" 也会自动安装好。")]),s._v(" "),e("p",[s._v("可以通过 "),e("code",[s._v("docker-compose --version")]),s._v(" 来查看是否已经安装 "),e("code",[s._v("Docker Compose")]),s._v("。")]),s._v(" "),e("p",[s._v("如果没有安装的话，那么可以参考"),e("a",{attrs:{href:"https://yeasy.gitbook.io/docker_practice/compose/install",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Compose的安装与卸载"),e("OutboundLink")],1),s._v("。")]),s._v(" "),e("h2",{attrs:{id:"compose模板文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compose模板文件"}},[s._v("#")]),s._v(" Compose模板文件")]),s._v(" "),e("p",[e("code",[s._v("Compose")]),s._v(" 使用 "),e("code",[s._v("YAML")]),s._v(" 文件来定义应用程序的服务。")]),s._v(" "),e("p",[s._v("默认的文件名称为 "),e("code",[s._v("docker-compose.yml")]),s._v("。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5000:5000"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/code\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" logvolume01"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/log\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("links")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logvolume01")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("注意每个服务都必须通过 "),e("code",[s._v("image")]),s._v(" 指令指定镜像或 "),e("code",[s._v("build")]),s._v(" 指令（需要 "),e("code",[s._v("Dockerfile")]),s._v("）等来自动构建生成镜像。")]),s._v(" "),e("p",[s._v("如果使用 "),e("code",[s._v("build")]),s._v(" 指令，在 "),e("code",[s._v("Dockerfile")]),s._v(" 中设置的选项(例如："),e("code",[s._v("CMD")]),s._v(", "),e("code",[s._v("EXPOSE")]),s._v(", "),e("code",[s._v("VOLUME")]),s._v(", "),e("code",[s._v("ENV")]),s._v(" 等) 将会自动被获取，无需在 "),e("code",[s._v("docker-compose.yml")]),s._v(" 中重复设置。")]),s._v(" "),e("p",[s._v("下面简要介绍 "),e("code",[s._v("docker-compose.yml")]),s._v(" 中的常用指令的用法。")]),s._v(" "),e("h3",{attrs:{id:"build"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[s._v("#")]),s._v(" build")]),s._v(" "),e("p",[s._v("指定 "),e("code",[s._v("Dockerfile")]),s._v(" 所在文件夹的路径（可以是绝对路径，或者相对 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件的路径）。")]),s._v(" "),e("p",[e("code",[s._v("Compose")]),s._v(" 将会利用它自动构建这个镜像，然后使用这个镜像。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webapp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./dir\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("也可以使用 "),e("code",[s._v("context")]),s._v(" 指定 "),e("code",[s._v("Dockerfile")]),s._v(" 所在目录，并使用 "),e("code",[s._v("dockerfile")]),s._v(" 指令指明 "),e("code",[s._v("Dockerfile")]),s._v("。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webapp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./dir\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alternate\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("如果除了 "),e("code",[s._v("build")]),s._v(" 指令外，还指定了 "),e("code",[s._v("image")]),s._v("，那么 "),e("code",[s._v("build")]),s._v(" 指令将会被忽略。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webapp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./dir\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" webapp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("tag\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"image"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#image"}},[s._v("#")]),s._v(" image")]),s._v(" "),e("p",[s._v("指定为镜像名称或镜像 "),e("code",[s._v("ID")]),s._v("。")]),s._v(" "),e("p",[s._v("如果镜像在本地不存在，"),e("code",[s._v("Compose")]),s._v(" 将会尝试拉取这个镜像。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webapp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"command"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[s._v("#")]),s._v(" command")]),s._v(" "),e("p",[s._v("覆盖容器启动后默认执行的命令。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("alpine\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-g'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'daemon off;'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"container-name"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#container-name"}},[s._v("#")]),s._v(" container_name")]),s._v(" "),e("p",[s._v("指定容器名。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"depends-on"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#depends-on"}},[s._v("#")]),s._v(" depends_on")]),s._v(" "),e("p",[s._v("指定服务依赖。")]),s._v(" "),e("p",[s._v("下面的例子，会先启动 "),e("code",[s._v("db")]),s._v(" 和 "),e("code",[s._v("redis")]),s._v("，再启动 "),e("code",[s._v("web")]),s._v("。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" db\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("注意："),e("code",[s._v("web")]),s._v(" 服务"),e("strong",[s._v("不会等待 "),e("code",[s._v("db")]),s._v(" 和 "),e("code",[s._v("redis")]),s._v(" 完全启动之后才启动")]),s._v("。")])]),s._v(" "),e("h3",{attrs:{id:"dns"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[s._v("#")]),s._v(" dns")]),s._v(" "),e("p",[s._v("指定容器使用的 "),e("code",[s._v("DNS")]),s._v(" "),e("strong",[s._v("解析")]),s._v("服务器。")]),s._v(" "),e("p",[s._v("它可以设置为一个值，也可以设置为一个列表。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dns")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 8.8.8.8\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dns")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8.8.8.8\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 114.114.114.114\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[e("code",[s._v("8.8.8.8")]),s._v(" 是 "),e("code",[s._v("Google")]),s._v(" 提供的免费 "),e("code",[s._v("DNS")]),s._v(" 服务器；")]),s._v(" "),e("p",[e("code",[s._v("114.114.114.114")]),s._v(" 是 "),e("code",[s._v("114DNS")]),s._v(" 提供的免费 "),e("code",[s._v("DNS")]),s._v(" 服务器。")])]),s._v(" "),e("h3",{attrs:{id:"dns-search"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dns-search"}},[s._v("#")]),s._v(" dns_search")]),s._v(" "),e("p",[s._v("指定容器使用的 "),e("code",[s._v("DNS")]),s._v(" "),e("strong",[s._v("搜索")]),s._v("域名。")]),s._v(" "),e("p",[s._v("它可以设置为一个值，也可以设置为一个列表。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dns_search")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" example.com\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dns_search")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" dc1.example.com\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" dc2.example.com\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"environment"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#environment"}},[s._v("#")]),s._v(" environment")]),s._v(" "),e("p",[s._v("设置环境变量。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" DEBUG=1\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" foo=bar\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" RACK_ENV=development\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" SHOW=true\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" SESSION_SECRET\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"env-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#env-file"}},[s._v("#")]),s._v(" env_file")]),s._v(" "),e("p",[s._v("从文件中读取环境变量。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("env_file")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" web"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("variables.env\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" other"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("variables.env\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("环境变量文件中每一行必须符合格式，支持 "),e("code",[s._v("#")]),s._v(" 开头的注释行。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# common.env: Set development environment")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PROG_ENV")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("development\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("h3",{attrs:{id:"expose"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#expose"}},[s._v("#")]),s._v(" expose")]),s._v(" "),e("p",[s._v("暴露端口，但是"),e("strong",[s._v("不映射到宿主机")]),s._v("。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3000"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("expose")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3000"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"ports"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ports"}},[s._v("#")]),s._v(" ports")]),s._v(" "),e("p",[s._v("暴露端口，并映射到宿主机。")]),s._v(" "),e("p",[s._v("基础形式为 "),e("code",[s._v("HOST:CONTAINER")]),s._v("，或者只指定 "),e("code",[s._v("CONTAINER")]),s._v("，此时会随机映射到宿主机的端口。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3000:3000"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("在 "),e("code",[s._v("Docker Compose")]),s._v(" 中，"),e("code",[s._v("ports")]),s._v(" 和 "),e("code",[s._v("expose")]),s._v(" 都用于将容器内的端口映射到主机上，但它们有一些不同之处。")]),s._v(" "),e("ul",[e("li",[e("p",[e("code",[s._v("ports")]),s._v(": 用于将容器的端口映射到主机上的端口，以便从外部网络访问容器。它可以使用以下格式指定：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HOST_PORT:CONTAINER_PORT"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[e("code",[s._v("expose")]),s._v(": 它也将容器内的端口公开到主机上，但是仅仅是在容器间相互连接时才有用。它并不会将容器的端口绑定到主机上，因此外部网络无法直接访问容器。可以使用以下格式指定：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("expose")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CONTAINER_PORT"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])]),s._v(" "),e("p",[s._v("因此，如果你需要从外部网络访问容器，则应该使用 "),e("code",[s._v("ports")]),s._v("，而如果你只需要容器之间进行连接，则可以使用 "),e("code",[s._v("expose")]),s._v("。")])]),s._v(" "),e("h3",{attrs:{id:"extra-hosts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#extra-hosts"}},[s._v("#")]),s._v(" extra_hosts")]),s._v(" "),e("p",[s._v("类似 "),e("code",[s._v("Docker")]),s._v(" 中的 "),e("code",[s._v("--add-host")]),s._v(" 参数，指定额外的 "),e("code",[s._v("host")]),s._v(" 名称映射信息。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("extra_hosts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"googledns:8.8.8.8"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dockerhub:52.1.157.61"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("会在启动后的服务容器中 "),e("code",[s._v("/etc/hosts")]),s._v(" 文件中添加如下两条条目：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.8")]),s._v(".8.8 googledns\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.1")]),s._v(".157.61 dockerhub\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"labels"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#labels"}},[s._v("#")]),s._v(" labels")]),s._v(" "),e("p",[s._v("为容器添加 "),e("code",[s._v("Docker")]),s._v(" 元数据（"),e("code",[s._v("metadata")]),s._v("）信息。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("com.example.description")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Accounting web app"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("com.example.department")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Finance"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("com.example.label-with-empty-value")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"networks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#networks"}},[s._v("#")]),s._v(" networks")]),s._v(" "),e("p",[s._v("定义 "),e("code",[s._v("Docker")]),s._v(" 容器之间的网络连接。")]),s._v(" "),e("p",[s._v("这个特性让 "),e("code",[s._v("Docker")]),s._v(" 容器可以方便地进行通信和交互，而无需暴露不必要的端口或将它们暴露在公共网络中。")]),s._v(" "),e("p",[s._v("要使用 "),e("code",[s._v("Docker Compose")]),s._v(" 中的 "),e("code",[s._v("networks")]),s._v("，可以在 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中定义一个 "),e("code",[s._v("networks")]),s._v(" 部分。")]),s._v(" "),e("p",[s._v("该部分应该包含一个或多个网络的名称和配置，如下所示：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5000:5000"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" front"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tier\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" back"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tier\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("front-tier")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bridge\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("back-tier")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bridge\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("在上面的示例中，我们定义了两个网络："),e("code",[s._v("front-tier")]),s._v(" 和 "),e("code",[s._v("back-tier")]),s._v("。")]),s._v(" "),e("p",[s._v("我们还将 "),e("code",[s._v("web")]),s._v(" 服务添加到这些网络中。这意味着 "),e("code",[s._v("web")]),s._v(" 容器可以通过这些网络与其他容器进行通信。")]),s._v(" "),e("p",[s._v("对于每个网络，我们还可以定义特定的驱动程序（即网络类型）。")]),s._v(" "),e("p",[s._v("在这里，我们使用了默认的 "),e("code",[s._v("bridge")]),s._v(" 驱动程序。其他可用的驱动程序包括 "),e("code",[s._v("overlay")]),s._v("、"),e("code",[s._v("macvlan")]),s._v(" 和 "),e("code",[s._v("ipvlan")]),s._v(" 等。")]),s._v(" "),e("p",[s._v("在使用 "),e("code",[s._v("Docker Compose")]),s._v(" 的过程中，如果我们不定义 "),e("code",[s._v("networks")]),s._v("，则默认情况下，将创建一个默认的 "),e("code",[s._v("bridge")]),s._v(" 网络来连接所有服务。")]),s._v(" "),e("p",[s._v("总之，"),e("code",[s._v("Docker Compose")]),s._v(" 中的 "),e("code",[s._v("networks")]),s._v(" 提供了一种方便的方法来管理 "),e("code",[s._v("Docker")]),s._v(" 容器之间的网络连接，可以实现安全、高效和可伸缩的容器化应用程序。")]),s._v(" "),e("h3",{attrs:{id:"network-mode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#network-mode"}},[s._v("#")]),s._v(" network_mode")]),s._v(" "),e("p",[s._v("指定 "),e("code",[s._v("Docker")]),s._v(" 容器的网络模式，从而控制容器如何与主机和其他容器进行通信。")]),s._v(" "),e("p",[s._v("有多种网络模式可供选择，如 "),e("code",[s._v("bridge")]),s._v("、"),e("code",[s._v("host")]),s._v("、"),e("code",[s._v("none")]),s._v(" 等。")]),s._v(" "),e("p",[s._v("默认情况下，"),e("code",[s._v("Docker Compose")]),s._v(" 使用 "),e("code",[s._v("bridge")]),s._v(" 网络模式，这意味着 "),e("code",[s._v("Docker Compose")]),s._v(" 会创建一个本地的虚拟网络，并将容器连接到该网络中。")]),s._v(" "),e("p",[s._v("这种模式可以让容器之间相互通信，而不需要暴露所有端口。")]),s._v(" "),e("p",[s._v("以下是一个使用 "),e("code",[s._v("network_mode")]),s._v(" 来指定网络模式的示例：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5000:5000"')]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("network_mode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[e("code",[s._v("Docker")]),s._v("中有几种可用的网络模式，每种模式都有其特定的使用场景和含义。以下是最常见的四种网络模式：")]),s._v(" "),e("ol",[e("li",[e("p",[e("code",[s._v("Bridge")]),s._v(" 模式是 "),e("code",[s._v("Docker")]),s._v(" 默认使用的网络模式。在此模式下，"),e("code",[s._v("Docker")]),s._v(" 会在主机上创建一个虚拟网络，然后在该网络中创建一个桥接接口，并将每个容器连接到该网络中。这意味着每个容器都可以通过网络与其他容器通信，同时也可以在主机上通过映射端口与外部网络进行通信。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("Host")]),s._v(" 模式下，容器使用主机的网络接口，而不是为容器创建虚拟网络接口。这意味着容器可以与主机共享相同的 "),e("code",[s._v("IP")]),s._v(" 地址和端口。使用 "),e("code",[s._v("Host")]),s._v(" 模式的主要优点是可以提高容器的性能，因为容器无需通过 "),e("code",[s._v("NAT")]),s._v(" 转换网络数据包。但是，这也意味着容器与主机的网络相互依存，可能会增加安全风险。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("None")]),s._v(" 模式下，"),e("code",[s._v("Docker")]),s._v(" 不为容器配置任何网络接口。这意味着容器没有网络连接，不能与其他容器或外部网络进行通信。通常情况下，您可能不会选择此模式，除非您要为容器配置自定义网络。")])]),s._v(" "),e("li",[e("p",[e("code",[s._v("Overlay")]),s._v(" 模式是用于创建跨多个 "),e("code",[s._v("Docker")]),s._v(" 主机的容器网络的一种高级网络模式。在此模式下，"),e("code",[s._v("Docker")]),s._v(" 在每个主机上创建一个虚拟网络，并将该网络连接到一个或多个其他主机的虚拟网络中。这样，容器可以在不同的主机上进行通信，而不必考虑主机的物理网络架构。")])])]),s._v(" "),e("p",[s._v("除了这些网络模式之外，还有一些其他的网络模式可供选择，例如 "),e("code",[s._v("Macvlan")]),s._v(" 模式、"),e("code",[s._v("IPvlan")]),s._v(" 模式等。")]),s._v(" "),e("p",[s._v("不同的网络模式适用于不同的场景和用途。")])]),s._v(" "),e("h3",{attrs:{id:"volumes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#volumes"}},[s._v("#")]),s._v(" volumes")]),s._v(" "),e("p",[s._v("指定容器和宿主机之间的数据卷映射。")]),s._v(" "),e("p",[s._v("数据卷是 "),e("code",[s._v("Docker")]),s._v(" 中一个重要的概念，用于在容器之间共享数据，并且在容器重启或者删除后数据仍然可以保留。")]),s._v(" "),e("p",[s._v("在 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中，可以使用 "),e("code",[s._v("<host>:<container>")]),s._v(" 格式的"),e("strong",[s._v("目录映射")]),s._v("来定义 "),e("code",[s._v("volumes")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("myservice")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" myimage\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /path/on/host"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/path/in/container\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("上述代码将宿主机上的 "),e("code",[s._v("/path/on/host")]),s._v(" 目录映射到容器中的 "),e("code",[s._v("/path/in/container")]),s._v(" 目录。")]),s._v(" "),e("p",[s._v("这样，在容器中访问 "),e("code",[s._v("/path/in/container")]),s._v(" 目录时，实际上是访问宿主机上的 "),e("code",[s._v("/path/on/host")]),s._v(" 目录。")]),s._v(" "),e("p",[s._v("还可以将数据卷作为一个"),e("strong",[s._v("命名卷")]),s._v("使用，例如：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("myservice")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" myimage\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mynamedvolume"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/path/in/container\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mynamedvolume")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("上述代码中，使用了一个名为 "),e("code",[s._v("mynamedvolume")]),s._v(" 的命名卷，它将被映射到 "),e("code",[s._v("myservice")]),s._v(" 容器中的 "),e("code",[s._v("/path/in/container")]),s._v(" 目录。")]),s._v(" "),e("p",[s._v("还可以使用 "),e("code",[s._v("external")]),s._v(" 选项引用已经创建的数据卷，例如：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("myservice")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" myimage\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" myexternalvolume"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/path/in/container\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("myexternalvolume")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("external")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("上述代码中，使用了一个名为 "),e("code",[s._v("myexternalvolume")]),s._v(" 的外部数据卷，它将被映射到 "),e("code",[s._v("myservice")]),s._v(" 容器中的 "),e("code",[s._v("/path/in/container")]),s._v(" 目录。")]),s._v(" "),e("h2",{attrs:{id:"compose命令行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compose命令行"}},[s._v("#")]),s._v(" Compose命令行")]),s._v(" "),e("p",[e("code",[s._v("docker-compose")]),s._v(" 与 "),e("code",[s._v("docker")]),s._v(" 的命令行操作有许多类似之处。")]),s._v(" "),e("p",[s._v("此处简要列举一些常用的 "),e("code",[s._v("docker-compose")]),s._v(" 命令。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-up"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-up"}},[s._v("#")]),s._v(" docker-compose up")]),s._v(" "),e("p",[e("code",[s._v("docker-compose up")]),s._v(" 命令用于构建并启动 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务。")]),s._v(" "),e("p",[s._v("如果 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义了多个服务，那么 "),e("code",[s._v("docker-compose up")]),s._v(" 命令将按照 "),e("code",[s._v("depends_on")]),s._v(" 的顺序依次启动这些服务。")]),s._v(" "),e("p",[s._v("例如，以下 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中定义了两个服务 "),e("code",[s._v("web")]),s._v(" 和 "),e("code",[s._v("db")]),s._v("，并且 "),e("code",[s._v("web")]),s._v(" 服务依赖于 "),e("code",[s._v("db")]),s._v(" 服务：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" db\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("在这种情况下，"),e("code",[s._v("docker-compose up")]),s._v(" 命令将首先启动 "),e("code",[s._v("db")]),s._v(" 服务，然后再启动 "),e("code",[s._v("web")]),s._v(" 服务。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-down"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-down"}},[s._v("#")]),s._v(" docker-compose down")]),s._v(" "),e("p",[e("code",[s._v("docker-compose down")]),s._v(" 命令用于停止并删除 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务。")]),s._v(" "),e("p",[s._v("如果 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义了多个服务，那么 "),e("code",[s._v("docker-compose down")]),s._v(" 命令将按照 "),e("code",[s._v("depends_on")]),s._v(" 的相反顺序依次停止这些服务。")]),s._v(" "),e("p",[s._v("例如，以下 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中定义了两个服务 "),e("code",[s._v("web")]),s._v(" 和 "),e("code",[s._v("db")]),s._v("，并且 "),e("code",[s._v("web")]),s._v(" 服务依赖于 "),e("code",[s._v("db")]),s._v(" 服务：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" db\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("在这种情况下，"),e("code",[s._v("docker-compose down")]),s._v(" 命令将首先停止 "),e("code",[s._v("web")]),s._v(" 服务，然后再停止 "),e("code",[s._v("db")]),s._v(" 服务。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-build"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-build"}},[s._v("#")]),s._v(" docker-compose build")]),s._v(" "),e("p",[e("code",[s._v("docker-compose build")]),s._v(" 命令用于构建 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务。")]),s._v(" "),e("p",[s._v("如果 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义了多个服务，那么 "),e("code",[s._v("docker-compose build")]),s._v(" 命令将按照 "),e("code",[s._v("depends_on")]),s._v(" 的顺序依次构建这些服务。")]),s._v(" "),e("p",[s._v("例如，以下 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中定义了两个服务 "),e("code",[s._v("web")]),s._v(" 和 "),e("code",[s._v("db")]),s._v("，并且 "),e("code",[s._v("web")]),s._v(" 服务依赖于 "),e("code",[s._v("db")]),s._v(" 服务：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" db\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("在这种情况下，"),e("code",[s._v("docker-compose build")]),s._v(" 命令将首先构建 "),e("code",[s._v("db")]),s._v(" 服务，然后再构建 "),e("code",[s._v("web")]),s._v(" 服务。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-run"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-run"}},[s._v("#")]),s._v(" docker-compose run")]),s._v(" "),e("p",[e("code",[s._v("docker-compose run")]),s._v(" 命令用于在 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的服务中执行命令。")]),s._v(" "),e("p",[s._v("例如，以下 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中定义了一个服务 "),e("code",[s._v("web")]),s._v("：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("在这种情况下，可以使用 "),e("code",[s._v("docker-compose run")]),s._v(" 命令在 "),e("code",[s._v("web")]),s._v(" 服务中执行命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker-compose run web "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"docker-compose-ps"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-ps"}},[s._v("#")]),s._v(" docker-compose ps")]),s._v(" "),e("p",[e("code",[s._v("docker-compose ps")]),s._v(" 命令用于列出 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-logs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-logs"}},[s._v("#")]),s._v(" docker-compose logs")]),s._v(" "),e("p",[e("code",[s._v("docker-compose logs")]),s._v(" 命令用于查看 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务的日志。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-exec"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-exec"}},[s._v("#")]),s._v(" docker-compose exec")]),s._v(" "),e("p",[e("code",[s._v("docker-compose exec")]),s._v(" 命令用于在 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的服务中执行命令。")]),s._v(" "),e("p",[s._v("例如，以下 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件中定义了一个服务 "),e("code",[s._v("web")]),s._v("：")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("在这种情况下，可以使用 "),e("code",[s._v("docker-compose exec")]),s._v(" 命令在 "),e("code",[s._v("web")]),s._v(" 服务中执行命令：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker-compose "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" web "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("command"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"docker-compose-top"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-top"}},[s._v("#")]),s._v(" docker-compose top")]),s._v(" "),e("p",[e("code",[s._v("docker-compose top")]),s._v(" 命令用于查看 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务的进程。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-port"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-port"}},[s._v("#")]),s._v(" docker-compose port")]),s._v(" "),e("p",[e("code",[s._v("docker-compose port")]),s._v(" 命令用于查看 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务的端口映射。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-pause"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-pause"}},[s._v("#")]),s._v(" docker-compose pause")]),s._v(" "),e("p",[e("code",[s._v("docker-compose pause")]),s._v(" 命令用于暂停 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-unpause"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-unpause"}},[s._v("#")]),s._v(" docker-compose unpause")]),s._v(" "),e("p",[e("code",[s._v("docker-compose unpause")]),s._v(" 命令用于取消暂停 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-events"}},[s._v("#")]),s._v(" docker-compose events")]),s._v(" "),e("p",[e("code",[s._v("docker-compose events")]),s._v(" 命令用于查看 "),e("code",[s._v("Docker Compose")]),s._v(" 中定义的所有服务的事件。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-config"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-config"}},[s._v("#")]),s._v(" docker-compose config")]),s._v(" "),e("p",[e("code",[s._v("docker-compose config")]),s._v(" 命令用于验证 "),e("code",[s._v("Docker Compose")]),s._v(" 文件。")]),s._v(" "),e("h3",{attrs:{id:"docker-compose-version"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-version"}},[s._v("#")]),s._v(" docker-compose version")]),s._v(" "),e("p",[e("code",[s._v("docker-compose version")]),s._v(" 命令用于查看 "),e("code",[s._v("Docker Compose")]),s._v(" 的版本信息。")]),s._v(" "),e("h2",{attrs:{id:"部署vue项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署vue项目"}},[s._v("#")]),s._v(" 部署Vue项目")]),s._v(" "),e("p",[s._v("在上一章中，创建了 "),e("code",[s._v("Dockerfile.prod")]),s._v(" 文件，用于构建生产环境的 "),e("code",[s._v("Vue")]),s._v(" 项目。")]),s._v(" "),e("p",[s._v("此处根据 "),e("code",[s._v("Dockerfile.prod")]),s._v(" 来创建 "),e("code",[s._v("docker-compose.yml")]),s._v(" 文件。")]),s._v(" "),e("div",{staticClass:"language-yml line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-yml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.9"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile.prod\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" compose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" VUE_APP_TARGET=production\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80:80"')]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9527:9527"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("也就是说，依旧使用多阶段构建 "),e("code",[s._v("node")]),s._v(" 镜像和 "),e("code",[s._v("nginx")]),s._v(" 镜像。")]),s._v(" "),e("p",[s._v("主要是，因为 "),e("code",[s._v("docker-compose")]),s._v(" 处理文件比较麻烦，而多阶段构建可以直接通过 "),e("code",[s._v("COPY --from")]),s._v(" 指令将目录进行移动。")]),s._v(" "),e("p",[s._v("相对多阶段构建，"),e("code",[s._v("docker-compose")]),s._v(" 的优势在于对于容器的编排、容器服务之间的通信。")])])}),[],!1,null,null,null);a.default=n.exports}}]);