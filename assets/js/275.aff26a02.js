(window.webpackJsonp=window.webpackJsonp||[]).push([[275],{736:function(s,a,n){"use strict";n.r(a);var e=n(40),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("在 "),n("code",[s._v("pnpm")]),s._v(" 中，"),n("code",[s._v("Monorepo")]),s._v(" 项目具有先天的优越性。")]),s._v(" "),n("p",[s._v("因为 "),n("code",[s._v("pnpm")]),s._v(" 对于 "),n("code",[s._v("Monorepo")]),s._v(" 提供了原生支持，最大程度的便利开发。")]),s._v(" "),n("h2",{attrs:{id:"_1-创建根项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建根项目"}},[s._v("#")]),s._v(" 1.创建根项目")]),s._v(" "),n("p",[s._v("利用 "),n("code",[s._v("pnpm init")]),s._v(" 创建根项目，然后新建 "),n("code",[s._v("pnpm-workspace.yaml")]),s._v(" 文件，并添加：")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("packages")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'packages/*'")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'examples/*'")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'!**/test/**'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"_2-添加子项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加子项目"}},[s._v("#")]),s._v(" 2.添加子项目")]),s._v(" "),n("p",[s._v("利用 "),n("code",[s._v("pnpm")]),s._v(" 添加 "),n("code",[s._v("monorepo package")]),s._v("，大致有以下几种方式：")]),s._v(" "),n("h3",{attrs:{id:"_2-1-使用-pnpm-命令（推荐）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-使用-pnpm-命令（推荐）"}},[s._v("#")]),s._v(" 2-1.使用 pnpm 命令（推荐）")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建新包目录并初始化")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" create package packages/my-new-package\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者使用简写")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" create pkg packages/my-new-package\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_2-2-手动创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-手动创建"}},[s._v("#")]),s._v(" 2-2.手动创建")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 创建包目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p packages/my-new-package\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 进入目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" packages/my-new-package\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 初始化 package.json")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" init\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("在新包的 "),n("code",[s._v("package.json")]),s._v(" 中设置必要的字段：")]),s._v(" "),n("div",{staticClass:"language-json:packages/my-new-package/package.json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "name": "@my-scope/my-new-package",  // 包名，通常使用 scope\n  "version": "1.0.0",\n  "main": "dist/index.js",            // 入口文件\n  "types": "dist/index.d.ts",         // TypeScript 类型文件\n  "files": [                          // npm 发布时包含的文件\n    "dist"\n  ],\n  "scripts": {\n    "build": "tsc",\n    "test": "vitest"\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h2",{attrs:{id:"_3-添加依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加依赖"}},[s._v("#")]),s._v(" 3.添加依赖")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 package-b 中添加对 package-a 的依赖")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @my-scope/package-a --filter @my-scope/package-b\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加开发依赖")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -D typescript --filter @my-scope/package-b\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给所有包添加依赖")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -D vitest -w  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -w 表示添加到工作区根目录")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("或者，包之间的版本引用可以使用 "),n("code",[s._v("workspace")]),s._v(" 协议：")]),s._v(" "),n("div",{staticClass:"language-json:packages/package-b/package.json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "dependencies": {\n    "@my-scope/package-a": "workspace:*"  // 自动使用本地版本\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("这样，当这个包发布时，"),n("code",[s._v("package.json")]),s._v(" 会自动更新依赖版本并发布。")])])}),[],!1,null,null,null);a.default=t.exports}}]);