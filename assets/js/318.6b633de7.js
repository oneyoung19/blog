(window.webpackJsonp=window.webpackJsonp||[]).push([[318],{775:function(s,t,a){"use strict";a.r(t);var e=a(40),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_1-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-前言"}},[s._v("#")]),s._v(" 1.前言")]),s._v(" "),a("p",[s._v("为了在日常中的开发效率更高、更容易调试代码，我们一般都会配置一套开发环境下的专用配置。而这其中最为核心的就是"),a("code",[s._v("devServer")]),s._v("。下边我们通过例子来一步步了解。")]),s._v(" "),a("p",[s._v("本章例子完整代码已放在"),a("a",{attrs:{href:"https://github.com/Code1994/dev-server-demo",target:"_blank",rel:"noopener noreferrer"}},[s._v("github"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("为防版本差别，先放出该例的版本依赖：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev-server-demo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"main"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"license"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MIT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"start"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"npm run dev"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpack-dev-server --progress --config webpack/webpack.dev.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpack --config webpack/webpack.prod.js"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"devDependencies"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"clean-webpack-plugin"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"copy-webpack-plugin"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"css-loader"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^5.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"friendly-errors-webpack-plugin"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^1.7.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"html-webpack-plugin"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^4.5.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"ip"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^1.1.5"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"mini-css-extract-plugin"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.1.2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"portfinder"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^1.0.28"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"style-loader"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^2.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"webpack"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"4.29.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"webpack-cli"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.2.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"webpack-dev-server"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^3.11.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"webpack-merge"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^5.4.0"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])]),a("h2",{attrs:{id:"_2-webpack-dev-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-webpack-dev-server"}},[s._v("#")]),s._v(" 2.webpack-dev-server")]),s._v(" "),a("p",[a("code",[s._v("webpack")]),s._v("在开发环境下有专门的依赖来运行打包，即"),a("code",[s._v("webpack-dev-server")]),s._v("。安装之后，配置"),a("code",[s._v("scripts")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpack-dev-server --inline --progress -config webpack/webpack.dev.js"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("其中，"),a("code",[s._v("--inline")]),s._v("是将项目以"),a("code",[s._v("inline")]),s._v("模式在网页中打开，可省略，默认"),a("code",[s._v("inline")]),s._v("模式。而"),a("code",[s._v("--progress")]),s._v("是在控制台显示打包进程，也可省略，无伤大雅，省略了控制台反而清爽。总而言之，这俩项不重要。")]),s._v(" "),a("p",[s._v("执行"),a("code",[s._v("yarn dev")]),s._v("，此时项目已可打开，默认地址"),a("code",[s._v("http://localhost:8080")]),s._v("。更改项目中的代码，也会发现页面会重新刷新，此时的更新模式为"),a("code",[s._v("live reload")]),s._v("，即实时重载页面。")]),s._v(" "),a("p",[s._v("如果想要更改开发环境的某些配置，可以在"),a("code",[s._v("devServer")]),s._v("下进行更改。")]),s._v(" "),a("h2",{attrs:{id:"_3-地址相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-地址相关"}},[s._v("#")]),s._v(" 3.地址相关")]),s._v(" "),a("h3",{attrs:{id:"_3-1-devserver-host"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-devserver-host"}},[s._v("#")]),s._v(" 3-1.devServer.host")]),s._v(" "),a("p",[s._v("主机名。默认为"),a("code",[s._v("localhost")]),s._v("。也可设置成"),a("code",[s._v("127.0.0.1")]),s._v("或"),a("code",[s._v("localIp")]),s._v("。推荐设置成"),a("code",[s._v("0.0.0.0")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("设置成本机ip后，可以方便处于同一局域网下的用户访问我们的开发环境地址。找寻本机ip的方法：")]),s._v(" "),a("p",[s._v("windows系统，在终端执行"),a("code",[s._v("ipconfig")]),s._v("。")]),s._v(" "),a("p",[s._v("macos系统，在终端执行"),a("code",[s._v("ifconfig")]),s._v("。")])]),s._v(" "),a("h3",{attrs:{id:"_3-2-devserver-port"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-devserver-port"}},[s._v("#")]),s._v(" 3-2.devServer.port")]),s._v(" "),a("p",[s._v("端口号。默认为"),a("code",[s._v("8080")]),s._v("。一般为了防止我们设置的端口已被其他服务占用，可使用"),a("code",[s._v("portfinder")]),s._v("这个库，来找寻其他可用端口。")]),s._v(" "),a("h3",{attrs:{id:"_3-3-devserver-open"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-devserver-open"}},[s._v("#")]),s._v(" 3-3.devServer.open")]),s._v(" "),a("p",[s._v("是否自动打开浏览器。默认为"),a("code",[s._v("false")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"_3-4-devserver-uselocalip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-devserver-uselocalip"}},[s._v("#")]),s._v(" 3-4.devServer.useLocalIp")]),s._v(" "),a("p",[s._v("自动打开浏览器时，是否默认使用本机"),a("code",[s._v("ip")]),s._v("。默认为"),a("code",[s._v("false")]),s._v("。注意：当"),a("code",[s._v("host")]),s._v("为"),a("code",[s._v("localIp")]),s._v("或者"),a("code",[s._v("0.0.0.0")]),s._v("时，能正常打开。")]),s._v(" "),a("h3",{attrs:{id:"_3-5-ip与portfinder"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-ip与portfinder"}},[s._v("#")]),s._v(" 3-5.ip与portfinder")]),s._v(" "),a("p",[s._v("为了防止端口占用，可以使用"),a("code",[s._v("portfinder")]),s._v("库。")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("webpack")]),s._v("配置文件中，获取"),a("code",[s._v("localIp")]),s._v("的话，可以使用"),a("code",[s._v("ip")]),s._v("库。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 支持返回一个promise resolve的是devConfig")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  portfinder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("basePort "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" devConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("devServer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("port\n  portfinder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 找到可使用的port后 对devServer重新设置")]),s._v("\n      devConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("devServer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("port "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" port\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" httpType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" devConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("devServer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("https "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http'")]),s._v("\n      devConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FriendlyErrorsPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          compilationSuccessInfo"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            messages"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n              "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("Your application is running here: ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" httpType "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("://")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" devConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("devServer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("host "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" port "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" httpType "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("://127.0.0.1:")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" port "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(" ")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" httpType "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("://")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v(" port "),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("devConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"_4-资源相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-资源相关"}},[s._v("#")]),s._v(" 4.资源相关")]),s._v(" "),a("h3",{attrs:{id:"_4-1-devserver-publicpath"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-devserver-publicpath"}},[s._v("#")]),s._v(" 4-1.devServer.publicPath")]),s._v(" "),a("p",[s._v("开发服务器的访问前缀。默认为"),a("code",[s._v("''")]),s._v("。")]),s._v(" "),a("p",[s._v("没有设置值时，会默认取"),a("code",[s._v("output.publicPath")]),s._v("。"),a("strong",[s._v("但两者并没有优先级关系，二者针对的场景和作用并不同")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[a("code",[s._v("devServer.publicPath")]),s._v("会改变开发环境下的访问地址前缀。")]),s._v(" "),a("ul",[a("li",[s._v("当设置为"),a("code",[s._v("/prefix/")]),s._v("时 浏览器地址会变为"),a("code",[s._v("127.0.0.1:8080/prefix/")]),s._v("，会自动找"),a("code",[s._v("/prefix/")]),s._v("下的"),a("code",[s._v("index.html")]),s._v("。找不到时，"),a("code",[s._v("index.html")]),s._v("的寻找路径以"),a("code",[s._v("contentBase")]),s._v("为主。另外注意"),a("code",[s._v("webpack-dev-server")]),s._v("本身依赖的是一个虚拟的"),a("code",[s._v("dist")]),s._v("目录。")])]),s._v(" "),a("p",[a("code",[s._v("output.publicPath")]),s._v("会改变静态资源的引用前缀 (使用"),a("code",[s._v("html-webpack-plugin")]),s._v("时，在"),a("code",[s._v("dist/index.html")]),s._v("中一看便知)")]),s._v(" "),a("p",[s._v("开发环境下的"),a("code",[s._v("devServer.publicPath")]),s._v("与"),a("code",[s._v("output.publicPath")]),s._v("最好保持一致。否则可能会造成资源"),a("code",[s._v("404")]),s._v("。")])]),s._v(" "),a("h3",{attrs:{id:"_4-2-devserver-contentbase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-devserver-contentbase"}},[s._v("#")]),s._v(" 4-2.devServer.contentBase")]),s._v(" "),a("p",[s._v("设置"),a("code",[s._v("index.html")]),s._v("的寻找路径。默认为当前工作目录，即"),a("code",[s._v("path.resolve(__dirname, '../')")]),s._v("。")]),s._v(" "),a("p",[s._v("寻找"),a("code",[s._v("index.html")]),s._v("时，"),a("code",[s._v("devServer.publicPath")]),s._v("的优先级大于"),a("code",[s._v("devServer.contentBase")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"_4-3-devserver-watchcontentbase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-devserver-watchcontentbase"}},[s._v("#")]),s._v(" 4-3.devServer.watchContentBase")]),s._v(" "),a("p",[s._v("监听"),a("code",[s._v("index.html")]),s._v("的改变。")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("live reload")]),s._v("模式下，修改"),a("code",[s._v("index.html")]),s._v("时，页面并不会自动刷新。设置该选项后，保证"),a("code",[s._v("contentBase")]),s._v("下的"),a("code",[s._v("index.html")]),s._v("修改时页面更新，依赖于"),a("code",[s._v("live reload")]),s._v("。")]),s._v(" "),a("p",[s._v("关闭"),a("code",[s._v("live reload")]),s._v("的话，失效。")]),s._v(" "),a("h2",{attrs:{id:"_5-热更新相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-热更新相关"}},[s._v("#")]),s._v(" 5.热更新相关")]),s._v(" "),a("h3",{attrs:{id:"_5-1-devserver-hot"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-devserver-hot"}},[s._v("#")]),s._v(" 5-1.devServer.hot")]),s._v(" "),a("p",[s._v("是否开启热更新"),a("code",[s._v("hmr")]),s._v("。")]),s._v(" "),a("p",[s._v("虽然"),a("code",[s._v("live reload")]),s._v("的模式，已经可以使页面自动刷新。但"),a("strong",[s._v("由于页面的刷新，页面的数据与状态必然会被初始化")]),s._v("，这样的话，很不利于开发调试。于是我们可以使用"),a("code",[s._v("hot")]),s._v("模式来代替"),a("code",[s._v("live reload")]),s._v("。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("chrome")]),s._v("控制台辨别"),a("code",[s._v("live reload")]),s._v("与"),a("code",[s._v("hot")]),s._v("模式的方式：")]),s._v(" "),a("p",[a("code",[s._v("live reload")]),s._v(": 页面会完全重新刷新，所有资源重新加载，请求重新发送。")]),s._v(" "),a("p",[a("code",[s._v("hot")]),s._v(": 页面部分更新，依赖"),a("code",[s._v("update.json")]),s._v("等类似文件进行更新。")])]),s._v(" "),a("p",[s._v("有一些文章中在开启"),a("code",[s._v("hot")]),s._v("选项后，依然会在开发环境的配置文件中，添加启用"),a("code",[s._v("webpack.HotMuduleReplacementPlugin")]),s._v("插件。但是官网上已经表明，在设置"),a("code",[s._v("hot")]),s._v("为"),a("code",[s._v("true")]),s._v("后，会自动启用该插件，无需再添加了。")]),s._v(" "),a("p",[s._v("其实这块坑还是蛮多的。我在实际测试中发现，即使开启"),a("code",[s._v("hot")]),s._v("为"),a("code",[s._v("true")]),s._v("，页面还是会以"),a("code",[s._v("live reload")]),s._v("的方式更新。排查了一番后，整理出以下的正确步骤：")]),s._v(" "),a("ol",[a("li",[s._v("设置"),a("code",[s._v("devServer.hot")]),s._v("为"),a("code",[s._v("true")])]),s._v(" "),a("li",[s._v("设置"),a("code",[s._v("devServer.liveReload")]),s._v("为"),a("code",[s._v("false")]),s._v("。"),a("strong",[s._v("这个属性看下节")])]),s._v(" "),a("li",[s._v("在"),a("code",[s._v("entry")]),s._v("文件中设置"),a("code",[s._v("module.hot.accept")]),s._v("。用它来监听具体文件的更新。譬如：")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("accept")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./hot.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'现在在更新 hot 模块了~'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("innerHTML "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("在以上步骤之后，改变"),a("code",[s._v("entry")]),s._v("文件时，发现是"),a("code",[s._v("live reload")]),s._v("模式，所以再设置"),a("code",[s._v("devServer.hotOnly")]),s._v("为"),a("code",[s._v("true")]),s._v("。"),a("strong",[s._v("有些缺陷，具体见下下节")])])]),s._v(" "),a("p",[s._v("看到这里，可能会有疑问，为什么实际项目当中并没有以上的代码。那是因为已经有"),a("code",[s._v("loader")]),s._v("帮我们做好了这部分。不必我们写很多个"),a("code",[s._v("module.hot.accept")]),s._v("函数来监听文件改变。譬如"),a("a",{attrs:{href:"https://vue-loader-v14.vuejs.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue-loader"),a("OutboundLink")],1),s._v("以及"),a("a",{attrs:{href:"https://github.com/gaearon/react-hot-loader",target:"_blank",rel:"noopener noreferrer"}},[s._v("react-hot-loader"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[s._v("在上面的步骤后，"),a("code",[s._v("js")]),s._v("文件的热更新应该已经可以正常运行了。而"),a("code",[s._v("css")]),s._v("文件的"),a("code",[s._v("hmr")]),s._v("，需要额外注意一些地方。")]),s._v(" "),a("ul",[a("li",[s._v("如果"),a("code",[s._v("css")]),s._v("使用的是"),a("code",[s._v("style-loader")]),s._v("，那么在修改"),a("code",[s._v("css")]),s._v("后，页面是可以正常热更新的。因为"),a("code",[s._v("style-loader")]),s._v("已经内置了"),a("code",[s._v("module.hot.accept")]),s._v("函数。")]),s._v(" "),a("li",[s._v("如果"),a("code",[s._v("css")]),s._v("使用的是"),a("code",[s._v("mini-css-extract-plugin")]),s._v("的"),a("code",[s._v("loader")]),s._v("，那么热更新需要额外配置。")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" MiniCssExtractPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mini-css-extract-plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  module"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    rules"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        test"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.css$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        use"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 默认支持HMR功能 无需额外设置")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 'style-loader',")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            loader"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" MiniCssExtractPlugin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("loader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            options"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n              hmr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'css-loader'")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("MiniCssExtractPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 开发环境不能使用hash，否则mini-css-extract-plugin的hmr会失效。可以根据环境动态设置。")]),s._v("\n      filename"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'css/[name].css'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("WARNING")]),s._v(" "),a("p",[s._v("开发环境下不要使用"),a("code",[s._v("chunkhash")]),s._v("以及"),a("code",[s._v("contenthash")]),s._v("。否则"),a("code",[s._v("hmr")]),s._v("会报错。"),a("a",{attrs:{href:"https://stackoverflow.com/questions/50217480/cannot-use-chunkhash-or-contenthash-for-chunk-in-name-chunkhash-js-us",target:"_blank",rel:"noopener noreferrer"}},[s._v("issues"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("最好连"),a("code",[s._v("hash")]),s._v("也不要用，"),a("code",[s._v("mini-css-extract-plugin")]),s._v("的"),a("code",[s._v("loader")]),s._v("不支持热更新文件名为"),a("code",[s._v("[name].[hash].css")]),s._v("的"),a("code",[s._v("css")]),s._v("文件。需要设置为"),a("code",[s._v("[name].css")]),s._v("。"),a("a",{attrs:{href:"https://github.com/webpack-contrib/mini-css-extract-plugin/issues/391",target:"_blank",rel:"noopener noreferrer"}},[s._v("issues"),a("OutboundLink")],1)])]),s._v(" "),a("h3",{attrs:{id:"_5-2-devserver-livereload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-devserver-livereload"}},[s._v("#")]),s._v(" 5-2.devServer.liveReload")]),s._v(" "),a("p",[s._v("测试的时候发现，需要将此属性设置为"),a("code",[s._v("false")]),s._v("（虽然官网并无此属性配置）。否则"),a("code",[s._v("HMR")]),s._v("不会生效，一直采用"),a("code",[s._v("live reload")]),s._v("的方式。")]),s._v(" "),a("p",[s._v("如果只是单纯设置了"),a("code",[s._v("hot")]),s._v("选项为"),a("code",[s._v("true")]),s._v("。在更新文件时，依然会发现是"),a("code",[s._v("live reload")]),s._v("模式，因为"),a("code",[s._v("live reload")]),s._v("模式依然开启。见下图：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/oneyoung19/vuepress-blog-img/main/img/0081Kckwly1gkwvztqy7nj30re068dh4.jpg",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_5-3-devserver-hotonly"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-devserver-hotonly"}},[s._v("#")]),s._v(" 5-3.devServer.hotOnly")]),s._v(" "),a("p",[s._v("只使用"),a("code",[s._v("hot")]),s._v("模式，即便是无法热更新。")]),s._v(" "),a("p",[s._v("该配置项即便"),a("code",[s._v("hot")]),s._v("模式失败，也不会去使用"),a("code",[s._v("live reload")]),s._v("模式。")]),s._v(" "),a("p",[s._v("当我配置该项后，在更新"),a("code",[s._v("main.js")]),s._v("时，往往会导致页面有这样的警告。"),a("strong",[s._v("个人认为模块热更新不支持"),a("code",[s._v("main.js")]),s._v("文件")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/oneyoung19/vuepress-blog-img/main/img/0081Kckwly1gkwvpykxelj32k805w76e.jpg",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"_5-4-devserver-inline"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-devserver-inline"}},[s._v("#")]),s._v(" 5-4.devServer.inline")]),s._v(" "),a("p",[s._v("可设置"),a("code",[s._v("dev-server")]),s._v("的两种不同模式，默认为"),a("code",[s._v("true")]),s._v("。应用程序启用内联模式("),a("code",[s._v("inline mode")]),s._v(")。")]),s._v(" "),a("p",[s._v("这意味着一段处理实时重载的脚本被插入到你的包("),a("code",[s._v("bundle")]),s._v(")中，并且构建消息将会出现在浏览器控制台。")]),s._v(" "),a("p",[s._v("也可以使用 "),a("code",[s._v("iframe")]),s._v(" 模式，它在通知栏下面使用 "),a("code",[s._v("<iframe>")]),s._v(" 标签，包含了关于构建的消息。")]),s._v(" "),a("h2",{attrs:{id:"_6-代理相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-代理相关"}},[s._v("#")]),s._v(" 6.代理相关")]),s._v(" "),a("h3",{attrs:{id:"_6-1-devserver-proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-devserver-proxy"}},[s._v("#")]),s._v(" 6-1.devServer.proxy")]),s._v(" "),a("p",[s._v("该配置项主要用来解决前端在开发过程中的跨域。它可以将本地对远程发起的请求做一层代理。")]),s._v(" "),a("p",[s._v("假设我本地开发地址为"),a("code",[s._v("127.0.0.1:8080")]),s._v("，向远程服务器"),a("code",[s._v("http://jsgoshu.cn/blog/")]),s._v("发起请求，必然存在跨域的问题。那么"),a("code",[s._v("webpack")]),s._v("利用"),a("code",[s._v("webpack-dev-server")]),s._v("启了个服务代理，将请求映射到"),a("code",[s._v("127.0.0.1:8080/blog/")]),s._v("。这样的话，开发环境的跨域就已经被解决了。")]),s._v(" "),a("p",[a("code",[s._v("proxy")]),s._v("有两种形式，分别对应单个代理路径与多个代理路径：")]),s._v(" "),a("ol",[a("li",[s._v("对象")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 单个代理路径")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/blog'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    target"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://www.jsgoshu.cn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 重写路径 ")]),s._v("\n    pathRewrite"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^/blog'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/project'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("数组")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 多个代理路径")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    context"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/blog'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/project'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 以 /blog 和 /project开头的请求都会被代理到 http://www.jsgoshu.cn")]),s._v("\n    target"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://www.jsgoshu.cn'")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"_6-2-devserver-headers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-devserver-headers"}},[s._v("#")]),s._v(" 6-2.devServer.headers")]),s._v(" "),a("p",[s._v("自定义代理服务器的"),a("strong",[s._v("响应头")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-response-header"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev-server-demo"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_7-信息相关"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-信息相关"}},[s._v("#")]),s._v(" 7.信息相关")]),s._v(" "),a("h3",{attrs:{id:"_7-1-devserver-quiet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-devserver-quiet"}},[s._v("#")]),s._v(" 7-1.devServer.quiet")]),s._v(" "),a("p",[s._v("净化终端信息，清除掉无用冗余的打包信息。")]),s._v(" "),a("p",[s._v("（本身是个坑比属性 连报错也会隐藏 害的我好久才排查到"),a("code",[s._v("chunkhash")]),s._v("在"),a("code",[s._v("HMR")]),s._v("下报错 🙃 ）")]),s._v(" "),a("p",[s._v("最好搭配"),a("code",[s._v("friendly-errors-webpack-plugin")]),s._v("使用。")]),s._v(" "),a("h3",{attrs:{id:"_7-2-devserver-overlay"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-devserver-overlay"}},[s._v("#")]),s._v(" 7-2.devServer.overlay")]),s._v(" "),a("p",[s._v("将"),a("code",[s._v("errors")]),s._v("满屏显示在浏览器中。")])])}),[],!1,null,null,null);t.default=n.exports}}]);