(window.webpackJsonp=window.webpackJsonp||[]).push([[228],{686:function(e,s,_){"use strict";_.r(s);var v=_(40),a=Object(v.a)({},(function(){var e=this,s=e.$createElement,_=e._self._c||s;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("p",[e._v("在前一章，使用的 "),_("code",[e._v("yarn compiler:plugins")]),e._v(" 以及 "),_("code",[e._v("yarn compiler:presets")]),e._v("，都是直接在命令行中配置了 "),_("code",[e._v("plugins")]),e._v(" 及 "),_("code",[e._v("presets")]),e._v("。")]),e._v(" "),_("p",[e._v("这种方式不够优雅，而且不够友好。所以在理解 "),_("code",[e._v("plugins")]),e._v(" 与 "),_("code",[e._v("presets")]),e._v(" 之前，先来了解下 "),_("code",[e._v("babel")]),e._v(" 提供的专门的配置文件来替代这种方式。")]),e._v(" "),_("p",[e._v("该配置文件有两种类型：")]),e._v(" "),_("ol",[_("li",[e._v("项目范围的配置")])]),e._v(" "),_("ul",[_("li",[_("code",[e._v("babel.config.json")]),e._v(" 文件。可使用扩展名有 "),_("code",[e._v(".json")]),e._v("、"),_("code",[e._v(".js")]),e._v("、"),_("code",[e._v(".cjs")]),e._v("、"),_("code",[e._v(".mjs")]),e._v("。")])]),e._v(" "),_("ol",{attrs:{start:"2"}},[_("li",[e._v("相对文件配置")])]),e._v(" "),_("ul",[_("li",[_("code",[e._v(".babelrc.json")]),e._v(" 文件。可使用扩展名有 "),_("code",[e._v(".json")]),e._v("、"),_("code",[e._v(".js")]),e._v("、"),_("code",[e._v(".cjs")]),e._v("、"),_("code",[e._v(".mjs")]),e._v("。或者直接命名为 "),_("code",[e._v(".babelrc")]),e._v("。")]),e._v(" "),_("li",[_("code",[e._v("package.json")]),e._v(" 文件。 其中有 "),_("code",[e._v("key")]),e._v(" 为 "),_("code",[e._v("babel")]),e._v(" 的设置。")])]),e._v(" "),_("p",[e._v("在项目根目录下设置这两种类型的文件。"),_("code",[e._v("babel")]),e._v(" 在执行的时候会自动寻找。")]),e._v(" "),_("h2",{attrs:{id:"_1-项目范围的配置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1-项目范围的配置"}},[e._v("#")]),e._v(" 1.项目范围的配置")]),e._v(" "),_("p",[_("code",[e._v("babel@7.0")]),e._v(" 开始，具有了"),_("strong",[e._v("根目录")]),e._v("的概念。默认为当前工作目录。("),_("code",[e._v("babel")]),e._v(" 命令执行的目录)。")]),e._v(" "),_("p",[e._v("项目范围的配置，默认的搜索行为是，在当前执行转译命令的目录中直接寻找"),_("code",[e._v("babel.config.json")]),e._v("，找到的话，正常编译，否则不会编译。")]),e._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[e._v("babel-config-demo/\n.\n├── package.json\n├── node_modules\n├── src\n│   ├── main.js\n│   └── package.json\n├── babel.config.js\n└── yarn.lock\n\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br"),_("span",{staticClass:"line-number"},[e._v("2")]),_("br"),_("span",{staticClass:"line-number"},[e._v("3")]),_("br"),_("span",{staticClass:"line-number"},[e._v("4")]),_("br"),_("span",{staticClass:"line-number"},[e._v("5")]),_("br"),_("span",{staticClass:"line-number"},[e._v("6")]),_("br"),_("span",{staticClass:"line-number"},[e._v("7")]),_("br"),_("span",{staticClass:"line-number"},[e._v("8")]),_("br"),_("span",{staticClass:"line-number"},[e._v("9")]),_("br"),_("span",{staticClass:"line-number"},[e._v("10")]),_("br")])]),_("p",[e._v("假设在项目 "),_("code",[e._v("babel-config-demo")]),e._v("中的目录结构如上。")]),e._v(" "),_("p",[e._v("那么当在 "),_("code",[e._v("babel-config-demo/")]),e._v(" 目录下执行 "),_("code",[e._v("babel")]),e._v(" 命令时，是可以正常转码的。而在 "),_("code",[e._v("babel-config-demo/src")]),e._v(" 下无法转码。")]),e._v(" "),_("p",[e._v("另外也可以使用 "),_("a",{attrs:{href:"https://www.babeljs.cn/docs/options#configfile",target:"_blank",rel:"noopener noreferrer"}},[e._v("configFile"),_("OutboundLink")],1),e._v(" 选项来指明具体的 "),_("code",[e._v("babel.config.json")]),e._v(" 路径。需要注意的是，该选项仅允许利用"),_("strong",[e._v("编程方式")]),e._v("使用。即创建 "),_("code",[e._v("js")]),e._v(" 文件，手动引入 "),_("code",[e._v("@babel/core")]),e._v(", 调用 "),_("code",[e._v("api")]),e._v("。")]),e._v(" "),_("p",[e._v("此外，"),_("code",[e._v("babel.config.json")]),e._v(" 也能对 "),_("code",[e._v("node_modules")]),e._v(" 和 "),_("code",[e._v("symlinked packages")]),e._v(" 内的文件进行转码。而 "),_("code",[e._v(".babelrc.json")]),e._v(" 则不能。")]),e._v(" "),_("p",[e._v("从上面的论述中，我们简单总结下 "),_("code",[e._v("babel.config.json")]),e._v(" 类文件的特点：")]),e._v(" "),_("ul",[_("li",[e._v("必须存在于执行目录。执行命令的目录下，必须能找到 "),_("code",[e._v("babel.config.json")]),e._v("。")]),e._v(" "),_("li",[e._v("如果项目特殊，可以利用 "),_("code",[e._v("configFile")]),e._v(" 选项，显式的指定 "),_("code",[e._v("babel.config.json")]),e._v(" 的位置。")]),e._v(" "),_("li",[_("code",[e._v("babel.config.json")]),e._v(" 也能对 "),_("code",[e._v("node_modules")]),e._v(" 和 "),_("code",[e._v("symlinked packages")]),e._v(" 内的文件进行转码。")])]),e._v(" "),_("h2",{attrs:{id:"_2-相对文件的配置"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_2-相对文件的配置"}},[e._v("#")]),e._v(" 2.相对文件的配置")]),e._v(" "),_("p",[e._v("相对文件的配置，默认搜索行为是，根据执行命令先定位到转译的目标文件，基于目标文件的位置，逐次向上排查"),_("code",[e._v(".babelrc.json")]),e._v("。此搜索过程中，有两点注意：")]),e._v(" "),_("ul",[_("li",[e._v("在此搜索过程中，一旦遇到 "),_("code",[e._v("package.json")]),e._v(" 时，此搜索就会停止。")]),e._v(" "),_("li",[e._v("如果找到了 "),_("code",[e._v(".babelrc.json")]),e._v(" ，则此 "),_("code",[e._v(".babelrc.json")]),e._v(" 必须与执行命令在同一级目录。否则 "),_("code",[e._v(".babelrc.json")]),e._v(" 会被忽略，文件不会转译。")])]),e._v(" "),_("h3",{attrs:{id:"示例一"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#示例一"}},[e._v("#")]),e._v(" 示例一")]),e._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[e._v("babelrc-demo/\n.\n├── package.json\n├── node_modules\n├── src\n│   ├── main.js\n│   └── package.json\n├── .babelrc\n└── yarn.lock\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br"),_("span",{staticClass:"line-number"},[e._v("2")]),_("br"),_("span",{staticClass:"line-number"},[e._v("3")]),_("br"),_("span",{staticClass:"line-number"},[e._v("4")]),_("br"),_("span",{staticClass:"line-number"},[e._v("5")]),_("br"),_("span",{staticClass:"line-number"},[e._v("6")]),_("br"),_("span",{staticClass:"line-number"},[e._v("7")]),_("br"),_("span",{staticClass:"line-number"},[e._v("8")]),_("br"),_("span",{staticClass:"line-number"},[e._v("9")]),_("br")])]),_("p",[e._v("在 "),_("code",[e._v("babelrc-demo/")]),e._v(" 下执行 "),_("code",[e._v("yarn compiler")]),e._v(" 命令时，会先定位到 "),_("code",[e._v("src/main.js")]),e._v(" 。然后顺此文件向上查找 "),_("code",[e._v(".babelrc")]),e._v("。但由于 "),_("code",[e._v("src")]),e._v(" 文件夹内有 "),_("code",[e._v("package.json")]),e._v("，所以查找会立刻停止，直接在 "),_("code",[e._v("src")]),e._v(" 下寻找 "),_("code",[e._v(".babelrc")]),e._v("。可想而知，并不会正常执行。")]),e._v(" "),_("h3",{attrs:{id:"示例二"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#示例二"}},[e._v("#")]),e._v(" 示例二")]),e._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[e._v("babelrc-demo/\n.\n├── package.json\n├── node_modules\n├── src\n|   └── .babelrc\n│   ├── main.js\n│   └── package.json\n├── .babelrc\n└── yarn.lock\n")])]),e._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[e._v("1")]),_("br"),_("span",{staticClass:"line-number"},[e._v("2")]),_("br"),_("span",{staticClass:"line-number"},[e._v("3")]),_("br"),_("span",{staticClass:"line-number"},[e._v("4")]),_("br"),_("span",{staticClass:"line-number"},[e._v("5")]),_("br"),_("span",{staticClass:"line-number"},[e._v("6")]),_("br"),_("span",{staticClass:"line-number"},[e._v("7")]),_("br"),_("span",{staticClass:"line-number"},[e._v("8")]),_("br"),_("span",{staticClass:"line-number"},[e._v("9")]),_("br"),_("span",{staticClass:"line-number"},[e._v("10")]),_("br")])]),_("p",[e._v("该例相比上例，在 "),_("code",[e._v("src")]),e._v(" 下多了 "),_("code",[e._v(".babelrc")]),e._v("。")]),e._v(" "),_("p",[e._v("同样，在 "),_("code",[e._v("babelrc-demo/")]),e._v(" 下执行 "),_("code",[e._v("yarn compiler")]),e._v(" 命令时，会先定位到 "),_("code",[e._v("src/main.js")]),e._v(" 。虽然此时在 "),_("code",[e._v("src")]),e._v(" 下可以找到 "),_("code",[e._v(".babelrc")]),e._v("。但由于命令是在 "),_("code",[e._v("babelrc-demo/")]),e._v(" 下，而 "),_("code",[e._v(".babelrc")]),e._v(" 是在 "),_("code",[e._v("babelrc-demo/src/")]),e._v(" 下，两者并不在同一目录，结果也是执行失败。")]),e._v(" "),_("h2",{attrs:{id:"总结"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[e._v("#")]),e._v(" 总结")]),e._v(" "),_("p",[e._v("在大部分情况下，使用项目范围的配置与相对文件的配置，差异并不大。")]),e._v(" "),_("p",[_("code",[e._v("babel")]),e._v(" 之所以要将配置文件分为这两类，主要是为了方便开发者管理类似 "),_("code",[e._v("@babel")]),e._v(" 这种 "),_("code",[e._v("mono packages")]),e._v(" 项目。既能统一集中的管理通用的 "),_("code",[e._v("babel")]),e._v(" 配置（项目范围的配置），又能根据各个 "),_("code",[e._v("package")]),e._v(" 的实际情况做单独的配置（相对文件的配置）。当两种配置同时找到了的时候，相对文件的配置，将会与项目范围的配置进行合并，然后才应用到"),_("strong",[e._v("子package")]),e._v("。")])])}),[],!1,null,null,null);s.default=a.exports}}]);