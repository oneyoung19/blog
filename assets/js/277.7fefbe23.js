(window.webpackJsonp=window.webpackJsonp||[]).push([[277],{734:function(s,n,a){"use strict";a.r(n);var t=a(40),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("有几种方法可以测试 "),a("code",[s._v("pnpm publish")]),s._v(" 而不实际发布到 npm：")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("使用 "),a("code",[s._v("--dry-run")]),s._v(" 选项")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" publish --dry-run\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这会模拟发布过程，显示将要发布的内容，但不会真正发布。")]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("strong",[s._v("使用私有的 npm registry（推荐）")])])]),s._v(" "),a("p",[s._v("使用 "),a("a",{attrs:{href:"https://verdaccio.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Verdaccio"),a("OutboundLink")],1),s._v(" 搭建本地 registry：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 verdaccio")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -g verdaccio\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动本地 registry")]),s._v("\nverdaccio\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 npm registry 为本地地址")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry http://localhost:4873/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建新用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" adduser --registry http://localhost:4873/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" publish --registry http://localhost:4873/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[a("strong",[s._v("使用 "),a("code",[s._v("private")]),s._v(" 字段防止意外发布")])])]),s._v(" "),a("div",{staticClass:"language-json:package.json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n  "private": true,  // 添加这个字段会阻止包被发布\n  "name": "@my-scope/my-package",\n  "version": "1.0.0"\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[a("strong",[s._v("使用 "),a("code",[s._v(".npmrc")]),s._v(" 配置发布目标")])])]),s._v(" "),a("div",{staticClass:"language-ini:.npmrc line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('registry=http://localhost:4873/\n//localhost:4873/:_authToken="your-token"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("测试完成后，记得：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 恢复到 npm 官方源")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry https://registry.npmjs.org/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("使用 Verdaccio 的好处是：")]),s._v(" "),a("ul",[a("li",[s._v("可以完整测试发布流程")]),s._v(" "),a("li",[s._v("可以测试包的安装和依赖")]),s._v(" "),a("li",[s._v("不会污染 npm 官方源")]),s._v(" "),a("li",[s._v("可以测试私有包的发布流程")])])])}),[],!1,null,null,null);n.default=e.exports}}]);