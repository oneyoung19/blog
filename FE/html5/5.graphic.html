<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5.2D/3D绘图 | OneYoung’s Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/blog/favicon.ico">
    <link rel="manifest" href="/blog/manifest.json">
    <script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b5edcf6b1a12076f348b1de5dd83a662";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();</script>
    <script>(function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "o1h2x0tjoo");</script>
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-6MCGJRJCR5"></script>
    <script>window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-6MCGJRJCR5');</script>
    <meta name="description" content="个人技术博客">
    <meta name="google" content="notranslate">
    <link rel="preload" href="/blog/assets/css/0.styles.aa1a1831.css" as="style"><link rel="preload" href="/blog/assets/js/app.27bc6697.js" as="script"><link rel="preload" href="/blog/assets/js/2.edfaf709.js" as="script"><link rel="preload" href="/blog/assets/js/15.32b3105f.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.a8f58508.js"><link rel="prefetch" href="/blog/assets/js/100.09ef33f0.js"><link rel="prefetch" href="/blog/assets/js/101.7d481988.js"><link rel="prefetch" href="/blog/assets/js/102.acfebd4d.js"><link rel="prefetch" href="/blog/assets/js/103.25736bcd.js"><link rel="prefetch" href="/blog/assets/js/104.9a252ee3.js"><link rel="prefetch" href="/blog/assets/js/105.15b12886.js"><link rel="prefetch" href="/blog/assets/js/106.e318f9fb.js"><link rel="prefetch" href="/blog/assets/js/107.ea53d226.js"><link rel="prefetch" href="/blog/assets/js/108.a9d7e2d5.js"><link rel="prefetch" href="/blog/assets/js/109.1c92ae7c.js"><link rel="prefetch" href="/blog/assets/js/11.26a2ff21.js"><link rel="prefetch" href="/blog/assets/js/110.3636f36b.js"><link rel="prefetch" href="/blog/assets/js/111.1017b645.js"><link rel="prefetch" href="/blog/assets/js/112.88eade2a.js"><link rel="prefetch" href="/blog/assets/js/113.bce62b7a.js"><link rel="prefetch" href="/blog/assets/js/114.c02e7293.js"><link rel="prefetch" href="/blog/assets/js/115.366048bc.js"><link rel="prefetch" href="/blog/assets/js/116.19ffea8b.js"><link rel="prefetch" href="/blog/assets/js/117.439ffee0.js"><link rel="prefetch" href="/blog/assets/js/118.7a0dfc89.js"><link rel="prefetch" href="/blog/assets/js/119.a07e8694.js"><link rel="prefetch" href="/blog/assets/js/12.c08d787d.js"><link rel="prefetch" href="/blog/assets/js/120.fc5f3df4.js"><link rel="prefetch" href="/blog/assets/js/121.d635b054.js"><link rel="prefetch" href="/blog/assets/js/122.2b6d0267.js"><link rel="prefetch" href="/blog/assets/js/123.b19b6d1c.js"><link rel="prefetch" href="/blog/assets/js/124.87985fd7.js"><link rel="prefetch" href="/blog/assets/js/125.40b1a233.js"><link rel="prefetch" href="/blog/assets/js/126.6e770a54.js"><link rel="prefetch" href="/blog/assets/js/127.7718fd3b.js"><link rel="prefetch" href="/blog/assets/js/128.532c4ace.js"><link rel="prefetch" href="/blog/assets/js/129.732c71f8.js"><link rel="prefetch" href="/blog/assets/js/13.22712cba.js"><link rel="prefetch" href="/blog/assets/js/130.0d06961b.js"><link rel="prefetch" href="/blog/assets/js/131.0b944cd2.js"><link rel="prefetch" href="/blog/assets/js/132.dd881ccf.js"><link rel="prefetch" href="/blog/assets/js/133.6da81dad.js"><link rel="prefetch" href="/blog/assets/js/134.2f2949c6.js"><link rel="prefetch" href="/blog/assets/js/135.9b3223f6.js"><link rel="prefetch" href="/blog/assets/js/136.b1f5c81d.js"><link rel="prefetch" href="/blog/assets/js/137.21e6f44a.js"><link rel="prefetch" href="/blog/assets/js/138.3541cf96.js"><link rel="prefetch" href="/blog/assets/js/139.34b2dbf7.js"><link rel="prefetch" href="/blog/assets/js/14.2b166264.js"><link rel="prefetch" href="/blog/assets/js/140.8cddefba.js"><link rel="prefetch" href="/blog/assets/js/141.e088ee2c.js"><link rel="prefetch" href="/blog/assets/js/142.4a2fe8b0.js"><link rel="prefetch" href="/blog/assets/js/143.cb0fd7f9.js"><link rel="prefetch" href="/blog/assets/js/144.167d0fc6.js"><link rel="prefetch" href="/blog/assets/js/145.4bbb0fa3.js"><link rel="prefetch" href="/blog/assets/js/146.982f8a3b.js"><link rel="prefetch" href="/blog/assets/js/147.9927d765.js"><link rel="prefetch" href="/blog/assets/js/148.79983545.js"><link rel="prefetch" href="/blog/assets/js/149.c674ab9b.js"><link rel="prefetch" href="/blog/assets/js/150.60f171c5.js"><link rel="prefetch" href="/blog/assets/js/151.94739f45.js"><link rel="prefetch" href="/blog/assets/js/152.f873e48d.js"><link rel="prefetch" href="/blog/assets/js/153.ee8ccba6.js"><link rel="prefetch" href="/blog/assets/js/154.f2c9ceab.js"><link rel="prefetch" href="/blog/assets/js/155.428a9045.js"><link rel="prefetch" href="/blog/assets/js/156.a786fe55.js"><link rel="prefetch" href="/blog/assets/js/157.3cd66ba2.js"><link rel="prefetch" href="/blog/assets/js/158.fd8782c4.js"><link rel="prefetch" href="/blog/assets/js/159.15280e7b.js"><link rel="prefetch" href="/blog/assets/js/16.ddf63894.js"><link rel="prefetch" href="/blog/assets/js/160.e0c0052d.js"><link rel="prefetch" href="/blog/assets/js/161.cd119f50.js"><link rel="prefetch" href="/blog/assets/js/162.51c7e461.js"><link rel="prefetch" href="/blog/assets/js/163.fd24af29.js"><link rel="prefetch" href="/blog/assets/js/164.15444b90.js"><link rel="prefetch" href="/blog/assets/js/165.ebd21b8e.js"><link rel="prefetch" href="/blog/assets/js/166.15ebca21.js"><link rel="prefetch" href="/blog/assets/js/167.3717bdb1.js"><link rel="prefetch" href="/blog/assets/js/168.bf08ae5e.js"><link rel="prefetch" href="/blog/assets/js/169.d7e05b76.js"><link rel="prefetch" href="/blog/assets/js/17.d0bfcd75.js"><link rel="prefetch" href="/blog/assets/js/170.b2f71261.js"><link rel="prefetch" href="/blog/assets/js/171.2a69a45a.js"><link rel="prefetch" href="/blog/assets/js/172.933f4fd7.js"><link rel="prefetch" href="/blog/assets/js/173.6c48d5a1.js"><link rel="prefetch" href="/blog/assets/js/174.d3247986.js"><link rel="prefetch" href="/blog/assets/js/175.538a442a.js"><link rel="prefetch" href="/blog/assets/js/176.d787ca1c.js"><link rel="prefetch" href="/blog/assets/js/177.649f9fd5.js"><link rel="prefetch" href="/blog/assets/js/178.ee9f18d4.js"><link rel="prefetch" href="/blog/assets/js/179.2908bba9.js"><link rel="prefetch" href="/blog/assets/js/18.e784a2f1.js"><link rel="prefetch" href="/blog/assets/js/180.948631a5.js"><link rel="prefetch" href="/blog/assets/js/181.05cd09b3.js"><link rel="prefetch" href="/blog/assets/js/182.805eea69.js"><link rel="prefetch" href="/blog/assets/js/183.adfc0355.js"><link rel="prefetch" href="/blog/assets/js/184.b1469859.js"><link rel="prefetch" href="/blog/assets/js/185.5c6257e3.js"><link rel="prefetch" href="/blog/assets/js/186.bd908bb6.js"><link rel="prefetch" href="/blog/assets/js/187.43007ff0.js"><link rel="prefetch" href="/blog/assets/js/188.50226c15.js"><link rel="prefetch" href="/blog/assets/js/189.1496d270.js"><link rel="prefetch" href="/blog/assets/js/19.8deaa09b.js"><link rel="prefetch" href="/blog/assets/js/190.c3d81baa.js"><link rel="prefetch" href="/blog/assets/js/191.ec17d861.js"><link rel="prefetch" href="/blog/assets/js/192.09f8b6b7.js"><link rel="prefetch" href="/blog/assets/js/193.77016887.js"><link rel="prefetch" href="/blog/assets/js/194.fa12a5c4.js"><link rel="prefetch" href="/blog/assets/js/195.eaae6dfa.js"><link rel="prefetch" href="/blog/assets/js/196.cdfdacd8.js"><link rel="prefetch" href="/blog/assets/js/197.e789eac3.js"><link rel="prefetch" href="/blog/assets/js/198.6da2e1c7.js"><link rel="prefetch" href="/blog/assets/js/199.0de860ed.js"><link rel="prefetch" href="/blog/assets/js/20.3727c4d9.js"><link rel="prefetch" href="/blog/assets/js/200.ecba029e.js"><link rel="prefetch" href="/blog/assets/js/201.0bda0e89.js"><link rel="prefetch" href="/blog/assets/js/202.bf8b9efc.js"><link rel="prefetch" href="/blog/assets/js/203.8b8f4e4e.js"><link rel="prefetch" href="/blog/assets/js/204.66bf20d8.js"><link rel="prefetch" href="/blog/assets/js/205.c286a63c.js"><link rel="prefetch" href="/blog/assets/js/206.82189008.js"><link rel="prefetch" href="/blog/assets/js/207.dba30e6a.js"><link rel="prefetch" href="/blog/assets/js/208.877f65b1.js"><link rel="prefetch" href="/blog/assets/js/209.eb9e3ba9.js"><link rel="prefetch" href="/blog/assets/js/21.eb06bb20.js"><link rel="prefetch" href="/blog/assets/js/210.0d40a647.js"><link rel="prefetch" href="/blog/assets/js/211.9d37722d.js"><link rel="prefetch" href="/blog/assets/js/212.aaf5fb9b.js"><link rel="prefetch" href="/blog/assets/js/213.0c20f7c2.js"><link rel="prefetch" href="/blog/assets/js/214.31fc49c4.js"><link rel="prefetch" href="/blog/assets/js/215.7af558d4.js"><link rel="prefetch" href="/blog/assets/js/216.2ff24ab1.js"><link rel="prefetch" href="/blog/assets/js/217.a76cf60b.js"><link rel="prefetch" href="/blog/assets/js/218.b3a3b9ec.js"><link rel="prefetch" href="/blog/assets/js/219.9f6b01d4.js"><link rel="prefetch" href="/blog/assets/js/22.72cf7765.js"><link rel="prefetch" href="/blog/assets/js/220.dcca57e3.js"><link rel="prefetch" href="/blog/assets/js/221.3a6ab817.js"><link rel="prefetch" href="/blog/assets/js/222.0cc89f77.js"><link rel="prefetch" href="/blog/assets/js/223.8a4f1636.js"><link rel="prefetch" href="/blog/assets/js/224.9d128a0d.js"><link rel="prefetch" href="/blog/assets/js/225.6c2df830.js"><link rel="prefetch" href="/blog/assets/js/226.b00b56c8.js"><link rel="prefetch" href="/blog/assets/js/227.5c38b557.js"><link rel="prefetch" href="/blog/assets/js/228.32dbe5ab.js"><link rel="prefetch" href="/blog/assets/js/229.f4627d47.js"><link rel="prefetch" href="/blog/assets/js/23.3c5fbeb2.js"><link rel="prefetch" href="/blog/assets/js/230.e9e71acd.js"><link rel="prefetch" href="/blog/assets/js/231.9c848f01.js"><link rel="prefetch" href="/blog/assets/js/232.07397341.js"><link rel="prefetch" href="/blog/assets/js/233.cedcfb43.js"><link rel="prefetch" href="/blog/assets/js/234.3775af77.js"><link rel="prefetch" href="/blog/assets/js/235.08ed254f.js"><link rel="prefetch" href="/blog/assets/js/236.dfaba4ae.js"><link rel="prefetch" href="/blog/assets/js/237.b9cdf0f5.js"><link rel="prefetch" href="/blog/assets/js/238.aafd5f21.js"><link rel="prefetch" href="/blog/assets/js/239.fadca9b1.js"><link rel="prefetch" href="/blog/assets/js/24.6cda7501.js"><link rel="prefetch" href="/blog/assets/js/240.0e3bad01.js"><link rel="prefetch" href="/blog/assets/js/241.2506b754.js"><link rel="prefetch" href="/blog/assets/js/242.e8958ddd.js"><link rel="prefetch" href="/blog/assets/js/243.4e378413.js"><link rel="prefetch" href="/blog/assets/js/244.ddcbc2ad.js"><link rel="prefetch" href="/blog/assets/js/245.eec5c5e6.js"><link rel="prefetch" href="/blog/assets/js/246.3eee47b7.js"><link rel="prefetch" href="/blog/assets/js/247.efc3f2f6.js"><link rel="prefetch" href="/blog/assets/js/248.7074cc24.js"><link rel="prefetch" href="/blog/assets/js/249.ed2ad57f.js"><link rel="prefetch" href="/blog/assets/js/25.9145e7aa.js"><link rel="prefetch" href="/blog/assets/js/250.bbe1131d.js"><link rel="prefetch" href="/blog/assets/js/251.ee4c2379.js"><link rel="prefetch" href="/blog/assets/js/252.377b98b9.js"><link rel="prefetch" href="/blog/assets/js/253.c7bebde3.js"><link rel="prefetch" href="/blog/assets/js/254.bea35cee.js"><link rel="prefetch" href="/blog/assets/js/255.01fa8805.js"><link rel="prefetch" href="/blog/assets/js/256.b1dc4614.js"><link rel="prefetch" href="/blog/assets/js/257.444ac439.js"><link rel="prefetch" href="/blog/assets/js/258.4883857f.js"><link rel="prefetch" href="/blog/assets/js/259.95bc0bd7.js"><link rel="prefetch" href="/blog/assets/js/26.26a66cb9.js"><link rel="prefetch" href="/blog/assets/js/260.c68967ee.js"><link rel="prefetch" href="/blog/assets/js/261.bd922891.js"><link rel="prefetch" href="/blog/assets/js/262.12a754e9.js"><link rel="prefetch" href="/blog/assets/js/263.49cb8008.js"><link rel="prefetch" href="/blog/assets/js/264.78d64741.js"><link rel="prefetch" href="/blog/assets/js/265.017abba5.js"><link rel="prefetch" href="/blog/assets/js/266.81ec8676.js"><link rel="prefetch" href="/blog/assets/js/267.7a397a78.js"><link rel="prefetch" href="/blog/assets/js/268.fb9737f1.js"><link rel="prefetch" href="/blog/assets/js/269.001e8099.js"><link rel="prefetch" href="/blog/assets/js/27.79197e6d.js"><link rel="prefetch" href="/blog/assets/js/270.32cf0fe6.js"><link rel="prefetch" href="/blog/assets/js/271.afdea60f.js"><link rel="prefetch" href="/blog/assets/js/272.43c76c4f.js"><link rel="prefetch" href="/blog/assets/js/273.7f0358fc.js"><link rel="prefetch" href="/blog/assets/js/274.96251059.js"><link rel="prefetch" href="/blog/assets/js/275.d6caa260.js"><link rel="prefetch" href="/blog/assets/js/276.b8fd69c3.js"><link rel="prefetch" href="/blog/assets/js/277.e44d3611.js"><link rel="prefetch" href="/blog/assets/js/278.32645d69.js"><link rel="prefetch" href="/blog/assets/js/279.c582c34b.js"><link rel="prefetch" href="/blog/assets/js/28.7c13dcec.js"><link rel="prefetch" href="/blog/assets/js/280.a4275851.js"><link rel="prefetch" href="/blog/assets/js/281.f7fc1072.js"><link rel="prefetch" href="/blog/assets/js/282.b7c72da7.js"><link rel="prefetch" href="/blog/assets/js/283.4c785b65.js"><link rel="prefetch" href="/blog/assets/js/284.da94cb7b.js"><link rel="prefetch" href="/blog/assets/js/285.2cb3de0f.js"><link rel="prefetch" href="/blog/assets/js/286.8c0ec50a.js"><link rel="prefetch" href="/blog/assets/js/287.208f7490.js"><link rel="prefetch" href="/blog/assets/js/288.4623ba81.js"><link rel="prefetch" href="/blog/assets/js/289.611edc9f.js"><link rel="prefetch" href="/blog/assets/js/29.c46ebe2e.js"><link rel="prefetch" href="/blog/assets/js/290.8cbe0a5a.js"><link rel="prefetch" href="/blog/assets/js/291.1ff96156.js"><link rel="prefetch" href="/blog/assets/js/292.ac48d376.js"><link rel="prefetch" href="/blog/assets/js/293.d6379846.js"><link rel="prefetch" href="/blog/assets/js/294.e54690af.js"><link rel="prefetch" href="/blog/assets/js/295.736b6582.js"><link rel="prefetch" href="/blog/assets/js/296.85ce6480.js"><link rel="prefetch" href="/blog/assets/js/297.cba4fcd4.js"><link rel="prefetch" href="/blog/assets/js/298.1a7b3852.js"><link rel="prefetch" href="/blog/assets/js/299.1e566ccc.js"><link rel="prefetch" href="/blog/assets/js/3.c6c109fb.js"><link rel="prefetch" href="/blog/assets/js/30.128baafb.js"><link rel="prefetch" href="/blog/assets/js/300.dace87b0.js"><link rel="prefetch" href="/blog/assets/js/301.889bcb7d.js"><link rel="prefetch" href="/blog/assets/js/302.0b0b4264.js"><link rel="prefetch" href="/blog/assets/js/303.f3820c98.js"><link rel="prefetch" href="/blog/assets/js/304.3cb311a5.js"><link rel="prefetch" href="/blog/assets/js/305.05efa766.js"><link rel="prefetch" href="/blog/assets/js/306.fd4ca73b.js"><link rel="prefetch" href="/blog/assets/js/307.0340a6dc.js"><link rel="prefetch" href="/blog/assets/js/308.0b2078f2.js"><link rel="prefetch" href="/blog/assets/js/309.685d35c4.js"><link rel="prefetch" href="/blog/assets/js/31.c0c2da57.js"><link rel="prefetch" href="/blog/assets/js/310.6ef31ecd.js"><link rel="prefetch" href="/blog/assets/js/311.0d20eec2.js"><link rel="prefetch" href="/blog/assets/js/312.bcf78d21.js"><link rel="prefetch" href="/blog/assets/js/313.bcfe0653.js"><link rel="prefetch" href="/blog/assets/js/314.a6ba239f.js"><link rel="prefetch" href="/blog/assets/js/315.d1b0f94c.js"><link rel="prefetch" href="/blog/assets/js/316.9c5a0e25.js"><link rel="prefetch" href="/blog/assets/js/317.64127e58.js"><link rel="prefetch" href="/blog/assets/js/318.0556990f.js"><link rel="prefetch" href="/blog/assets/js/319.1ea558a1.js"><link rel="prefetch" href="/blog/assets/js/32.36744a2b.js"><link rel="prefetch" href="/blog/assets/js/320.9332cd57.js"><link rel="prefetch" href="/blog/assets/js/321.05ae6037.js"><link rel="prefetch" href="/blog/assets/js/322.2112b75c.js"><link rel="prefetch" href="/blog/assets/js/323.f2a88a63.js"><link rel="prefetch" href="/blog/assets/js/324.4be06780.js"><link rel="prefetch" href="/blog/assets/js/325.7fec8a09.js"><link rel="prefetch" href="/blog/assets/js/326.5c357df6.js"><link rel="prefetch" href="/blog/assets/js/327.ae4ebd88.js"><link rel="prefetch" href="/blog/assets/js/328.71e9792d.js"><link rel="prefetch" href="/blog/assets/js/329.00695fed.js"><link rel="prefetch" href="/blog/assets/js/33.c813c08f.js"><link rel="prefetch" href="/blog/assets/js/330.1fc922ba.js"><link rel="prefetch" href="/blog/assets/js/331.38a6cf21.js"><link rel="prefetch" href="/blog/assets/js/332.fa0e6d7d.js"><link rel="prefetch" href="/blog/assets/js/333.410949ec.js"><link rel="prefetch" href="/blog/assets/js/334.4878e340.js"><link rel="prefetch" href="/blog/assets/js/335.f749865b.js"><link rel="prefetch" href="/blog/assets/js/336.cd2d7f02.js"><link rel="prefetch" href="/blog/assets/js/337.a4d70339.js"><link rel="prefetch" href="/blog/assets/js/338.13fe92f2.js"><link rel="prefetch" href="/blog/assets/js/339.73ac424d.js"><link rel="prefetch" href="/blog/assets/js/34.4d3fd3e2.js"><link rel="prefetch" href="/blog/assets/js/340.ed345e3d.js"><link rel="prefetch" href="/blog/assets/js/341.77ef9f9b.js"><link rel="prefetch" href="/blog/assets/js/342.5bd4fca2.js"><link rel="prefetch" href="/blog/assets/js/343.4a42ed15.js"><link rel="prefetch" href="/blog/assets/js/344.b7474758.js"><link rel="prefetch" href="/blog/assets/js/345.db7f7fde.js"><link rel="prefetch" href="/blog/assets/js/346.60f442e9.js"><link rel="prefetch" href="/blog/assets/js/347.3b6ffd67.js"><link rel="prefetch" href="/blog/assets/js/348.d528d212.js"><link rel="prefetch" href="/blog/assets/js/349.18fcc1e2.js"><link rel="prefetch" href="/blog/assets/js/35.374f41ce.js"><link rel="prefetch" href="/blog/assets/js/350.923e0bb6.js"><link rel="prefetch" href="/blog/assets/js/351.ab16be6a.js"><link rel="prefetch" href="/blog/assets/js/352.c125c379.js"><link rel="prefetch" href="/blog/assets/js/353.988b278b.js"><link rel="prefetch" href="/blog/assets/js/354.13e079ac.js"><link rel="prefetch" href="/blog/assets/js/355.eb1e9472.js"><link rel="prefetch" href="/blog/assets/js/356.64f1cc03.js"><link rel="prefetch" href="/blog/assets/js/357.21fa6ee7.js"><link rel="prefetch" href="/blog/assets/js/358.6d3441ea.js"><link rel="prefetch" href="/blog/assets/js/359.99ef3151.js"><link rel="prefetch" href="/blog/assets/js/36.8691f6b9.js"><link rel="prefetch" href="/blog/assets/js/360.d16ed802.js"><link rel="prefetch" href="/blog/assets/js/361.a7a5a9dc.js"><link rel="prefetch" href="/blog/assets/js/362.728eb96b.js"><link rel="prefetch" href="/blog/assets/js/363.2eed6eaf.js"><link rel="prefetch" href="/blog/assets/js/364.2bbc6569.js"><link rel="prefetch" href="/blog/assets/js/365.c73e1814.js"><link rel="prefetch" href="/blog/assets/js/366.5a9fc4a8.js"><link rel="prefetch" href="/blog/assets/js/367.1c5222bf.js"><link rel="prefetch" href="/blog/assets/js/368.f1a04eea.js"><link rel="prefetch" href="/blog/assets/js/369.67703839.js"><link rel="prefetch" href="/blog/assets/js/37.02ca8407.js"><link rel="prefetch" href="/blog/assets/js/370.6c6e9be8.js"><link rel="prefetch" href="/blog/assets/js/371.95aff636.js"><link rel="prefetch" href="/blog/assets/js/372.ea5fc9a0.js"><link rel="prefetch" href="/blog/assets/js/373.72ac1ae9.js"><link rel="prefetch" href="/blog/assets/js/374.6451a341.js"><link rel="prefetch" href="/blog/assets/js/375.d76c6d1e.js"><link rel="prefetch" href="/blog/assets/js/376.d0a8a817.js"><link rel="prefetch" href="/blog/assets/js/377.25ffe703.js"><link rel="prefetch" href="/blog/assets/js/378.594a9e75.js"><link rel="prefetch" href="/blog/assets/js/379.3eee4980.js"><link rel="prefetch" href="/blog/assets/js/38.3753952d.js"><link rel="prefetch" href="/blog/assets/js/380.0b9f7b35.js"><link rel="prefetch" href="/blog/assets/js/381.f00e46ea.js"><link rel="prefetch" href="/blog/assets/js/382.af50b999.js"><link rel="prefetch" href="/blog/assets/js/383.ad086151.js"><link rel="prefetch" href="/blog/assets/js/384.6551b192.js"><link rel="prefetch" href="/blog/assets/js/385.3f219759.js"><link rel="prefetch" href="/blog/assets/js/386.8a1e7c85.js"><link rel="prefetch" href="/blog/assets/js/387.2866c884.js"><link rel="prefetch" href="/blog/assets/js/388.8fe409b8.js"><link rel="prefetch" href="/blog/assets/js/389.9cf48ec5.js"><link rel="prefetch" href="/blog/assets/js/39.db1f296b.js"><link rel="prefetch" href="/blog/assets/js/390.585ca4f2.js"><link rel="prefetch" href="/blog/assets/js/391.101e2729.js"><link rel="prefetch" href="/blog/assets/js/392.8a848094.js"><link rel="prefetch" href="/blog/assets/js/393.85f726e1.js"><link rel="prefetch" href="/blog/assets/js/394.04597602.js"><link rel="prefetch" href="/blog/assets/js/395.05c2776d.js"><link rel="prefetch" href="/blog/assets/js/396.336ab08a.js"><link rel="prefetch" href="/blog/assets/js/397.0881278e.js"><link rel="prefetch" href="/blog/assets/js/398.aab650fd.js"><link rel="prefetch" href="/blog/assets/js/399.46e35a1b.js"><link rel="prefetch" href="/blog/assets/js/4.8fdfb609.js"><link rel="prefetch" href="/blog/assets/js/40.5630d3c5.js"><link rel="prefetch" href="/blog/assets/js/400.fea8d636.js"><link rel="prefetch" href="/blog/assets/js/401.4e63964d.js"><link rel="prefetch" href="/blog/assets/js/402.612078b5.js"><link rel="prefetch" href="/blog/assets/js/403.0c4af9f3.js"><link rel="prefetch" href="/blog/assets/js/41.83ecb665.js"><link rel="prefetch" href="/blog/assets/js/42.d6d23592.js"><link rel="prefetch" href="/blog/assets/js/43.57439205.js"><link rel="prefetch" href="/blog/assets/js/44.4b177746.js"><link rel="prefetch" href="/blog/assets/js/45.d7ef74e0.js"><link rel="prefetch" href="/blog/assets/js/46.c284dbbb.js"><link rel="prefetch" href="/blog/assets/js/47.50ab98a1.js"><link rel="prefetch" href="/blog/assets/js/48.7745364e.js"><link rel="prefetch" href="/blog/assets/js/49.f9073d7d.js"><link rel="prefetch" href="/blog/assets/js/5.5dc5e619.js"><link rel="prefetch" href="/blog/assets/js/50.a3f4a84c.js"><link rel="prefetch" href="/blog/assets/js/51.1e3f650f.js"><link rel="prefetch" href="/blog/assets/js/52.8d744083.js"><link rel="prefetch" href="/blog/assets/js/53.73998292.js"><link rel="prefetch" href="/blog/assets/js/54.c59ebe0e.js"><link rel="prefetch" href="/blog/assets/js/55.5d187431.js"><link rel="prefetch" href="/blog/assets/js/56.4bf600d9.js"><link rel="prefetch" href="/blog/assets/js/57.04f9f947.js"><link rel="prefetch" href="/blog/assets/js/58.d6dce73a.js"><link rel="prefetch" href="/blog/assets/js/59.ac1261ad.js"><link rel="prefetch" href="/blog/assets/js/6.e070fc01.js"><link rel="prefetch" href="/blog/assets/js/60.2f58e8d3.js"><link rel="prefetch" href="/blog/assets/js/61.4cf2528a.js"><link rel="prefetch" href="/blog/assets/js/62.8a1be7f3.js"><link rel="prefetch" href="/blog/assets/js/63.a0e68dd5.js"><link rel="prefetch" href="/blog/assets/js/64.440c7c00.js"><link rel="prefetch" href="/blog/assets/js/65.30943576.js"><link rel="prefetch" href="/blog/assets/js/66.c60b162f.js"><link rel="prefetch" href="/blog/assets/js/67.d48610be.js"><link rel="prefetch" href="/blog/assets/js/68.4e9b26c9.js"><link rel="prefetch" href="/blog/assets/js/69.0d09cab2.js"><link rel="prefetch" href="/blog/assets/js/7.9dfafb08.js"><link rel="prefetch" href="/blog/assets/js/70.dc764566.js"><link rel="prefetch" href="/blog/assets/js/71.ee4a7680.js"><link rel="prefetch" href="/blog/assets/js/72.c4c0b1ba.js"><link rel="prefetch" href="/blog/assets/js/73.cad68278.js"><link rel="prefetch" href="/blog/assets/js/74.420f78fc.js"><link rel="prefetch" href="/blog/assets/js/75.7dcf369c.js"><link rel="prefetch" href="/blog/assets/js/76.468e3be5.js"><link rel="prefetch" href="/blog/assets/js/77.09fb85c4.js"><link rel="prefetch" href="/blog/assets/js/78.b40f673b.js"><link rel="prefetch" href="/blog/assets/js/79.de568140.js"><link rel="prefetch" href="/blog/assets/js/8.c22f62c3.js"><link rel="prefetch" href="/blog/assets/js/80.9c0a25a4.js"><link rel="prefetch" href="/blog/assets/js/81.53a17f41.js"><link rel="prefetch" href="/blog/assets/js/82.adab6747.js"><link rel="prefetch" href="/blog/assets/js/83.347075ba.js"><link rel="prefetch" href="/blog/assets/js/84.27922f7a.js"><link rel="prefetch" href="/blog/assets/js/85.d7c72d91.js"><link rel="prefetch" href="/blog/assets/js/86.27841bb9.js"><link rel="prefetch" href="/blog/assets/js/87.229709e6.js"><link rel="prefetch" href="/blog/assets/js/88.b0053c01.js"><link rel="prefetch" href="/blog/assets/js/89.c8fcacec.js"><link rel="prefetch" href="/blog/assets/js/9.e3a31bfc.js"><link rel="prefetch" href="/blog/assets/js/90.5b0fd2ff.js"><link rel="prefetch" href="/blog/assets/js/91.344891b7.js"><link rel="prefetch" href="/blog/assets/js/92.14009a3b.js"><link rel="prefetch" href="/blog/assets/js/93.bbb96919.js"><link rel="prefetch" href="/blog/assets/js/94.fc5a355f.js"><link rel="prefetch" href="/blog/assets/js/95.fe7b8ff9.js"><link rel="prefetch" href="/blog/assets/js/96.964509c8.js"><link rel="prefetch" href="/blog/assets/js/97.109d6916.js"><link rel="prefetch" href="/blog/assets/js/98.5f20db92.js"><link rel="prefetch" href="/blog/assets/js/99.22d98dd2.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.aa1a1831.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">OneYoung’s Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Basic
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html/" class="nav-link">
  HTML
</a></li></ul></li><li class="dropdown-item"><h4>
          Feature
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html5/" class="nav-link router-link-active">
  HTML5
</a></li><li class="dropdown-subitem"><a href="/blog/FE/css3/1.start.html" class="nav-link">
  CSS3
</a></li><li class="dropdown-subitem"><a href="/blog/FE/worker/1.WebWorker.html" class="nav-link">
  Worker
</a></li><li class="dropdown-subitem"><a href="/blog/FE/PWA/" class="nav-link">
  PWA
</a></li><li class="dropdown-subitem"><a href="/blog/FE/rendering/1.start.html" class="nav-link">
  Rendering
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/javascript/BOM/1.start.html" class="nav-link">
  BOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/DOM/1.start.html" class="nav-link">
  DOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/ECMAScript/1.start.html" class="nav-link">
  ECMAScript
</a></li></ul></li><li class="dropdown-item"><h4>
          JS进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/js-advance/es6/" class="nav-link">
  ES6
</a></li><li class="dropdown-subitem"><a href="/blog/FE/js-advance/module/1.start.html" class="nav-link">
  Module
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架及库" class="dropdown-title"><span class="title">框架及库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Axios
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/axios/base/1.install.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/axios/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Vue2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/vue2/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/vue2/source-code/compiler/" class="nav-link">
  compiler
</a></li></ul></li><li class="dropdown-item"><h4>
          Nuxt
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/nuxt/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Express
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/express/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/express/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Koa
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/koa/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/koa/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          CryptoJs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/crypto-js/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机科学" class="dropdown-title"><span class="title">计算机科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cs/string/1.unicode.html" class="nav-link">
  String
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/digit/1.start.html" class="nav-link">
  Digit
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/binary-file/1.start.html" class="nav-link">
  二进制数据与文件
</a></li><li class="dropdown-item"><h4>
          HTTP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/http/communication.html" class="nav-link">
  通信过程
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/url.html" class="nav-link">
  URL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/formdata.html" class="nav-link">
  FormData
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/xhr-fetch.html" class="nav-link">
  XHR/Fetch
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cors.html" class="nav-link">
  CORS
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cookie.html" class="nav-link">
  Cookie
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/security.html" class="nav-link">
  网络安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/upload.html" class="nav-link">
  文件上传
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/download.html" class="nav-link">
  文件下载
</a></li></ul></li><li class="dropdown-item"><h4>
          HTTPS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/https/encryption.html" class="nav-link">
  数据安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/tls&amp;ssl.html" class="nav-link">
  TLS与SSL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/setup.html" class="nav-link">
  项目配置SSL
</a></li></ul></li><li class="dropdown-item"><h4>
          高级
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/advance/design-pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/data-structures/" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/algorithm/" class="nav-link">
  算法
</a></li></ul></li><li class="dropdown-item"><h4>
          IM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/im/sse/" class="nav-link">
  SSE
</a></li><li class="dropdown-subitem"><a href="/blog/cs/im/websocket/" class="nav-link">
  Websocket
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="跨平台" class="dropdown-title"><span class="title">跨平台</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cross/h5/" class="nav-link">
  H5
</a></li><li class="dropdown-item"><!----> <a href="/blog/cross/weChat-public/1.authorization.html" class="nav-link">
  微信公众号
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/engineer/git/1.start.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/engineer/ts/1.start.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><h4>
          Package Manager
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/npm/1.start.html" class="nav-link">
  NPM
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/yarn/1.start.html" class="nav-link">
  Yarn
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/pnpm/1.start.html" class="nav-link">
  PNPM
</a></li></ul></li><li class="dropdown-item"><h4>
          MonoRepo
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/workspace/1.start.html" class="nav-link">
  Workspace
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/lerna/1.start.html" class="nav-link">
  Lerna
</a></li></ul></li><li class="dropdown-item"><h4>
          Assist
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/babel/1.start.html" class="nav-link">
  Babel
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/postcss/1.start.html" class="nav-link">
  Postcss
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/eslint/1.start.html" class="nav-link">
  Eslint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/prettier/1.start.html" class="nav-link">
  Prettier
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/husky/" class="nav-link">
  Husky
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/commitlint/" class="nav-link">
  CommitLint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/conventional-changelog/" class="nav-link">
  Conventional Changelog
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/standard-version/" class="nav-link">
  Standard Version
</a></li></ul></li><li class="dropdown-item"><h4>
          Bundler
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/gulp/1.start.html" class="nav-link">
  Gulp
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/rollup/1.introduction.html" class="nav-link">
  Rollup
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/webpack/1.start.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/vite/" class="nav-link">
  Vite
</a></li></ul></li><li class="dropdown-item"><h4>
          Misc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/misc/obfuscator/" class="nav-link">
  Debugger &amp; Obfuscator
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/BE/standard/" class="nav-link">
  Standard
</a></li><li class="dropdown-item"><h4>
          认证与授权
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/authentication/jwt/" class="nav-link">
  JWT
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/oauth2/" class="nav-link">
  OAuth2.0
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/2fa/" class="nav-link">
  2FA
</a></li></ul></li><li class="dropdown-item"><h4>
          SSR
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssr-vue2/" class="nav-link">
  SSR Vue2
</a></li><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssg-vue2/" class="nav-link">
  SSG Vue2
</a></li></ul></li><li class="dropdown-item"><h4>
          Node
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/node/awesome/" class="nav-link">
  Awesome
</a></li><li class="dropdown-subitem"><a href="/blog/BE/node/docs/" class="nav-link">
  Docs
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/DB/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mongodb/" class="nav-link">
  Mongodb
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="部署" class="dropdown-title"><span class="title">部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/deploy/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/shell/1.start.html" class="nav-link">
  Shell
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/CI-CD/1.start.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/jenkins/1.start.html" class="nav-link">
  Jenkins
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tool/github/" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/charles/" class="nav-link">
  Charles
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/verdaccio/" class="nav-link">
  Verdaccio
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/remote-ssh/" class="nav-link">
  Remote-SSH
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/localtunnel/" class="nav-link">
  Localtunnel
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/AI/" class="nav-link">
  AI工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/oneyoung19" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Basic
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html/" class="nav-link">
  HTML
</a></li></ul></li><li class="dropdown-item"><h4>
          Feature
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/html5/" class="nav-link router-link-active">
  HTML5
</a></li><li class="dropdown-subitem"><a href="/blog/FE/css3/1.start.html" class="nav-link">
  CSS3
</a></li><li class="dropdown-subitem"><a href="/blog/FE/worker/1.WebWorker.html" class="nav-link">
  Worker
</a></li><li class="dropdown-subitem"><a href="/blog/FE/PWA/" class="nav-link">
  PWA
</a></li><li class="dropdown-subitem"><a href="/blog/FE/rendering/1.start.html" class="nav-link">
  Rendering
</a></li></ul></li><li class="dropdown-item"><h4>
          JavaScript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/javascript/BOM/1.start.html" class="nav-link">
  BOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/DOM/1.start.html" class="nav-link">
  DOM
</a></li><li class="dropdown-subitem"><a href="/blog/FE/javascript/ECMAScript/1.start.html" class="nav-link">
  ECMAScript
</a></li></ul></li><li class="dropdown-item"><h4>
          JS进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/FE/js-advance/es6/" class="nav-link">
  ES6
</a></li><li class="dropdown-subitem"><a href="/blog/FE/js-advance/module/1.start.html" class="nav-link">
  Module
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架及库" class="dropdown-title"><span class="title">框架及库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Axios
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/axios/base/1.install.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/axios/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Vue2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/vue2/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/vue2/source-code/compiler/" class="nav-link">
  compiler
</a></li></ul></li><li class="dropdown-item"><h4>
          Nuxt
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/nuxt/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Express
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/express/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/express/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          Koa
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/koa/base/1.start.html" class="nav-link">
  基础使用
</a></li><li class="dropdown-subitem"><a href="/blog/frame/koa/source-code/1.start.html" class="nav-link">
  源码解析
</a></li></ul></li><li class="dropdown-item"><h4>
          CryptoJs
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/frame/crypto-js/base/1.start.html" class="nav-link">
  基础使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机科学" class="dropdown-title"><span class="title">计算机科学</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cs/string/1.unicode.html" class="nav-link">
  String
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/digit/1.start.html" class="nav-link">
  Digit
</a></li><li class="dropdown-item"><!----> <a href="/blog/cs/binary-file/1.start.html" class="nav-link">
  二进制数据与文件
</a></li><li class="dropdown-item"><h4>
          HTTP
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/http/communication.html" class="nav-link">
  通信过程
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/url.html" class="nav-link">
  URL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/formdata.html" class="nav-link">
  FormData
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/xhr-fetch.html" class="nav-link">
  XHR/Fetch
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cors.html" class="nav-link">
  CORS
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/cookie.html" class="nav-link">
  Cookie
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/security.html" class="nav-link">
  网络安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/upload.html" class="nav-link">
  文件上传
</a></li><li class="dropdown-subitem"><a href="/blog/cs/http/download.html" class="nav-link">
  文件下载
</a></li></ul></li><li class="dropdown-item"><h4>
          HTTPS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/https/encryption.html" class="nav-link">
  数据安全
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/tls&amp;ssl.html" class="nav-link">
  TLS与SSL
</a></li><li class="dropdown-subitem"><a href="/blog/cs/https/setup.html" class="nav-link">
  项目配置SSL
</a></li></ul></li><li class="dropdown-item"><h4>
          高级
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/advance/design-pattern/" class="nav-link">
  设计模式
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/data-structures/" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/blog/cs/advance/algorithm/" class="nav-link">
  算法
</a></li></ul></li><li class="dropdown-item"><h4>
          IM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/cs/im/sse/" class="nav-link">
  SSE
</a></li><li class="dropdown-subitem"><a href="/blog/cs/im/websocket/" class="nav-link">
  Websocket
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="跨平台" class="dropdown-title"><span class="title">跨平台</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cross/h5/" class="nav-link">
  H5
</a></li><li class="dropdown-item"><!----> <a href="/blog/cross/weChat-public/1.authorization.html" class="nav-link">
  微信公众号
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/engineer/git/1.start.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/engineer/ts/1.start.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><h4>
          Package Manager
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/npm/1.start.html" class="nav-link">
  NPM
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/yarn/1.start.html" class="nav-link">
  Yarn
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/pkg-manager/pnpm/1.start.html" class="nav-link">
  PNPM
</a></li></ul></li><li class="dropdown-item"><h4>
          MonoRepo
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/workspace/1.start.html" class="nav-link">
  Workspace
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/mono-repo/lerna/1.start.html" class="nav-link">
  Lerna
</a></li></ul></li><li class="dropdown-item"><h4>
          Assist
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/babel/1.start.html" class="nav-link">
  Babel
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/postcss/1.start.html" class="nav-link">
  Postcss
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/eslint/1.start.html" class="nav-link">
  Eslint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/prettier/1.start.html" class="nav-link">
  Prettier
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/husky/" class="nav-link">
  Husky
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/commitlint/" class="nav-link">
  CommitLint
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/conventional-changelog/" class="nav-link">
  Conventional Changelog
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/standard-version/" class="nav-link">
  Standard Version
</a></li></ul></li><li class="dropdown-item"><h4>
          Bundler
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/gulp/1.start.html" class="nav-link">
  Gulp
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/rollup/1.introduction.html" class="nav-link">
  Rollup
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/webpack/1.start.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-subitem"><a href="/blog/engineer/vite/" class="nav-link">
  Vite
</a></li></ul></li><li class="dropdown-item"><h4>
          Misc
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/engineer/misc/obfuscator/" class="nav-link">
  Debugger &amp; Obfuscator
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/BE/standard/" class="nav-link">
  Standard
</a></li><li class="dropdown-item"><h4>
          认证与授权
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/authentication/jwt/" class="nav-link">
  JWT
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/oauth2/" class="nav-link">
  OAuth2.0
</a></li><li class="dropdown-subitem"><a href="/blog/BE/authentication/2fa/" class="nav-link">
  2FA
</a></li></ul></li><li class="dropdown-item"><h4>
          SSR
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssr-vue2/" class="nav-link">
  SSR Vue2
</a></li><li class="dropdown-subitem"><a href="/blog/BE/ssr/ssg-vue2/" class="nav-link">
  SSG Vue2
</a></li></ul></li><li class="dropdown-item"><h4>
          Node
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/BE/node/awesome/" class="nav-link">
  Awesome
</a></li><li class="dropdown-subitem"><a href="/blog/BE/node/docs/" class="nav-link">
  Docs
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/DB/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/oracle/" class="nav-link">
  Oracle
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/blog/DB/mongodb/" class="nav-link">
  Mongodb
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="部署" class="dropdown-title"><span class="title">部署</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/deploy/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/shell/1.start.html" class="nav-link">
  Shell
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/CI-CD/1.start.html" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/blog/deploy/jenkins/1.start.html" class="nav-link">
  Jenkins
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/tool/github/" class="nav-link">
  GitHub
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/charles/" class="nav-link">
  Charles
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/verdaccio/" class="nav-link">
  Verdaccio
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/remote-ssh/" class="nav-link">
  Remote-SSH
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/localtunnel/" class="nav-link">
  Localtunnel
</a></li><li class="dropdown-item"><!----> <a href="/blog/tool/AI/" class="nav-link">
  AI工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/oneyoung19" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/FE/html5/" aria-current="page" class="sidebar-link">HTML5</a></li><li><a href="/blog/FE/html5/1.semantic.html" class="sidebar-link">1.语义化</a></li><li><a href="/blog/FE/html5/2.connectivity.html" class="sidebar-link">2.连通性</a></li><li><a href="/blog/FE/html5/3.storage.html" class="sidebar-link">3.离线 &amp; 存储</a></li><li><a href="/blog/FE/html5/4.media.html" class="sidebar-link">4.多媒体</a></li><li><a href="/blog/FE/html5/5.graphic.html" aria-current="page" class="active sidebar-link">5.2D/3D绘图</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_5-1-canvas" class="sidebar-link">5-1.canvas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_1-介绍" class="sidebar-link">1.介绍</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_2-绘图面积与元素面积" class="sidebar-link">2.绘图面积与元素面积</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_3-获取2d上下文" class="sidebar-link">3.获取2D上下文</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_3-描边与填充" class="sidebar-link">3.描边与填充</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_4-绘制线条line" class="sidebar-link">4.绘制线条line</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_5-绘制矩形rect" class="sidebar-link">5.绘制矩形rect</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_6-绘制圆弧arc" class="sidebar-link">6.绘制圆弧arc</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_7-绘制文本text" class="sidebar-link">7.绘制文本text</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_8-绘制图片image" class="sidebar-link">8.绘制图片image</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_9-绘制视频video" class="sidebar-link">9.绘制视频video</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_10-颜色渐变" class="sidebar-link">10.颜色渐变</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_11-save和restore" class="sidebar-link">11.save和restore</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_12-转换transform" class="sidebar-link">12.转换transform</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_13-贝塞尔曲线" class="sidebar-link">13.贝塞尔曲线</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#附录1-签字板" class="sidebar-link">附录1.签字板</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#附录2-时钟" class="sidebar-link">附录2.时钟</a></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#附录3-弹幕" class="sidebar-link">附录3.弹幕</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/FE/html5/5.graphic.html#_5-2-webgl" class="sidebar-link">5-2.WebGL</a></li></ul></li><li><a href="/blog/FE/html5/6.integration.html" class="sidebar-link">6.性能 &amp; 集成</a></li><li><a href="/blog/FE/html5/7.device.html" class="sidebar-link">7.设备访问</a></li><li><a href="/blog/FE/html5/8.design.html" class="sidebar-link">8.样式设计</a></li><li><a href="/blog/FE/html5/html-email.html" class="sidebar-link">HTML Email总结</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p><code>HTML5</code> 引入了 <code>Canvas</code> 和 <code>WebGL</code>，使得在浏览器中绘制 <code>2D</code> 和 <code>3D</code> 图形成为可能，提供了更丰富的视觉效果和交互性。</p> <h2 id="_5-1-canvas"><a href="#_5-1-canvas" class="header-anchor">#</a> 5-1.canvas</h2> <h3 id="_1-介绍"><a href="#_1-介绍" class="header-anchor">#</a> 1.介绍</h3> <p><code>canvas</code>可用于绘制 <code>2D</code> 图像。它在文档流中是行内块元素。可以通过 <code>css</code> 设置 <code>width</code> 和 <code>height</code>。</p> <p><code>HTMLCanvasElement</code> 本身也有 <code>width</code> 和 <code>height</code> 属性。</p> <p>我们通常会直接设置，不设置的话，<code>&lt;canvas&gt;</code>默认<code>width</code>为<code>300px</code>,<code>height</code>为<code>150px</code>。</p> <p>譬如下面这个没有设置宽和高的 <code>&lt;canvas&gt;</code>：</p> <p><canvas style="background:skyblue;"></canvas> <span>这是一个背景色为skyblue的canvas</span></p> <h3 id="_2-绘图面积与元素面积"><a href="#_2-绘图面积与元素面积" class="header-anchor">#</a> 2.绘图面积与元素面积</h3> <p>我们知道设置 <code>canvas</code> 大小的方式有两种：</p> <ol><li>直接设置 <code>&lt;canvas&gt;</code> 标签的 <code>width</code> 和 <code>height</code>,即 <code>element-properties</code>。</li> <li>通过 <code>css</code> 来设置 <code>&lt;canvas&gt;</code> 的 <code>width</code> 和 <code>height</code>，即 <code>css-properties</code>。</li></ol> <p>但是这两种方式影响 <code>&lt;canvas&gt;</code> 的方式是不同的。它们分别影响的是<strong>绘图面积</strong>和<strong>元素面积</strong>。(至少我是这么理解的😂)。</p> <p>下面通过在 <code>600 ✖️ 300</code> 的画布上绘制一个 <code>300 ✖️ 150</code> 的矩形，分成3种情况来分析：</p> <h4 id="_2-1-只设置element-properties"><a href="#_2-1-只设置element-properties" class="header-anchor">#</a> 2-1.只设置<code>element-properties</code></h4> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-2-1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-2-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'skyblue'</span>
  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>绘制出来的矩形大小确实是 <code>300 ✖️ 150</code>。这种形式的绘图也是我们平常使用的最多的。</p> <p><canvas id="canvas-2-1" width="600" height="300" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-2-1')
var ctx = canvas.getContext('2d')
ctx.rect(0, 0, 300, 150)
ctx.fillStyle = 'skyblue'
ctx.fill()
</script></p> <h4 id="_2-2-只设置css-properties"><a href="#_2-2-只设置css-properties" class="header-anchor">#</a> 2-2.只设置<code>css-properties</code></h4> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-2-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 600px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-2-2'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'skyblue'</span>
  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>当使用 <code>css</code> 来设置 <code>width</code> 和 <code>height</code> 后，会发现 <code>300 ✖️ 150</code> 的矩形被绘制成了 <code>600 ✖️ 300</code>。</p> <p>这是因为虽然没有设置 <code>element-properties</code>，但是这时 <code>canvas</code> 默认的绘图面积就是 <code>300 * 150</code>。</p> <p>它会先以这种设置来绘制，然后将 <code>canvas</code> 填充到元素面积为 <code>600 ✖️ 300</code> 的元素中。</p> <p><canvas id="canvas-2-2" style="width:600px;height:300px;border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-2-2')
var ctx = canvas.getContext('2d')
ctx.rect(0, 0, 300, 150)
ctx.fillStyle = 'skyblue'
ctx.fill()
</script></p> <h4 id="_2-3-同时设置element-properties和css-properties"><a href="#_2-3-同时设置element-properties和css-properties" class="header-anchor">#</a> 2-3.同时设置<code>element-properties</code>和<code>css-properties</code></h4> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-2-3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 150px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-2-3'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'skyblue'</span>
  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>将绘图面积设置成 <code>1200 ✖️ 600</code>，元素面积设置成 <code>600 ✖️ 300</code>。同样绘制一个 <code>300 ✖️ 150</code> 的矩形，实际上会绘制 <code>150 ✖️ 75</code>。具体结果如下：</p> <p><canvas id="canvas-2-3" width="1200" height="600" style="width:600px;height:300px;border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-2-3')
var ctx = canvas.getContext('2d')
ctx.rect(0, 0, 300, 150)
ctx.fillStyle = 'skyblue'
ctx.fill()
</script></p> <p><strong>在 <code>ios</code> 上，利用 <code>canvas</code> 绘制图片时，由于其高倍屏，可能会出现图片模糊的问题，这时就可以采用这种解决方式，来绘制2倍图甚至多倍图。</strong></p> <h4 id="_2-4-总结"><a href="#_2-4-总结" class="header-anchor">#</a> 2-4.总结</h4> <p><strong>其实绘图面积与元素面积的比例不止会影响图形的大小，也会影响图形的坐标位置</strong>。</p> <p>假设绘图面积为 <code>draw</code>，元素面积为 <code>ele</code>，要绘制的图形的宽度为 <code>width</code>, 实际绘制的图形的宽度为 <code>w</code>。(高度、<code>x</code> 坐标、<code>y</code> 坐标同理)那么比例关系如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>w = width * (ele / draw)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>因此为了保证绘制正确，通常还要结合 <code>ctx.scale(scaleX, scaleY)</code> 来设置画布缩放。</p> <h3 id="_3-获取2d上下文"><a href="#_3-获取2d上下文" class="header-anchor">#</a> 3.获取2D上下文</h3> <p><code>HTMLCanvasElement</code> 具有一个 <code>getContext</code> 方法。我们可以通过它来获取目标 <code>canvas</code> 的 <code>2d</code> 上下文，进而绘制图形。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-3'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>而且同一个 <code>HTMLCanvasElement</code> 调用多次 <code>getContext</code> 方法，返回的对象都是同一个。</p> <h3 id="_3-描边与填充"><a href="#_3-描边与填充" class="header-anchor">#</a> 3.描边与填充</h3> <p><code>canvas</code>绘制图形，分为两种方式：描边（<code>stroke</code>）与填充（<code>fill</code>）。这里先将二者的相关 <code>api</code> 进行分类下：</p> <table><thead><tr><th>type</th> <th style="text-align:center;">描边</th> <th style="text-align:right;">填充</th></tr></thead> <tbody><tr><td></td> <td style="text-align:center;"><code>stroke</code></td> <td style="text-align:right;"><code>fill</code></td></tr> <tr><td>矩形</td> <td style="text-align:center;"><code>strokeRect</code></td> <td style="text-align:right;"><code>fillRect</code></td></tr> <tr><td>文本</td> <td style="text-align:center;"><code>strokeText</code></td> <td style="text-align:right;"><code>fillText</code></td></tr> <tr><td>设置颜色</td> <td style="text-align:center;"><code>strokeStyle</code></td> <td style="text-align:right;"><code>fillStyle</code></td></tr></tbody></table> <h3 id="_4-绘制线条line"><a href="#_4-绘制线条line" class="header-anchor">#</a> 4.绘制线条<code>line</code></h3> <h4 id="_4-1-绘制线条并描边"><a href="#_4-1-绘制线条并描边" class="header-anchor">#</a> 4-1.绘制线条并描边</h4> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-4-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-4'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
  <span class="token comment">// 不要忘记描边 否则图形显示不出来</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><canvas id="canvas-4-1" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-4-1')
var ctx = canvas.getContext('2d')
ctx.moveTo(100, 50)
ctx.lineTo(200, 50)
ctx.stroke()
</script></p> <h4 id="_4-2-线条模糊"><a href="#_4-2-线条模糊" class="header-anchor">#</a> 4-2.线条模糊</h4> <p>上面线条貌似有点模糊。由于 <code>canvas</code> 绘制时，它的 <code>1px</code> 会各占左右 <code>0.5px</code>。产生虚影，看上去就跟模糊了一样。</p> <p>解决办法是将绘制坐标减去 <code>0.5</code> 即可。本例代码是这样：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-4-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-4-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">49.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">49.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><canvas id="canvas-4-2" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-4-2')
var ctx = canvas.getContext('2d')
ctx.moveTo(100, 49.5)
ctx.lineTo(200, 49.5)
ctx.stroke()
</script></p> <p>看起来好多了~</p> <h4 id="_4-3-beginpath"><a href="#_4-3-beginpath" class="header-anchor">#</a> 4-3.<code>beginPath</code></h4> <p>我想要绘制两条线，一条颜色是红色，另一条是蓝色。代码如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-4-3-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-4-3-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">49.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">49.5</span><span class="token punctuation">)</span>
  <span class="token comment">// 设置样式需要在stroke或者fill方法调用之前</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'red'</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">99.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">99.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'blue'</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>然后发现绘制了两条蓝色的线条：</p> <p><canvas id="canvas-4-3-1" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-4-3-1')
var ctx = canvas.getContext('2d')
ctx.moveTo(100, 49.5)
ctx.lineTo(200, 49.5)
ctx.strokeStyle = 'red'
ctx.stroke()
ctx.moveTo(100, 99.5)
ctx.lineTo(200, 99.5)
ctx.strokeStyle = 'blue'
ctx.stroke()
</script></p> <p>之前说过，同一个 <code>canvas</code> 只会有一个 <code>ctx</code>。所以这个 <code>ctx</code> 是共用的，这样就导致绘制线条时，互相之间会有影响。</p> <p>最好解决办法是使用 <code>beginPath</code>。</p> <p>我们推荐<strong>只要是非连续路径绘制，就使用<code>beginPath</code>。</strong></p> <p>改进后的代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-4-3-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-4-3-2'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token comment">// 第一个线条的beginPath</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">49.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">49.5</span><span class="token punctuation">)</span>
  <span class="token comment">// 注意，如果这里没有设置strokeStyle的话，线条也会被影响成蓝色。所以strokeStyle一般考虑与save restore方法联用，以保证画布其他部分不受影响。</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'red'</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 第二个线条的beginPath</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">99.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">99.5</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'blue'</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><canvas id="canvas-4-3-2" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-4-3-2')
var ctx = canvas.getContext('2d')
ctx.beginPath()
ctx.moveTo(100, 49.5)
ctx.lineTo(200, 49.5)
ctx.strokeStyle = 'red'
ctx.stroke()
ctx.beginPath()
ctx.moveTo(100, 99.5)
ctx.lineTo(200, 99.5)
ctx.strokeStyle = 'blue'
ctx.stroke()
</script></p> <h4 id="_4-4-线条设置属性"><a href="#_4-4-线条设置属性" class="header-anchor">#</a> 4-4.线条设置属性</h4> <ul><li><p>宽度 <code>lineWidth</code></p> <p>默认值是1.0(直接绘制图形，会模糊的原因，浏览器将 <code>1px</code> 边缘柔化)。如果是负数、0、<code>NaN</code> 或者 <code>Infinity</code> 都会被忽略。</p></li> <li><p>端点 <code>lineCap</code></p> <p><code>butt</code>: 默认值。<code>round</code>: 线的两端会出现半圆。<code>square</code>:线的两端出现方块。</p></li> <li><p>转角 <code>lineJoin</code></p> <p>英文单词 <code>join</code> 意为 <code>连接</code>。这里也就是指线条的转角位置。</p> <p><code>miter</code>: 默认值，尖头。通常与 <code>miterLimit</code> 联用，对尖头的尖锐程度进行限制。</p> <p><code>round</code>: 圆头。<code>bevel</code>: 平头。</p></li> <li><p>虚线偏移距离 <code>lineDashOffset</code></p> <p>该属性可以设置虚线起始绘制的偏移距离，为浮点型。默认值为 <code>0.0</code>。通常与设置虚线 <code>setLineDash</code> 联用。与其相对的方法是 <code>getLineDash</code>。</p></li></ul> <h4 id="_4-5-closepath"><a href="#_4-5-closepath" class="header-anchor">#</a> 4-5.<code>closePath</code></h4> <p>首先要明确的一点是，<strong><code>closePath</code> 与 <code>beginPath</code> 并不是相对的。</strong></p> <p>以绘制三角形为例来了解下 <code>closePath</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-4-5<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-4-5'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token comment">// 在同一个path中，可以使用lineTo多次连续绘制线条</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 在closePath后，需要再调用stroke方法</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><canvas id="canvas-4-5" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-4-5')
var ctx = canvas.getContext('2d')
ctx.beginPath()
ctx.moveTo(10, 10)
ctx.lineTo(100, 10)
ctx.lineTo(100, 60)
ctx.stroke()
ctx.beginPath()
ctx.moveTo(120, 10)
ctx.lineTo(210, 10)
ctx.lineTo(210, 60)
ctx.closePath()
ctx.stroke()
</script></p> <p>利用 <code>beginPath</code> 来区分路径 否则路径之间会互相影响。</p> <p>而 <strong><code>closePath</code> 会将最近一次的 <code>moveTo</code> 与最后一次的 <code>lineTo</code> 坐标连接起来。</strong></p> <h3 id="_5-绘制矩形rect"><a href="#_5-绘制矩形rect" class="header-anchor">#</a> 5.绘制矩形<code>rect</code></h3> <p>矩形只是线条形式的一种变形。正如 <strong><code>strokeRect</code> 只是 <code>stroke</code> 方法的一种变形</strong>。</p> <p>绘制矩形的方法有两种：<code>strokeRect(x, y, width, height)</code> 与 <code>fillRect(x, y, width, height)</code>。不再赘述。</p> <p>值得记住的是 <code>clearRect(x, y, width, height)</code>，它是清除画布的神技。</p> <h3 id="_6-绘制圆弧arc"><a href="#_6-绘制圆弧arc" class="header-anchor">#</a> 6.绘制圆弧<code>arc</code></h3> <p><code>arc</code> 绘制的是<strong>圆弧路径</strong>。在绘制完后需要调用<code>stroke</code>，同样<strong>适用于<code>beginPath</code>方法。</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-6<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-6'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token comment">// ctx.arc(x, y, r, startAngle, endAngle, anticlockwise)  anticlockwis默认是false 顺时针</span>
  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><canvas id="canvas-6" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-6')
var ctx = canvas.getContext('2d')
ctx.arc(150, 75, 30, 0, Math.PI * 2)
ctx.stroke()
</script></p> <h3 id="_7-绘制文本text"><a href="#_7-绘制文本text" class="header-anchor">#</a> 7.绘制文本text</h3> <ul><li><code>strokeText</code> 描边文本</li> <li><code>fillText</code> 填充文本</li> <li><code>font</code> 设置文本字体。默认值为 <code>10px sans-serif</code>。</li> <li><code>textAlign</code> 文本<strong>水平</strong>对齐方式。五个值：<code>left</code> <code>right</code> <code>center</code> <code>start</code> <code>end</code>。</li> <li><code>textBaseline</code> 文本<strong>垂直</strong>对齐方式。六个值：<code>alphabetic</code>(默认) <code>top</code> <code>middle</code> <code>bottom</code> <code>hanging</code> <code>ideographic</code>。</li> <li><code>measureText</code> 可以用来获取<strong>文本相关信息</strong>。譬如宽度等。</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-7<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-7'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 在(150, 75)处绘制文字</span>
  ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">'bold 30px SimSun, Songti SC'</span>
  ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'red'</span>
  ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">'right'</span>
  ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">'bottom'</span>
  ctx<span class="token punctuation">.</span><span class="token function">strokeText</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>
  <span class="token comment">// save以栈的形式将绘图状态予以保存 restore将save的状态依次取出 </span>
  ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'blue'</span>
  ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">'left'</span>
  ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">'top'</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">'你好'</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><canvas id="canvas-7" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-7')
var ctx = canvas.getContext('2d')
ctx.beginPath()
ctx.moveTo(0, 75)
ctx.lineTo(300, 75)
ctx.stroke()
ctx.beginPath()
ctx.moveTo(150, 0)
ctx.lineTo(150, 150)
ctx.stroke()
// 在(150, 75)处绘制文字
ctx.font = 'bold 30px SimSun, Songti SC'
ctx.save()
ctx.strokeStyle = 'red'
ctx.textAlign = 'right'
ctx.textBaseline = 'bottom'
ctx.strokeText('hello world', 150, 75)
// save以栈的形式将绘图状态予以保存 restore将save的状态依次取出
ctx.restore()
ctx.fillStyle = 'blue'
ctx.textAlign = 'left'
ctx.textBaseline = 'top'
ctx.fillText('你好', 150, 75)
</script></p> <h3 id="_8-绘制图片image"><a href="#_8-绘制图片image" class="header-anchor">#</a> 8.绘制图片image</h3> <ul><li><p>绘制图片</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-8-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-8-1'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
    <span class="token comment">// 在这里 获取图片元素有两种方式</span>
    <span class="token comment">// ① 在页面上增加一个隐藏的img标签，引入src。然后通过DOM获取到该img元素。但是这种方式显然不是很好，因为无缘无故增加了新的DOM节点。</span>
    <span class="token comment">// ② 利用Image构造函数 创造一个图片实例出来。推荐这种方式。</span>
    <span class="token keyword">var</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    image<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'./images/sasuke.jpeg'</span>
    <span class="token comment">// 图片加载是异步的 所以必须利用onload监听 加载完成后再drawImage</span>
    image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//!!! 该例因为HTML没有commonJS或者Es module, 而且vuepress打包不了以上面的形式的引入的图片，除非经过file-loader或者url-loader。所以图片加载不了。这里就先不展示效果了。</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>绘制图片的时候，也可以只绘制图片的一部分。因为用的情况不多，暂不赘述。</p></li> <li><p>将 <code>canvas</code> 转化为图片</p> <p>这部分和绘制图片的主题有点关系。所以把它也整理在此处。</p> <p>首先要说明的是，将 <code>canvas</code> 转化为图片的能力是属于 <code>HTMLCanvasElement</code> 的。而不是总在使用的2d上下文 <code>ctx</code>。</p> <p>具体方法有两种：<code>toDataURL</code>与 <code>toBlob</code>。分别会将 <code>canvas</code> 转为 <code>dataURL</code> 与 <code>blob</code> 两种形式的资源。</p></li></ul> <p><img id="img-dataURL-Blob"><br> <canvas id="canvas-toDataURL" style="border:1px solid #ccc;"></canvas> <button id="btn-toDataURL">toDataURL</button><br> <canvas id="canvas-toBlob" style="border:1px solid #ccc;"></canvas> <button id="btn-toBlob">toBlob</button> <script>
// 先绘制好canvas
var dataURLCanvas = document.querySelector('#canvas-toDataURL')
var blobCanvas = document.querySelector('#canvas-toBlob')
var dataURLCtx = dataURLCanvas.getContext('2d')
var blobCtx = blobCanvas.getContext('2d')
dataURLCtx.font = 'bold 40px SimSun, Songti SC'
dataURLCtx.strokeText('toDataURL', 0, 50)
blobCtx.font = 'bold 40px SimSun, Songti SC'
blobCtx.fillText('toBlob', 0, 50)
// 获取到目标元素
var target = document.querySelector('#img-dataURL-Blob')
// btn-toDataURL
var dataURLBtn = document.querySelector('#btn-toDataURL')
dataURLBtn.onclick = function () {
var dataURL = dataURLCanvas.toDataURL()
target.src = dataURL
}
// btn-toBlob
var blobBtn = document.querySelector('#btn-toBlob')
blobBtn.onclick = function () {
blobCanvas.toBlob(function (blob) {
// 将blob转化为blobURL
var blobURL = URL.createObjectURL(blob)
target.src = blobURL
}, 'image/png')
}
</script></p> <p>上述效果的核心代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token comment">// 获取到目标元素</span>
  <span class="token keyword">var</span> target <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#img-dataURL-Blob'</span><span class="token punctuation">)</span>
  <span class="token comment">// btn-toDataURL</span>
  <span class="token keyword">var</span> dataURLBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#btn-toDataURL'</span><span class="token punctuation">)</span>
  dataURLBtn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> dataURL <span class="token operator">=</span> dataURLCanvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    target<span class="token punctuation">.</span>src <span class="token operator">=</span> dataURL
  <span class="token punctuation">}</span>
  <span class="token comment">// btn-toBlob</span>
  <span class="token keyword">var</span> blobBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#btn-toBlob'</span><span class="token punctuation">)</span>
  blobBtn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    blobCanvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 将blob转化为blobURL</span>
      <span class="token keyword">var</span> blobURL <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
      target<span class="token punctuation">.</span>src <span class="token operator">=</span> blobURL
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'image/png'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><code>canvas</code> 跨域问题：
如果使用 <code>drawImage</code> 方法在 <code>canvas</code> 上绘制了跨域的图片，这时直接将 <code>canvas</code> 使用 <code>toDataURL</code> 或者 <code>toBlob</code> 转化时，<code>chrome</code> 浏览器控制台会认为该 <code>canvas</code> 是被污染的画布，报如下错误：</p> <p><img src="https://raw.githubusercontent.com/oneyoung19/vuepress-blog-img/main/img/007S8ZIlly1ggfwkr9aldj31cs07i75q.jpg" alt=""></p> <p>解决办法需要满足两个条件：</p> <p>①跨域图片设置了 <code>Access-Control-Allow-Origin</code>，允许当前域。</p> <p>②定义 <code>img</code> 标签或者 <code>Image</code> 实例的 <code>crossOrigin</code> 属性为 <code>true</code>。</p> <p>例子如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-8-cross-origin<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-8-cross-origin'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 引入了豆瓣的一张图片，该图片已经设置`Access-Control-Allow-Origin`为*。但随时可能失效。</span>
  image<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'https://img9.doubanio.com/view/dale-online/dale_ad/public/65236355cf022f6.jpg'</span>
  <span class="token comment">// 设置crossOrigin为true</span>
  image<span class="token punctuation">.</span>crossOrigin <span class="token operator">=</span> <span class="token boolean">true</span>
  image<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#btn'</span><span class="token punctuation">)</span>
  <span class="token comment">// 点击按钮，控制台可以打印出dataURL和blob</span>
  btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> dataURL <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataURL<span class="token punctuation">)</span>
    canvas<span class="token punctuation">.</span><span class="token function">toBlob</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">blob</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><canvas id="canvas-8-cross-origin" style="border:1px solid #ccc;"></canvas> <button id="btn">click</button> <script>
var canvas = document.querySelector('#canvas-8-cross-origin')
var ctx = canvas.getContext('2d')
var image = new Image()
image.src = 'https://img9.doubanio.com/view/dale-online/dale_ad/public/65236355cf022f6.jpg'
image.crossOrigin = true
image.onload = function () {
ctx.drawImage(image, 0, 0, 280, 140)
}
var btn = document.querySelector('#btn')
btn.onclick = function () {
var dataURL = canvas.toDataURL()
console.log(dataURL)
canvas.toBlob(function (blob) {
console.log(blob)
})
}
</script></p> <h3 id="_9-绘制视频video"><a href="#_9-绘制视频video" class="header-anchor">#</a> 9.绘制视频video</h3> <p>有两个额外的 <code>api</code>，它们是 <code>getImageData</code> 和<code>putImageData</code>。</p> <p><strong>它们可以操作画布上某一区域上的像素点，不单单只是有像素变色这种操作，它还能实现对画布的裁剪以及转换等高级操作。</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>video-9<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./video/402620458.mp4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">controls</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 150px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-9-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> video <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#video-9'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> myCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-9-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> myCtx <span class="token operator">=</span> myCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  video<span class="token punctuation">.</span><span class="token function-variable function">onplay</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>draw<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">draw</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    myCtx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>video<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
    <span class="token comment">// getImageData与putImageData 结合使用可以操作视频的每一帧的像素</span>
    <span class="token keyword">var</span> frame <span class="token operator">=</span> myCtx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
    <span class="token comment">// vuepress总是报分号错误 下面代码暂时不加了</span>
    <span class="token comment">// var data = frame.data</span>
    <span class="token comment">// for (let i = 0; i &lt; data.length; i += 4) {</span>
  	<span class="token comment">// 	var avg = (data[i] + data[i + 1] + data[i + 2]) / 3</span>
		<span class="token comment">// 	data[i] = avg</span>
		<span class="token comment">// 	data[i + 1] = avg</span>
		<span class="token comment">// 	data[i + 2] = avg</span>
		<span class="token comment">// }</span>
    myCtx<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>draw<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><video id="video-9" src="/blog/assets/media/402620458.986f66f7.mp4" controls="controls" style="width:300px;height:150px;"></video> <canvas id="canvas-9-1"></canvas> <script>
var video = document.querySelector('#video-9')
var myCanvas = document.querySelector('#canvas-9-1')
var myCtx = myCanvas.getContext('2d')
video.onplay = function () {
window.requestAnimationFrame(draw)
}
function draw () {
myCtx.drawImage(video, 15, 0, 270, 150)
// getImageData与putImageData 结合使用可以操作视频的每一帧的像素
var frame = myCtx.getImageData(15, 0, 270, 150)
// var data = frame.data
// for (let i = 0; i &amp;lt; data.length; i += 4) {
// 	var avg = (data[i] + data[i + 1] + data[i + 2]) / 3
// 	data[i] = avg
// 	data[i + 1] = avg
// 	data[i + 2] = avg
// }
myCtx.putImageData(frame, 15, 0)
window.requestAnimationFrame(draw)
}
</script></p> <p>在这里推荐一篇有趣的博文：<a href="https://juejin.im/post/5ba06596f265da0acc7957e4" target="_blank" rel="noopener noreferrer">用 canvas 的 getImageData 做点有趣的事<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>另外，我测试发现，<strong><code>getImageData</code> 与 <code>putImageData</code> 方法都不会受到 <code>canvas</code> 的 <code>transform</code> 方法的影响</strong>。</p> <p>它俩针对的始终是 <code>canvas</code> 画布本身的实在坐标。具体细节见下例：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-9-3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-9-4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-9-3'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> canvas2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-9-4'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx1 <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx2 <span class="token operator">=</span> canvas2<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token comment">// 绘制一个矩形 然后获取其像素 再将其绘制到另一个区域</span>
  ctx1<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'red'</span>
  ctx1<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> imageData1 <span class="token operator">=</span> ctx1<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
  ctx1<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imageData1<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span>

  ctx2<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'green'</span>
  ctx2<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'blue'</span>
  ctx2<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> imageData2 <span class="token operator">=</span> ctx2<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imageData2<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">240</span><span class="token punctuation">)</span>
  <span class="token comment">// 测试发现 getImageData与putImageData方法都不会受到canvas的transform的影响。它俩针对的就是canvas画布本身实实在在的坐标。</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><canvas id="canvas-9-3" width="600" height="300" style="border:1px solid #ccc;"></canvas> <canvas id="canvas-9-4" width="600" height="300" style="border:1px solid #ccc;"></canvas> <script>
var canvas1 = document.querySelector('#canvas-9-3')
var canvas2 = document.querySelector('#canvas-9-4')
var ctx1 = canvas1.getContext('2d')
var ctx2 = canvas2.getContext('2d')
// 绘制一个矩形 然后获取其像素 再将其绘制到另一个区域
ctx1.fillStyle = 'red'
ctx1.fillRect(20, 20, 80, 40)
var imageData1 = ctx1.getImageData(20, 20, 80, 40)
ctx1.putImageData(imageData1, 500, 240)
ctx2.fillStyle = 'green'
ctx2.translate(20, 20)
ctx2.fillRect(0, 0, 120, 80)
ctx2.fillStyle = 'blue'
ctx2.fillRect(20, 20, 80, 40)
var imageData2 = ctx2.getImageData(20, 20, 80, 40)
ctx2.putImageData(imageData2, 500, 240)
// 测试发现 getImageData与putImageData方法都不会受到canvas的transform的影响。它俩针对的就是canvas画布本身实实在在的坐标。
</script></p> <h3 id="_10-颜色渐变"><a href="#_10-颜色渐变" class="header-anchor">#</a> 10.颜色渐变</h3> <p>颜色渐变分为两种：</p> <ul><li><p>线性渐变 <code>createLinearGradient</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-linear<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-linear'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
    <span class="token comment">// 创建线性渐变</span>
    <span class="token keyword">var</span> linearGradient <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span>
    linearGradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'#d53369'</span><span class="token punctuation">)</span>
    linearGradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'#cbad6d'</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> linearGradient
    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><canvas id="canvas-linear" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-linear')
var ctx = canvas.getContext('2d')
// 创建线性渐变
var linearGradient = ctx.createLinearGradient(20, 20, 260, 110)
linearGradient.addColorStop(0, '#d53369')
linearGradient.addColorStop(1, '#cbad6d')
ctx.fillStyle = linearGradient
ctx.fillRect(20, 20, 260, 110)
</script></p></li> <li><p>径向渐变 <code>createRadialGradient</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-radial<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-radial'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
    <span class="token comment">// 创建线性渐变</span>
    <span class="token keyword">var</span> radialGradient <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createRadialGradient</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">)</span>
    radialGradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'#d53369'</span><span class="token punctuation">)</span>
    radialGradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'#cbad6d'</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> radialGradient
    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><canvas id="canvas-radial" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-radial')
var ctx = canvas.getContext('2d')
// 创建线性渐变
var radialGradient = ctx.createRadialGradient(150, 75, 0, 150, 75, 75)
radialGradient.addColorStop(0, '#d53369')
radialGradient.addColorStop(1, '#cbad6d')
ctx.fillStyle = radialGradient
ctx.fillRect(75, 0, 150, 150)
</script></p></li></ul> <h3 id="_11-save和restore"><a href="#_11-save和restore" class="header-anchor">#</a> 11.<code>save</code>和<code>restore</code></h3> <p><code>save()</code> 方法会以栈的形式来保存画布的绘制状态。具体状态包括：</p> <ul><li>矩阵变换。<code>translate()</code> <code>rotate()</code> <code>scale()</code> <code>transform()</code> 等。</li> <li>剪裁区域。<code>clip()</code></li> <li>虚线设置。<code>setLineDash()</code></li> <li>以及一些属性。<code>strokeStyle</code> <code>fillStyle</code> <code>globalAlpha</code> <code>lineWidth</code> <code>lineCap</code> <code>lineJoin</code> <code>miterLimit</code> <code>lineDashOffeset</code> <code>shadowOffsetX</code> <code>shadowOffsetY</code> <code>shadowBlur</code> <code>shadowColor</code> <code>globalCompositionOperation</code> <code>font</code> <code>textAlign</code> <code>textBaseLine</code>。</li></ul> <p><code>restore()</code> 方法会从栈中依次取出保存的状态，如果没有栈中没有存储的状态，执行该方法后，不会产生任何变化。</p> <p>这二者的具体使用时机是在我们改变绘制状态时。可以先调用 <code>save()</code> 保存一下之前的状态，然后书写我们的绘制状态，在结束后，再调用 <code>restore()</code> 方法来将画布重置到之前保存的状态。</p> <p>下例的核心代码，都是绘制一个平移加旋转的矩形，对比看下有无 <code>save</code> 及 <code>restore</code> 的区别：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-11-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-11-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-11-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> canvas2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-11-2'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx1 <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx2 <span class="token operator">=</span> canvas2<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx1<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
  ctx1<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  ctx1<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>

  ctx2<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 毫无疑问 第二个图形的矩形不会发生旋转</span>
  ctx2<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><canvas id="canvas-11-1" style="border:1px solid #ccc;"></canvas> <canvas id="canvas-11-2" style="border:1px solid #ccc;"></canvas> <script>
var canvas1 = document.querySelector('#canvas-11-1')
var canvas2 = document.querySelector('#canvas-11-2')
var ctx1 = canvas1.getContext('2d')
var ctx2 = canvas2.getContext('2d')
ctx1.rotate(-Math.PI / 2)
ctx1.translate(-50, 0)
ctx1.fillRect(0, 0, 40, 80)
ctx2.save()
ctx2.rotate(-Math.PI / 2)
ctx2.restore()
ctx2.translate(0, 50)
ctx2.fillRect(0, 0, 40, 80)
</script></p> <h3 id="_12-转换transform"><a href="#_12-转换transform" class="header-anchor">#</a> 12.转换transform</h3> <p><code>canvas</code> 中的转换与 <code>css</code> 中的转换有些区别。</p> <p><code>css</code> 的转换影响元素，而 <strong><code>canvas</code>的转换通过影响到坐标系，间接影响元素</strong>。</p> <p>总之一点，<strong>在<code>canvas</code>上使用转换后，尤其是<code>rotate</code>，要改变视角来看待整个坐标系。</strong></p> <p><code>canvas</code>的坐标系原点默认是在<strong>左上角</strong>。从左至右是x轴，从上至下是y轴。<strong>转换只会影响坐标系，不会改变画布本身的大小和位置。</strong></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>另外，例如像 <code>fillRect</code>、<code>drawImage</code> 这些 <code>api</code> 中的一些参数我通常认作 <code>width</code> 和 <code>height</code>，但这是不准确的一种认知。</p> <p><strong>应该将其当做在对应的x轴和y轴上面的长度。</strong></p></div> <h4 id="_12-1-translate"><a href="#_12-1-translate" class="header-anchor">#</a> 12-1.<code>translate</code></h4> <p>将y轴向下平移 <code>30px</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-1-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span> <span class="token property">border-left</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-1-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span> <span class="token property">border-left</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-1-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> canvas2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-1-2'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx1 <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx2 <span class="token operator">=</span> canvas2<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx1<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><canvas id="canvas-12-1-1" style="border-top:1px solid #ccc;border-left:1px solid #ccc;"></canvas> <canvas id="canvas-12-1-2" style="border-top:1px solid #ccc;border-left:1px solid #ccc;"></canvas> <script>
var canvas1 = document.querySelector('#canvas-12-1-1')
var canvas2 = document.querySelector('#canvas-12-1-2')
var ctx1 = canvas1.getContext('2d')
var ctx2 = canvas2.getContext('2d')
ctx1.fillRect(0, 0, 200, 100)
ctx2.translate(0, 30)
ctx2.fillRect(0, 0, 200, 100)
</script></p> <h4 id="_12-2-rotate"><a href="#_12-2-rotate" class="header-anchor">#</a> 12-2.<code>rotate</code></h4> <p><code>rotate</code> 与 <code>css</code> 中的 <code>rotate</code> 不同。</p> <p><code>css</code> 的 <code>rotate</code> 针对的是角度 <code>deg</code>，而 <code>canvas</code> 的 <code>rotate</code> 针对的数学角度的 <code>Math.PI</code>。下例将坐标系逆时针旋转<code>π / 2</code>：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-2-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span> <span class="token property">border-left</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-2-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span> <span class="token property">border-left</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>img-12-2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./images/avatar.jpeg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">// 由于引入图片 图片加载需要时间 所以等DOM加载完 再去drawImage 否则会失效</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> canvas1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-2-1'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> canvas2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-2-2'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> ctx1 <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> ctx2 <span class="token operator">=</span> canvas2<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#img-12-2'</span><span class="token punctuation">)</span>
    ctx1<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token comment">// 将坐标原点改为左下角</span>
    ctx2<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
    ctx2<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment">// 正如之前说的，这里的100指的是在对应x轴上的长度 而不是横轴长度。</span>
    ctx2<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><canvas id="canvas-12-2-1" style="border-top:1px solid #ccc;border-left:1px solid #ccc;"></canvas> <canvas id="canvas-12-2-2" style="border-bottom:1px solid #ccc;border-left:1px solid #ccc;"></canvas> <img id="img-12-2" src="/blog/assets/img/avatar.551d6e9b.jpeg" alt="avatar" style="display:none;"> <script>
window.addEventListener('load', function () {
var canvas1 = document.querySelector('#canvas-12-2-1')
var canvas2 = document.querySelector('#canvas-12-2-2')
var ctx1 = canvas1.getContext('2d')
var ctx2 = canvas2.getContext('2d')
var img = document.querySelector('#img-12-2')
ctx1.drawImage(img, 0, 0, 200, 100)
// 将坐标原点改为左下角
ctx2.translate(0, 150)
ctx2.rotate(-Math.PI / 2)
ctx2.drawImage(img, 0, 0, 100, 200)
})
</script></p> <h4 id="_12-3-scale"><a href="#_12-3-scale" class="header-anchor">#</a> 12-3.<code>scale</code></h4> <p><code>scale</code> 会成比例的改变元素在 <code>x轴</code>、<code>y轴</code> 的值，<strong>无论是坐标还是长度</strong>。如下面的例子，不仅是圆心的坐标改变，圆半径也成比例的改变了。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-3-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span> <span class="token property">border-left</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-3-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border-top</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span> <span class="token property">border-left</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-3-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> canvas2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-3-2'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx1 <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx2 <span class="token operator">=</span> canvas2<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token comment">// arc只是路径 必须stroke</span>
  ctx1<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  ctx1<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  ctx2<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><canvas id="canvas-12-3-1" style="border-top:1px solid #ccc;border-left:1px solid #ccc;"></canvas> <canvas id="canvas-12-3-2" style="border-top:1px solid #ccc;border-left:1px solid #ccc;"></canvas> <script>
var canvas1 = document.querySelector('#canvas-12-3-1')
var canvas2 = document.querySelector('#canvas-12-3-2')
var ctx1 = canvas1.getContext('2d')
var ctx2 = canvas2.getContext('2d')
// arc只是路径 必须stroke
ctx1.arc(50, 35, 30, 0, Math.PI * 2)
ctx1.stroke()
ctx2.scale(2, 2)
ctx2.arc(50, 35, 30, 0, Math.PI * 2)
ctx2.stroke()
</script></p> <h4 id="_12-4-transform"><a href="#_12-4-transform" class="header-anchor">#</a> 12-4.<code>transform</code></h4> <p>这部分主要是 <code>transform</code> 与 <code>setTransform</code> 的区别，关于 <code>matrix</code> 矩阵变换的内容暂时没有时间去验证。推荐张鑫旭的<a href="https://www.zhangxinxu.com/wordpress/2012/06/css3-transform-matrix-%e7%9f%a9%e9%98%b5/" target="_blank" rel="noopener noreferrer">矩阵博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <p>二者的区别总结成一句话：<strong><code>transform</code> 的转换是累计的，而 <code>setTransform</code> 会清除以前的转换效果后再进行转换</strong></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-4-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-12-4-2<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> transformCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-4-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> setTransformCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-12-4-2'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> transformCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> setCtx <span class="token operator">=</span> setTransformCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token comment">// transform</span>
  ctx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// x轴 y轴放大两倍</span>
  ctx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// x轴 y轴各平移20px 这里的1分别对应x轴和y轴的缩放</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
  <span class="token comment">// setTransform</span>
  setCtx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  setCtx<span class="token punctuation">.</span><span class="token function">setTransform</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
  setCtx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><canvas id="canvas-12-4-1" style="border:1px solid #ccc;"></canvas> <canvas id="canvas-12-4-2" style="border:1px solid #ccc;"></canvas> <script>
var transformCanvas = document.querySelector('#canvas-12-4-1')
var setTransformCanvas = document.querySelector('#canvas-12-4-2')
var ctx = transformCanvas.getContext('2d')
var setCtx = setTransformCanvas.getContext('2d')
// transform
ctx.transform(2, 0, 0, 2, 0, 0) // x轴 y轴放大两倍
ctx.transform(1, 0, 0, 1, 20, 20) // x轴 y轴各平移20px 这里的1分别对应x轴和y轴的缩放
ctx.fillRect(0, 0, 60, 30)
// setTransform
setCtx.transform(2, 0, 0, 2, 0, 0)
setCtx.setTransform(1, 0, 0, 1, 20, 20)
setCtx.fillRect(0, 0, 60, 30)
</script></p> <h3 id="_13-贝塞尔曲线"><a href="#_13-贝塞尔曲线" class="header-anchor">#</a> 13.贝塞尔曲线</h3> <p>贝塞尔曲线可分为二阶贝塞尔曲线、三阶贝塞尔曲线乃至n阶贝塞尔曲线。<strong>其对应的控制点数量为阶数减一。</strong> 也就是说二阶贝塞尔曲线有一个控制点，三阶贝塞曲线有两个控制点。要注意的一点是，<code>canvas</code> 中关于贝塞尔曲线的方法 <code>quadraticCurveTo()</code> 以及 <code>bezierCurveTo()</code>，<strong>它们绘制的都是路径 <code>path</code>，如果要看见实线，依然需要调用 <code>stroke()</code> 方法。</strong></p> <h4 id="_13-1-二阶贝塞尔曲线"><a href="#_13-1-二阶贝塞尔曲线" class="header-anchor">#</a> 13-1.二阶贝塞尔曲线</h4> <p><code>canvas</code> 中的二阶贝塞尔曲线的对应方法为 <code>quadraticCurveTo(cx, cy, ex, ey)</code>。其中 <code>cx</code> 代表控制点x坐标，<code>cy</code> 代表控制点y坐标，<code>ex</code> 代表结束点x坐标，<code>ey</code> 代表结束点y坐标。</p> <p>下例：起始点坐标为 <code>(0, 0)</code>，控制点坐标随便写了个 <code>(220, 40)</code>，结束点坐标是 <code>(300, 150)</code>。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-13-1<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-13-1'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'blue'</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">quadraticCurveTo</span><span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><canvas id="canvas-13-1" style="border:1px solid #ccc;"></canvas> <script>
var canvas = document.querySelector('#canvas-13-1')
var ctx = canvas.getContext('2d')
ctx.beginPath()
ctx.strokeStyle = 'blue'
ctx.moveTo(0, 0)
ctx.quadraticCurveTo(220, 40, 300, 150)
ctx.stroke()
</script></p> <p>但是问题来了，我们应该怎么得到控制点坐标，从而绘制曲线呢？所以我们需要封装一个方法，从而可以不再介意控制点坐标，以一种更加方便的方式来生成曲线。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * @description: 封装二阶贝塞尔曲线
 * @param {object} ctx
 * @param {object} 起点坐标
 * @param {object} 结束点坐标
 * @param {number} 偏移角度
 * @return: 
 */</span>
<span class="token keyword">function</span> <span class="token function">quadraticCurve</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> degree</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> startX<span class="token punctuation">,</span> y<span class="token operator">:</span> startY <span class="token punctuation">}</span> <span class="token operator">=</span> start
  <span class="token keyword">const</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> endX<span class="token punctuation">,</span> y<span class="token operator">:</span> endY <span class="token punctuation">}</span> <span class="token operator">=</span> end
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx <span class="token operator">||</span> <span class="token operator">!</span>startX <span class="token operator">||</span> <span class="token operator">!</span>startY <span class="token operator">||</span> <span class="token operator">!</span>endX <span class="token operator">||</span> <span class="token operator">!</span>endY <span class="token operator">||</span> <span class="token operator">!</span>degree<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'丢失参数'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 计算中间控制点</span>
  <span class="token keyword">var</span> center <span class="token operator">=</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token punctuation">(</span> startX <span class="token operator">+</span> endX <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span> startY <span class="token operator">-</span> endY <span class="token punctuation">)</span> <span class="token operator">*</span> degree<span class="token punctuation">,</span>
    y<span class="token operator">:</span> <span class="token punctuation">(</span> startY <span class="token operator">+</span> endY <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span> endX <span class="token operator">-</span> startX<span class="token punctuation">)</span> <span class="token operator">*</span> degree
  <span class="token punctuation">}</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>startX<span class="token punctuation">,</span> startY<span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">quadraticCurveTo</span><span class="token punctuation">(</span>center<span class="token punctuation">.</span>x<span class="token punctuation">,</span> center<span class="token punctuation">.</span>y<span class="token punctuation">,</span> endX<span class="token punctuation">,</span> endY<span class="token punctuation">)</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>封装二阶贝塞尔曲线动画</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>canvas-quadratic-animate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>300<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">var</span> animateCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#canvas-quadratic-animate'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> animateCtx <span class="token operator">=</span> animateCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> percent <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    animateCtx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">800</span> <span class="token punctuation">)</span>
    animateCtx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    animateCtx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token string">'4'</span>
    <span class="token function">drawCurve</span><span class="token punctuation">(</span> 
      animateCtx<span class="token punctuation">,</span>
      <span class="token punctuation">[</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token number">0.5</span><span class="token punctuation">,</span>
      percent
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    animateCtx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 可以暂停循环往复</span>
    <span class="token comment">// if (percent &gt;= 99) {</span>
    <span class="token comment">//   return</span>
    <span class="token comment">// }</span>
    percent <span class="token operator">=</span> <span class="token punctuation">(</span> percent <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">100</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span> animate <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">/**
   * @description: 二阶贝塞尔曲线动画
   * @param {type} 
   * @return: 
   */</span>
  <span class="token keyword">function</span> <span class="token function">drawCurve</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">,</span> curveness<span class="token punctuation">,</span> percent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> cp <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">(</span> start<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">+</span> end<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span> start<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">-</span> end<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">*</span> curveness<span class="token punctuation">,</span>
      <span class="token punctuation">(</span> start<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">+</span> end<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token punctuation">(</span> end<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">-</span> start<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">*</span> curveness
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> t <span class="token operator">=</span> percent <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> p0 <span class="token operator">=</span> start<span class="token punctuation">;</span>
    <span class="token keyword">var</span> p1 <span class="token operator">=</span> cp<span class="token punctuation">;</span>
    <span class="token keyword">var</span> p2 <span class="token operator">=</span> end<span class="token punctuation">;</span>
    <span class="token keyword">var</span> v01 <span class="token operator">=</span> <span class="token punctuation">[</span> p1<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">-</span> p0<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> p1<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">-</span> p0<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token comment">// 向量&lt;p0, p1&gt;</span>
    <span class="token keyword">var</span> v12 <span class="token operator">=</span> <span class="token punctuation">[</span> p2<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">-</span> p1<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> p2<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">-</span> p1<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token comment">// 向量&lt;p1, p2&gt;</span>
    <span class="token keyword">var</span> q0 <span class="token operator">=</span> <span class="token punctuation">[</span> p0<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">+</span> v01<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">*</span> t<span class="token punctuation">,</span> p0<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">+</span> v01<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">*</span> t <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> q1 <span class="token operator">=</span> <span class="token punctuation">[</span> p1<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">+</span> v12<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">*</span> t<span class="token punctuation">,</span> p1<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">+</span> v12<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">*</span> t <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> v <span class="token operator">=</span> <span class="token punctuation">[</span> q1<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">-</span> q0<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> q1<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">-</span> q0<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">// 向量&lt;q0, q1&gt;</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span> q0<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">+</span> v<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">*</span> t<span class="token punctuation">,</span> q0<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">+</span> v<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token operator">*</span> t <span class="token punctuation">]</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span> p0<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> p0<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">quadraticCurveTo</span><span class="token punctuation">(</span> 
        q0<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> q0<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        b<span class="token punctuation">[</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span> <span class="token number">1</span> <span class="token punctuation">]</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><p><canvas id="canvas-quadratic-animate" width="600" height="300" style="border:1px solid #ccc;"></canvas> <script>
var animateCanvas = document.querySelector('#canvas-quadratic-animate')
var animateCtx = animateCanvas.getContext('2d')
var percent = 0
function animate() {
animateCtx.clearRect( 0, 0, 800, 800 )
animateCtx.beginPath()
animateCtx.lineWidth = '4'
drawCurve(
animateCtx,
[ 100, 100 ],
[ 200, 300 ],
0.5,
percent
);
animateCtx.stroke()
// 可以使动画停止循环往复
// if (percent &amp;gt;= 99) {
//   return
// }
percent = ( percent + 1 ) % 100
requestAnimationFrame( animate )
}
animate()
/**&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@description: 二阶贝塞尔曲线动画&lt;/li&gt;
&lt;li&gt;@param {type}&lt;/li&gt;
&lt;li&gt;@return:
*/
function drawCurve (ctx, start, end, curveness, percent) {
var cp = [
( start[ 0 ] + end[ 0 ] ) / 2 - ( start[ 1 ] - end[ 1 ] ) * curveness,
( start[ 1 ] + end[ 1 ] ) / 2 - ( end[ 0 ] - start[ 0 ] ) * curveness
];
var t = percent / 100;
var p0 = start;
var p1 = cp;
var p2 = end;
var v01 = [ p1[ 0 ] - p0[ 0 ], p1[ 1 ] - p0[ 1 ] ];     // 向量&amp;lt;p0, p1&amp;gt;
var v12 = [ p2[ 0 ] - p1[ 0 ], p2[ 1 ] - p1[ 1 ] ];     // 向量&amp;lt;p1, p2&amp;gt;
var q0 = [ p0[ 0 ] + v01[ 0 ] * t, p0[ 1 ] + v01[ 1 ] * t ];
var q1 = [ p1[ 0 ] + v12[ 0 ] * t, p1[ 1 ] + v12[ 1 ] * t ];
var v = [ q1[ 0 ] - q0[ 0 ], q1[ 1 ] - q0[ 1 ] ];       // 向量&amp;lt;q0, q1&amp;gt;
var b = [ q0[ 0 ] + v[ 0 ] * t, q0[ 1 ] + v[ 1 ] * t ];
ctx.moveTo( p0[ 0 ], p0[ 1 ] );
ctx.quadraticCurveTo(
q0[ 0 ], q0[ 1 ],
b[ 0 ], b[ 1 ]
)
}
</script></p><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>二阶贝塞尔曲线方程 <code>B(t)=(1-t)²P₀ + 2t(1-t)P₁ + t²P₂</code></p></div> <p>这一部分写的比较懒。二阶动画以及中间控制点的计算那里，没有去验证。目前先做记录，日后再深入研究。主要参考了<a href="https://github.com/hujiulong/blog/issues/1" target="_blank" rel="noopener noreferrer">用canvas绘制一个曲线动画——深入理解贝塞尔曲线<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h4 id="_13-2-三阶贝塞尔曲线"><a href="#_13-2-三阶贝塞尔曲线" class="header-anchor">#</a> 13-2.三阶贝塞尔曲线</h4> <p><code>canvas</code> 中的二阶贝塞尔曲线的对应方法为 <code>bezierCurveTo(cx1, cy1, cx2, cy2, ex, ey)</code>。其中 <code>cx1</code> 代表第一个控制点x坐标，<code>cy1</code> 代表第一个控制点y坐标，<code>cx2</code> 代表第二个控制点x坐标，<code>cy2</code> 代表第二个控制点y坐标，<code>ex</code> 代表结束点x坐标，<code>ey</code> 代表结束点y坐标。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>三阶贝塞尔曲线方程 <code>B(t)=(1-t)³P₀ + 3t(1-t)²P₁ + 3t²(1-t)P₂ + t³P₃</code></p></div> <h3 id="附录1-签字板"><a href="#附录1-签字板" class="header-anchor">#</a> 附录1.签字板</h3> <p>利用 <code>canvas</code> 构建签字板。主要的功能点有：</p> <ol><li><code>PC</code>端签字</li> <li>移动端</li> <li>签字完成后，可以保存成图片。(涉及到如何旋转签字图片)</li></ol> <p>这个签字板功能，没有按照面向对象的方式来写。代码是面向过程的。针对上面的功能点，总结下思路：</p> <p>PC端签字依赖的事件 <code>api</code> 主要是 <code>mousedown</code> <code>mousemove</code> <code>mouseup</code>。另外要额外注意的一点是这三者在移动端不会被触发。</p> <p>移动端依赖的事件 <code>api</code> 主要是 <code>touchstart</code> <code>touchmove</code> <code>touchend</code>。</p> <p>在本例中，没有改变原始 <code>canvas</code> 元素的 <code>x</code> 轴和 <code>y</code> 轴，而且签字是横向签的。</p> <p>所以利用 <code>toDataURL</code> 生成的图片默认会是竖向的。</p> <p>解决办法是<strong>利用<code>drawImage</code>方法将该图片绘制到一个转换过的虚拟<code>canvas</code>上，再利用<code>toDataURL</code>生成</strong>。</p> <p><a href="http://jsgoshu.cn/demo/canvas/1.signBoard.html" target="_blank" rel="noopener noreferrer">链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="附录2-时钟"><a href="#附录2-时钟" class="header-anchor">#</a> 附录2.时钟</h3> <p>利用 <code>canvas</code> 绘制时钟。其实这里知识点还是挺多的。另外对数学的<strong>三角函数</strong>也要掌握。个人认为重点有两个：</p> <ol><li>根据当前时间计算出时针、分针、秒针的角度，再利用定时器不断的绘制。</li> <li><strong>利用三角函数计算出时针、分针、秒针的起点和终点，再利用<code>stroke</code>绘制</strong>。在本例代码中，我将其封装为了<code>getCoord</code>函数。</li></ol> <p>数学是一门有趣且很重要的语言。计算机的基础是由数学理论来支撑的。</p> <p><a href="http://jsgoshu.cn/demo/canvas/2.clock.html" target="_blank" rel="noopener noreferrer">链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="附录3-弹幕"><a href="#附录3-弹幕" class="header-anchor">#</a> 附录3.弹幕</h3> <p>利用 <code>canvas</code> 绘制弹幕。我写的例子比较简单，也存在许多可优化的地方。本例只是为了个人探究一下。思路的话就是：</p> <p><strong>利用位置绘制文字 改变位置 清空画布</strong>。一直循环到条件不满足。</p> <p><a href="http://jsgoshu.cn/demo/canvas/3.barrage.html" target="_blank" rel="noopener noreferrer">链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_5-2-webgl"><a href="#_5-2-webgl" class="header-anchor">#</a> 5-2.WebGL</h2></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/27/2024, 7:23:37 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/FE/html5/4.media.html" class="prev">
        4.多媒体
      </a></span> <span class="next"><a href="/blog/FE/html5/6.integration.html">
        6.性能 &amp; 集成
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.27bc6697.js" defer></script><script src="/blog/assets/js/2.edfaf709.js" defer></script><script src="/blog/assets/js/15.32b3105f.js" defer></script>
  </body>
</html>
